/* Version modified 0.95 */
/*
    Copyright 2008-2012
        Matthias Ehmann,
        Michael Gerhaeuser,
        Carsten Miller,
        Bianca Valentin,
        Alfred Wassermann,
        Peter Wilfahrt

    This file is part of JSXGraph.

    JSXGraph is free software: you can redistribute it and/or modify
    it under the terms of the GNU Lesser General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    JSXGraph is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Lesser General Public License for more details.

    You should have received a copy of the GNU Lesser General Public License
    along with JSXGraph.  If not, see <http://www.gnu.org/licenses/>.
*/

var JXG={};!function(){var a,b;if(JXG.countDrawings=0,JXG.countTime=0,JXG.require=function(){},JXG.rendererFiles={},JXG.rendererFiles.svg="SVGRenderer",JXG.rendererFiles.vml="VMLRenderer",JXG.rendererFiles.canvas="CanvasRenderer",JXG.baseFiles=null,JXG.requirePath="","undefined"!=typeof document)for(a=0;a<document.getElementsByTagName("script").length;a++)b=document.getElementsByTagName("script")[a],b.src&&b.src.match(/loadjsxgraphInOneFile\.js(\?.*)?$/)&&(JXG.requirePath=b.src.replace(/loadjsxgraphInOneFile\.js(\?.*)?$/,""));JXG.serverBase=JXG.requirePath+"server/"}(),JXG.extend=function(a,b,c,d){var e,f;c=c||!1,d=d||!1;for(e in b)(!c||c&&b.hasOwnProperty(e))&&(f=d?e.toLowerCase():e,a[f]=b[e])},JXG.shortcut=function(a,b){return function(){return a[b].apply(this,arguments)}},JXG.extend(JXG,{touchProperty:"touches",supportsVML:function(){return"undefined"!=typeof document&&!!document.namespaces},supportsSVG:function(){return"undefined"!=typeof document&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},supportsCanvas:function(){return"undefined"!=typeof document&&!!document.createElement("canvas").getContext},isAndroid:function(){return navigator.userAgent.toLowerCase().search("android")>-1},isWebkitAndroid:function(){return this.isAndroid()&&navigator.userAgent.search(" AppleWebKit/")>-1},isApple:function(){return-1!=navigator.userAgent.search(/iPad/)||-1!=navigator.userAgent.search(/iPhone/)},isWebkitApple:function(){return this.isApple()&&navigator.userAgent.search(/Mobile *.*Safari/)>-1},clearVisPropOld:function(a){a.visPropOld={strokecolor:"",strokeopacity:"",strokewidth:"",fillcolor:"",fillopacity:"",shadow:!1,firstarrow:!1,lastarrow:!1,cssclass:"",fontsize:-1}},ieVersion:function(){var a;if("undefined"==typeof document)return a;for(var b=3,c=document.createElement("div"),d=c.getElementsByTagName("i");c.innerHTML="<!--[if gt IE "+ ++b+"]><i></i><![endif]-->",d[0];);return b>4?b:a}(),getReference:function(a,b){return"string"==typeof b&&(JXG.exists(a.objects[b])?b=a.objects[b]:JXG.exists(a.elementsByName[b])?b=a.elementsByName[b]:JXG.exists(a.groups[b])&&(b=a.groups[b])),b},getRef:JXG.shortcut(JXG,"getReference"),isId:function(a,b){return"string"==typeof b&&!!a.objects[b]},isName:function(a,b){return"string"==typeof b&&!!a.elementsByName[b]},isGroup:function(a,b){return"string"==typeof b&&!!a.groups[b]},isString:function(a){return"string"==typeof a},isNumber:function(a){return"number"==typeof a},isFunction:function(a){return"function"==typeof a},isArray:function(a){return null!==a&&"object"==typeof a&&"splice"in a&&"join"in a},isPoint:function(a){return"object"==typeof a?a.elementClass==JXG.OBJECT_CLASS_POINT:!1},exists:function(a){return function(b){return!(b===a||null===b)}}(),def:function(a,b){return JXG.exists(a)?a:b},str2Bool:function(a){return JXG.exists(a)?"boolean"==typeof a?a:JXG.isString(a)?"true"==a.toLowerCase():!1:!0},_board:function(a,b){return JXG.JSXGraph.initBoard(a,b)},createEvalFunction:function(a,b,c){var e,f,d=[];for(e=0;c>e;e++)"string"==typeof b[e]&&(f=JXG.GeonextParser.geonext2JS(b[e],a),f=f.replace(/this\.board\./g,"board."),d[e]=new Function("","return "+f+";"));return function(a){var c=b[a];return"string"==typeof c?d[a]():"function"==typeof c?c():"number"==typeof c?c:0}},createFunction:function(a,b,c,d){var e=null;return JXG.exists(d)&&!d||!JXG.isString(a)?JXG.isFunction(a)?e=a:JXG.isNumber(a)?e=function(){return a}:JXG.isString(a)&&(e=function(){return a}):e=b.jc.snippet(a,!0,c,!0),null!==e&&(e.origin=a),e},checkParents:function(a,b,c){var d,e,f,g,h=[],i=b.slice(0),j=function(a,b){var c=(typeof a).toLowerCase();if("number"===c)return b&&(b.type&&b.type===a||b.elementClass&&b.elementClass===a);switch(a.toLowerCase()){case"string":case"object":case"function":case"number":return(typeof b).toLowerCase()===a.toLowerCase();case"array":return JXG.isArray(b)}return!1};for(d=0;d<c.length;d++){for(e=0;e<c[d].length&&b.length>=c[d].length;e++){for(f=0;f<i.length&&!j(c[d][e],i[f]);)f++;f<i.length&&h.push(i.splice(g-f-1,1)[0])}if(!i.length)return h;i=b.slice(0),h=[]}},readOption:function(a,b,c){var d=a.elements[c];return JXG.exists(a[b][c])&&(d=a[b][c]),d},checkAttributes:function(a,b){var c;JXG.exists(a)||(a={});for(c in b)JXG.exists(a[c])||(a[c]=b[c]);return a},copyAttributes:function(a,b){var c,d,e,f,g,h={circle:1,curve:1,image:1,line:1,point:1,polygon:1,text:1,ticks:1,integral:1};for(e=arguments.length,c=3>e||h[arguments[2]]?this.deepCopy(b.elements,null,!0):{},4>e&&this.exists(arguments[2])&&this.exists(b.layer[arguments[2]])&&(c.layer=b.layer[arguments[2]]),f=b,g=!0,d=2;e>d;d++){if(!JXG.exists(f[arguments[d]])){g=!1;break}f=f[arguments[d]]}for(g&&(c=this.deepCopy(c,f,!0)),f=a,g=!0,d=3;e>d;d++){if(!JXG.exists(f[arguments[d]])){g=!1;break}f=f[arguments[d]]}for(g&&this.extend(c,f,null,!0),f=b,g=!0,d=2;e>d;d++){if(!JXG.exists(f[arguments[d]])){g=!1;break}f=f[arguments[d]]}return g&&(c.label=JXG.deepCopy(f.label,c.label)),c.label=JXG.deepCopy(b.label,c.label),c},getDimensions:function(a){var b,c,d,e,f,g,h,i;if("undefined"==typeof document||null==a)return{width:500,height:500};if(b=document.getElementById(a),!JXG.exists(b))throw new Error("\nJSXGraph: HTML container element '"+a+"' not found.");return c=b.style.display,"none"!=c&&null!=c?{width:b.offsetWidth,height:b.offsetHeight}:(d=b.style,e=d.visibility,f=d.position,g=d.display,d.visibility="hidden",d.position="absolute",d.display="block",h=b.clientWidth,i=b.clientHeight,d.display=g,d.position=f,d.visibility=e,{width:h,height:i})},addEvent:function(a,b,c,d){var e=function(){return c.apply(d,arguments)};e.origin=c,d["x_internal"+b]=d["x_internal"+b]||[],d["x_internal"+b].push(e),JXG.exists(a)&&JXG.exists(a.addEventListener)?a.addEventListener(b,e,!1):a.attachEvent("on"+b,e)},removeEvent:function(a,b,c,d){var e;if(!JXG.exists(d))return JXG.debug("no such owner"),alert("see console and recheck why!!!"),void 0;if(!JXG.exists(d["x_internal"+b]))return JXG.debug("no such type: "+b),void 0;if(!JXG.isArray(d["x_internal"+b]))return JXG.debug("owner[x_internal + "+b+"] is not an array"),void 0;if(e=JXG.indexOf(d["x_internal"+b],c,"origin"),-1===e)return JXG.debug("no such event function in internal list: "+c),void 0;try{JXG.exists(a.addEventListener)?a.removeEventListener(b,d["x_internal"+b][e],!1):a.detachEvent("on"+b,d["x_internal"+b][e])}catch(f){JXG.debug("event not registered in browser: ("+b+" -- "+c+")")}d["x_internal"+b].splice(e,1)},removeAllEvents:function(a,b,c){var d,e;if(c["x_internal"+b]){for(e=c["x_internal"+b].length,d=e-1;d>=0;d--)JXG.removeEvent(a,b,c["x_internal"+b][d].origin,c);c["x_internal"+b].length>0&&JXG.debug("removeAllEvents: Not all events could be removed.")}},bind:function(a,b){return function(){return a.apply(b,arguments)}},removeElementFromArray:function(a,b){var c;for(c=0;c<a.length;c++)if(a[c]===b)return a.splice(c,1),a;return a},getPosition:function(a,b){var c,d,g,e=0,f=0;if(a||(a=window.event),g=a[JXG.touchProperty],JXG.exists(b))if(-1==b){for(d=g.length,c=0;d>c;c++)if(g[c]){a=g[c];break}}else a=g[b];return a.pageX||a.pageY?(e=a.pageX,f=a.pageY):(a.clientX||a.clientY)&&(e=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,f=a.clientY+document.body.scrollTop+document.documentElement.scrollTop),[e,f]},getOffset:function(a){for(var b=a,c=a,d=b.offsetLeft-b.scrollLeft,e=b.offsetTop-b.scrollTop;b=b.offsetParent;)for(d+=b.offsetLeft,e+=b.offsetTop,b.offsetParent&&(d+=b.clientLeft-b.scrollLeft,e+=b.clientTop-b.scrollTop),c=c.parentNode;c!=b;)d+=c.clientLeft-c.scrollLeft,e+=c.clientTop-c.scrollTop,c=c.parentNode;return[d,e]},getStyle:function(a,b){var c;return window.getComputedStyle?c=document.defaultView.getComputedStyle(a,null).getPropertyValue(b):a.currentStyle&&JXG.ieVersion>=9?c=a.currentStyle[b]:a.style&&(b=b.replace(/-([a-z]|[0-9])/gi,function(a,b){return(b+"").toUpperCase()}),c=a.style[b]),c},keys:function(a,b){var d,c=[];for(d in a)b?a.hasOwnProperty(d)&&c.push(d):c.push(d);return c},indexOf:function(a,b,c){var d,e=JXG.exists(c);if(Array.indexOf&&!e)return a.indexOf(b);for(d=0;d<a.length;d++)if(e&&a[d][c]===b||!e&&a[d]===b)return d;return-1},escapeHTML:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(a){return a.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},clone:function(a){var b={};return b.prototype=a,b},cloneAndCopy:function(a,b){var d,c=function(){};c.prototype=a;for(d in b)c[d]=b[d];return c},deepCopy:function(a,b,c){var d,e,f,h;if(c=c||!1,"object"!=typeof a||null==a)return a;if(this.isArray(a))for(d=[],e=0;e<a.length;e++)f=a[e],d[e]="object"==typeof f?this.deepCopy(f):f;else{d={};for(e in a)h=c?e.toLowerCase():e,f=a[e],d[h]="object"==typeof f?this.deepCopy(f):f;for(e in b)h=c?e.toLowerCase():e,f=b[e],d[h]="object"==typeof f?JXG.isArray(f)||!JXG.exists(d[h])?this.deepCopy(f):this.deepCopy(d[h],f,c):f}return d},toJSON:function(a,b){var c,d;if(b=JXG.def(b,!1),window.JSON&&window.JSON.stringify&&!b)try{return c=JSON.stringify(a)}catch(e){}switch(typeof a){case"object":if(a){var f=[];if(a instanceof Array){for(var g=0;g<a.length;g++)f.push(JXG.toJSON(a[g],b));return"["+f.join(",")+"]"}for(var h in a){try{d=JXG.toJSON(a[h],b)}catch(e){d=""}b?f.push(h+":"+d):f.push('"'+h+'":'+d)}return"{"+f.join(",")+"} "}return"null";case"string":return"'"+a.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return new String(a)}},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substring(1).toLowerCase()},timedChunk:function(a,b,c,d){var e=a.concat();setTimeout(function(){var f=+new Date;do b.call(c,e.shift());while(e.length>0&&+new Date-f<300);e.length>0?setTimeout(arguments.callee,1):d(a)},1)},trimNumber:function(a){return a=a.replace(/^0+/,""),a=a.replace(/0+$/,""),("."==a[a.length-1]||","==a[a.length-1])&&(a=a.slice(0,-1)),("."==a[0]||","==a[0])&&(a="0"+a),a},trim:function(a){return a=a.replace(/^\s+/,""),a=a.replace(/\s+$/,"")},evaluate:function(a){return JXG.isFunction(a)?a():a},eliminateDuplicates:function(a){var b,c=a.length,d=[],e={};for(b=0;c>b;b++)e[a[b]]=0;for(b in e)e.hasOwnProperty(b)&&d.push(b);return d},cmpArrays:function(a,b){var c;if(a===b)return!0;if(a.length!==b.length)return!1;for(c=0;c<a.length;c++)if(typeof a[c]!=typeof b[c]||a[c]!==b[c])return!1;return!0},trunc:function(a,b){return b=JXG.def(b,0),a=0==b?~~a:a.toFixed(b)},autoDigits:function(a){var b=Math.abs(a);return b=b>.1?a.toFixed(2):b>=.01?a.toFixed(4):b>=1e-4?a.toFixed(6):a},debug:function(a){var b;for(b=0;b<arguments.length;b++)a=arguments[b],window.console&&console.log?console.log(a):document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=a+"<br/>")},debugWST:function(a){var b;JXG.debug(a),window.console&&console.log&&(b=new Error,b&&b.stack&&(console.log("stacktrace"),console.log(b.stack.split("\n").slice(1).join("\n"))))}}),"undefined"!=typeof window&&"undefined"!=typeof document&&JXG.addEvent(window,"load",function(){var b,c,d,e,f,g,h,i,j,k,l,a=document.getElementsByTagName("script");for(c=0;c<a.length;c++)if(b=a[c].getAttribute("type",!1),JXG.exists(b)&&("text/jessiescript"===b.toLowerCase()||"jessiescript"===b.toLowerCase()||"text/jessiecode"===b.toLowerCase()||"jessiecode"===b.toLowerCase())){if(g=a[c].getAttribute("width",!1)||"500px",h=a[c].getAttribute("height",!1)||"500px",i=a[c].getAttribute("boundingbox",!1)||"-5, 5, 5, -5",i=i.split(","),4!==i.length)i=[-5,5,5,-5];else for(d=0;d<i.length;d++)i[d]=parseFloat(i[d]);j=JXG.str2Bool(a[c].getAttribute("axis",!1)||"false"),k=JXG.str2Bool(a[c].getAttribute("grid",!1)||"false"),e=document.createElement("div"),e.setAttribute("id","jessiescript_autgen_jxg_"+c),e.setAttribute("style","width:"+g+"; height:"+h+"; float:left"),e.setAttribute("class","jxgbox");try{document.body.insertBefore(e,a[c])}catch(m){"undefined"!=typeof jQuery&&jQuery(e).insertBefore(a[c])}if(document.getElementById("jessiescript_autgen_jxg_"+c))if(f=JXG.JSXGraph.initBoard("jessiescript_autgen_jxg_"+c,{boundingbox:i,keepaspectratio:!0,grid:k,axis:j}),l=a[c].innerHTML,l=l.replace(/<!\[CDATA\[/g,"").replace(/\]\]>/g,""),a[c].innerHTML=l,b.toLowerCase().indexOf("script")>-1)f.construct(l);else try{f.jc.parse(l)}catch(m){JXG.debug(m)}else JXG.debug("JSXGraph: Apparently the div injection failed. Can't create a board, sorry.")}},window),JXG.Math=function(a,b,c){var d=function(a){var b,d;return a.memo?a.memo:(b={},d=Array.prototype.join,a.memo=function(){var e=d.call(arguments);return b[e]!==c?b[e]:b[e]=a.apply(this,arguments)})};return{eps:1e-6,mod:function(a,c){return a-b.floor(a/c)*c},vector:function(a,c){var d,e;for(c=c||0,d=new Array(b.ceil(a)),e=0;a>e;e++)d[e]=c;return d},matrix:function(a,c,d){var e,f,g;for(d=d||0,c=c||a,e=new Array(b.ceil(a)),f=0;a>f;f++)for(e[f]=new Array(b.ceil(c)),g=0;c>g;g++)e[f][g]=d;return e},identity:function(a,d){var e,f;for(d===c&&"number"!=typeof d&&(d=a),e=this.matrix(a,d),f=0;f<b.min(a,d);f++)e[f][f]=1;return e},frustum:function(b,c,d,e,f,g){var h=a.Math.matrix(4,4);return h[0][0]=2*f/(c-b),h[0][1]=0,h[0][2]=(c+b)/(c-b),h[0][3]=0,h[1][0]=0,h[1][1]=2*f/(e-d),h[1][2]=(e+d)/(e-d),h[1][3]=0,h[2][0]=0,h[2][1]=0,h[2][2]=-(g+f)/(g-f),h[2][3]=-(2*g*f)/(g-f),h[3][0]=0,h[3][1]=0,h[3][2]=-1,h[3][3]=0,h},projection:function(a,c,d,e){var f=d*b.tan(a/2),g=f*c;return this.frustum(-g,g,-f,f,d,e)},matVecMult:function(a,b){var f,g,h,c=a.length,d=b.length,e=[];if(3===d)for(f=0;c>f;f++)e[f]=a[f][0]*b[0]+a[f][1]*b[1]+a[f][2]*b[2];else for(f=0;c>f;f++){for(g=0,h=0;d>h;h++)g+=a[f][h]*b[h];e[f]=g}return e},matMatMult:function(a,b){var g,h,i,j,c=a.length,d=c>0?b[0].length:0,e=b.length,f=this.matrix(c,d);for(g=0;c>g;g++)for(h=0;d>h;h++){for(i=0,j=0;e>j;j++)i+=a[g][j]*b[j][h];f[g][h]=i}return f},transpose:function(a){var b,c,d,e,f;for(e=a.length,f=a.length>0?a[0].length:0,b=this.matrix(f,e),c=0;f>c;c++)for(d=0;e>d;d++)b[c][d]=a[d][c];return b},inverse:function(c){var d,e,f,g,h,i,j,k=c.length,l=[],m=[],n=[];for(d=0;k>d;d++){for(l[d]=[],e=0;k>e;e++)l[d][e]=c[d][e];m[d]=d}for(e=0;k>e;e++){for(h=b.abs(l[e][e]),i=e,d=e+1;k>d;d++)b.abs(l[d][e])>h&&(h=b.abs(l[d][e]),i=d);if(h<=a.Math.eps)return!1;if(i>e){for(f=0;k>f;f++)j=l[e][f],l[e][f]=l[i][f],l[i][f]=j;j=m[e],m[e]=m[i],m[i]=j}for(g=1/l[e][e],d=0;k>d;d++)l[d][e]*=g;for(l[e][e]=g,f=0;k>f;f++)if(f!=e){for(d=0;k>d;d++)d!=e&&(l[d][f]-=l[d][e]*l[e][f]);l[e][f]=-g*l[e][f]}}for(d=0;k>d;d++){for(f=0;k>f;f++)n[m[f]]=l[d][f];for(f=0;k>f;f++)l[d][f]=n[f]}return l},innerProduct:function(a,b,d){var e,f=0;for((d===c||"number"!=typeof d)&&(d=a.length),e=0;d>e;e++)f+=a[e]*b[e];return f},crossProduct:function(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]},factorial:d(function(a){return 0>a?0/0:(a=b.floor(a),0===a||1===a?1:a*arguments.callee(a-1))}),binomial:d(function(a,c){var d,e;if(c>a||0>c)return 0/0;if(c=b.round(c),a=b.round(a),0===c||c===a)return 1;for(d=1,e=0;c>e;e++)d*=a-e,d/=e+1;return d}),cosh:function(a){return.5*(b.exp(a)+b.exp(-a))},sinh:function(a){return.5*(b.exp(a)-b.exp(-a))},pow:function(a,c){return 0===a?0===c?1:0:b.floor(c)===c?b.pow(a,c):a>0?b.exp(c*b.log(b.abs(a))):0/0},squampow:function(a,c){var d;if(b.floor(c)===c){for(d=1,0>c&&(a=1/a,c*=-1);0!=c;)1&c&&(d*=a),c>>=1,a*=a;return d}return this.pow(a,c)},normalize:function(a){var e,f,c=2*a[3],d=a[4]/c;return a[5]=d,a[6]=-a[1]/c,a[7]=-a[2]/c,1/0===d||isNaN(d)?(e=b.sqrt(a[1]*a[1]+a[2]*a[2]),a[0]/=e,a[1]/=e,a[2]/=e,a[3]=0,a[4]=1):b.abs(d)>=1?(a[0]=(a[6]*a[6]+a[7]*a[7]-d*d)/(2*d),a[1]=-a[6]/d,a[2]=-a[7]/d,a[3]=1/(2*d),a[4]=1):(f=0>=d?-1:1,a[0]=.5*f*(a[6]*a[6]+a[7]*a[7]-d*d),a[1]=-f*a[6],a[2]=-f*a[7],a[3]=f/2,a[4]=f*d),a},toGL:function(a){var b,c,d;if(b="undefined"!=typeof Float32Array?new Float32Array(16):new Array(16),4!==a.length&&4!==a[0].length)return b;for(c=0;4>c;c++)for(d=0;4>d;d++)b[c+4*d]=a[c][d];return b}}}(JXG,Math),JXG.Math.Numerics=function(a,b){var c={rk4:{s:4,A:[[0,0,0,0],[.5,0,0,0],[0,.5,0,0],[0,0,1,0]],b:[1/6,1/3,1/3,1/6],c:[0,.5,.5,1]},heun:{s:2,A:[[0,0],[1,0]],b:[.5,.5],c:[0,1]},euler:{s:1,A:[[0]],b:[1],c:[0]}};return{Gauss:function(c,d){var g,h,i,j,k,e=a.Math.eps,f=c.length>0?c[0].length:0,l=function(a,b){var c=this[a];this[a]=this[b],this[b]=c};if(f!==d.length||f!==c.length)throw new Error("JXG.Math.Numerics.Gauss: Dimensions don't match. A must be a square matrix and b must be of the same length as A.");for(g=new Array(f),h=d.slice(0,f),i=0;f>i;i++)g[i]=c[i].slice(0,f);for(j=0;f>j;j++){for(i=f-1;i>j;i--)if(b.abs(g[i][j])>e)if(b.abs(g[j][j])<e)l.apply(g,[i,j]),l.apply(h,[i,j]);else for(g[i][j]/=g[j][j],h[i]-=g[i][j]*h[j],k=j+1;f>k;k++)g[i][k]-=g[i][j]*g[j][k];if(b.abs(g[j][j])<e)throw new Error("JXG.Math.Numerics.Gauss(): The given matrix seems to be singular.")}return this.backwardSolve(g,h,!0),h},backwardSolve:function(a,b,c){var d,e,f,g,h;for(d=c?b:b.slice(0,b.length),e=a.length,f=a.length>0?a[0].length:0,g=e-1;g>=0;g--){for(h=f-1;h>g;h--)d[g]-=a[g][h]*d[h];d[g]/=a[g][g]}return d},gaussBareiss:function(c){var d,e,f,g,h,i,j,k,l,m=a.Math.eps;if(j=c.length,0>=j)return 0;for(c[0].length<j&&(j=c[0].length),k=new Array(j),g=0;j>g;g++)k[g]=c[g].slice(0,j);for(e=1,f=1,d=0;j-1>d;d++){if(i=k[d][d],b.abs(i)<m){for(g=0;j>g&&!(b.abs(k[g][d])>=m);g++);if(g==j)return 0;for(h=d;j>h;h++)l=k[g][h],k[g][h]=k[d][h],k[d][h]=l;f=-f,i=k[d][d]}for(g=d+1;j>g;g++)for(h=d+1;j>h;h++)l=i*k[g][h]-k[g][d]*k[d][h],k[g][h]=l/e;e=i}return f*k[j-1][j-1]},det:function(a){return this.gaussBareiss(a)},Jacobi:function(c){var d,e,f,g,h,i,j,m,n,k=a.Math.eps,l=0,o=c.length,p=[[0,0,0],[0,0,0],[0,0,0]],q=[[0,0,0],[0,0,0],[0,0,0]],r=0;for(d=0;o>d;d++){for(e=0;o>e;e++)p[d][e]=0,q[d][e]=c[d][e],l+=b.abs(q[d][e]);p[d][d]=1}if(1==o)return[q,p];if(0>=l)return[q,p];l/=o*o;do{for(m=0,n=0,e=1;o>e;e++)for(d=0;e>d;d++)if(g=b.abs(q[d][e]),g>n&&(n=g),m+=g,g>=k){for(g=.5*b.atan2(2*q[d][e],q[d][d]-q[e][e]),h=b.sin(g),i=b.cos(g),f=0;o>f;f++)j=q[f][d],q[f][d]=i*j+h*q[f][e],q[f][e]=-h*j+i*q[f][e],j=p[f][d],p[f][d]=i*j+h*p[f][e],p[f][e]=-h*j+i*p[f][e];for(q[d][d]=i*q[d][d]+h*q[e][d],q[e][e]=-h*q[d][e]+i*q[e][e],q[d][e]=0,f=0;o>f;f++)q[d][f]=q[f][d],q[e][f]=q[f][e]}r++}while(b.abs(m)/l>k&&2e3>r);return[q,p]},NewtonCotes:function(a,b,c){var i,j,k,d=0,e=c&&"number"==typeof c.number_of_nodes?c.number_of_nodes:28,f={trapez:!0,simpson:!0,milne:!0},g=c&&c.integration_type&&f.hasOwnProperty(c.integration_type)&&f[c.integration_type]?c.integration_type:"milne",h=(a[1]-a[0])/e;switch(g){case"trapez":for(d=.5*(b(a[0])+b(a[1])),i=a[0],j=0;e-1>j;j++)i+=h,d+=b(i);d*=h;break;case"simpson":if(e%2>0)throw new Error("JSXGraph:  INT_SIMPSON requires config.number_of_nodes dividable by 2.");for(k=e/2,d=b(a[0])+b(a[1]),i=a[0],j=0;k-1>j;j++)i+=2*h,d+=2*b(i);for(i=a[0]-h,j=0;k>j;j++)i+=2*h,d+=4*b(i);d*=h/3;break;default:if(e%4>0)throw new Error("JSXGraph: Error in INT_MILNE: config.number_of_nodes must be a multiple of 4");for(k=.25*e,d=7*(b(a[0])+b(a[1])),i=a[0],j=0;k-1>j;j++)i+=4*h,d+=14*b(i);for(i=a[0]-3*h,j=0;k>j;j++)i+=4*h,d+=32*(b(i)+b(i+2*h));for(i=a[0]-2*h,j=0;k>j;j++)i+=4*h,d+=12*b(i);d*=2*h/45}return d},I:function(a,b){return this.NewtonCotes(a,b,{number_of_nodes:16,integration_type:"milne"})},Newton:function(c,d,e){var j,f=0,g=a.Math.eps,h=c.apply(e,[d]),i=1;for(a.isArray(d)&&(d=d[0]);50>f&&b.abs(h)>g;)j=this.D(c,e)(d),i+=2,b.abs(j)>g?d-=h/j:d+=.2*b.random()-1,h=c.apply(e,[d]),i++,f++;return d},root:function(a,b,c){return this.fzero(a,b,c)},Neville:function(b){var c=[],d=function(d){return function(e,f){var g,h,i,j=a.Math.binomial,k=b.length,l=k-1,m=0,n=0;if(!f)for(i=1,g=0;k>g;g++)c[g]=j(l,g)*i,i*=-1;for(h=e,g=0;k>g;g++){if(0===h)return b[g][d]();i=c[g]/h,h--,m+=b[g][d]()*i,n+=i}return m/n}},e=d("X"),f=d("Y");return[e,f,0,function(){return b.length-1}]},splineDef:function(a,c){var e,f,g,d=b.min(a.length,c.length),h=[],i=[],j=[],k=[],l=[],m=[];if(2===d)return[0,0];for(f=0;d>f;f++)e={X:a[f],Y:c[f]},j.push(e);for(j.sort(function(a,b){return a.X-b.X}),f=0;d>f;f++)a[f]=j[f].X,c[f]=j[f].Y;for(f=0;d-1>f;f++)k.push(a[f+1]-a[f]);for(f=0;d-2>f;f++)l.push(6*(c[f+2]-c[f+1])/k[f+1]-6*(c[f+1]-c[f])/k[f]);for(h.push(2*(k[0]+k[1])),i.push(l[0]),f=0;d-3>f;f++)g=k[f+1]/h[f],h.push(2*(k[f+1]+k[f+2])-g*k[f+1]),i.push(l[f+1]-g*i[f]);for(m[d-3]=i[d-3]/h[d-3],f=d-4;f>=0;f--)m[f]=(i[f]-k[f+1]*m[f+1])/h[f];for(f=d-3;f>=0;f--)m[f+1]=m[f];return m[0]=0,m[d-1]=0,m},splineEval:function(c,d,e,f){var k,l,m,n,o,p,q,g=b.min(d.length,e.length),h=1,i=!1,j=[];for(a.isArray(c)?(h=c.length,i=!0):c=[c],k=0;h>k;k++){if(c[k]<d[0]||d[k]>d[g-1])return 0/0;for(l=1;g>l&&!(c[k]<=d[l]);l++);l--,m=e[l],n=(e[l+1]-e[l])/(d[l+1]-d[l])-(d[l+1]-d[l])/6*(f[l+1]+2*f[l]),o=f[l]/2,p=(f[l+1]-f[l])/(6*(d[l+1]-d[l])),q=c[k]-d[l],j.push(m+(n+(o+p*q)*q)*q)}return i?j:j[0]},generatePolynomialTerm:function(a,b,c,d){var f,e=[];for(f=b;f>=0;f--)e=e.concat(["(",a[f].toPrecision(d),")"]),f>1?e=e.concat(["*",c,"<sup>",f,"<","/sup> + "]):1===f&&(e=e.concat(["*",c," + "]));return e.join("")},lagrangePolynomial:function(a){var b=[],c=function(c,d){var e,f,g,h,i,l,m,j=0,k=0;if(g=a.length,!d){for(e=0;g>e;e++){for(b[e]=1,h=a[e].X(),f=0;g>f;f++)f!=e&&(b[e]*=h-a[f].X());b[e]=1/b[e]}for(l=[],m=0;g>m;m++)l.push([1])}for(e=0;g>e;e++){if(h=a[e].X(),c===h)return a[e].Y();i=b[e]/(c-h),k+=i,j+=i*a[e].Y()}return j/k};return c.getTerm=function(){return""},c},CatmullRomSpline:function(a){var d,c=[],e={},f={},g=function(g){return function(h,i){var k,l,j=a.length;if(2>j)return 0/0;if(!i)for(e[g]=function(){return 2*a[0][g]()-a[1][g]()},f[g]=function(){return 2*a[j-1][g]()-a[j-2][g]()},d=[e].concat(a,[f]),c[g]=[],k=0;j-1>k;k++)c[g][k]=[2*d[k+1][g](),-d[k][g]()+d[k+2][g](),2*d[k][g]()-5*d[k+1][g]()+4*d[k+2][g]()-d[k+3][g](),-d[k][g]()+3*d[k+1][g]()-3*d[k+2][g]()+d[k+3][g]()];return j+=2,isNaN(h)?0/0:0>h?d[1][g]():h>=j-3?d[j-2][g]():(k=b.floor(h),k==h?d[k][g]():(h-=k,l=c[g][k],.5*(((l[3]*h+l[2])*h+l[1])*h+l[0])))}};return[g("X"),g("Y"),0,function(){return a.length-1}]},regressionPolynomial:function(c,d,e){var f,g,h,i,j,k,l="";if(a.isPoint(c)&&"function"==typeof c.Value)g=function(){return c.Value()};else if(a.isFunction(c))g=c;else{if(!a.isNumber(c))throw new Error("JSXGraph: Can't create regressionPolynomial from degree of type'"+typeof c+"'.");g=function(){return c}}if(3==arguments.length&&a.isArray(d)&&a.isArray(e))j=0;else{if(!(2==arguments.length&&a.isArray(d)&&d.length>0&&a.isPoint(d[0])))throw new Error("JSXGraph: Can't create regressionPolynomial. Wrong parameters.");j=1}return k=function(c,k){var m,n,o,p,q,r,s,t,u,v=d.length;if(u=b.floor(g()),!k){if(1===j)for(h=[],i=[],m=0;v>m;m++)h[m]=d[m].X(),i[m]=d[m].Y();if(0===j)for(h=[],i=[],m=0;v>m;m++)a.isFunction(d[m])?h.push(d[m]()):h.push(d[m]),a.isFunction(e[m])?i.push(e[m]()):i.push(e[m]);for(o=[],n=0;v>n;n++)o.push([1]);for(m=1;u>=m;m++)for(n=0;v>n;n++)o[n][m]=o[n][m-1]*h[n];q=i,p=a.Math.transpose(o),r=a.Math.matMatMult(p,o),s=a.Math.matVecMult(p,q),f=a.Math.Numerics.Gauss(r,s),l=a.Math.Numerics.generatePolynomialTerm(f,u,"x",3)}for(t=f[u],m=u-1;m>=0;m--)t=t*c+f[m];return t},k.getTerm=function(){return l},k},bezier:function(a){var c,d=function(d){return function(e,f){var g=3*b.floor(e),h=e%1,i=1-h;return f||(c=b.floor(a.length/3)),0>e?a[0][d]():e>=c?a[a.length-1][d]():isNaN(e)?0/0:i*i*(i*a[g][d]()+3*h*a[g+1][d]())+(3*i*a[g+2][d]()+h*a[g+3][d]())*h*h}};return[d("X"),d("Y"),0,function(){return b.floor(a.length/3)}]},bspline:function(a,c){var d,e=[],f=function(a,b){var c,d=[];for(c=0;a+b+1>c;c++)d[c]=b>c?0:a>=c?c-b+1:a-b+2;return d},g=function(a,b,c,d,e){var f,g,h,i,j,k=[];for(k[e]=b[e]<=a&&a<b[e+1]?1:0,f=2;d>=f;f++)for(g=e-f+1;e>=g;g++)h=e-f+1>=g||0>g?0:k[g],i=g>=e?0:k[g+1],j=b[g+f-1]-b[g],k[g]=0==j?0:(a-b[g])/j*h,j=b[g+f]-b[g+1],0!=j&&(k[g]+=(b[g+f]-a)/j*i);return k},h=function(h){return function(i){var l,m,n,k=a.length,o=k-1,p=c;if(0>=o)return 0/0;if(p>=o+2&&(p=o+1),0>=i)return a[0][h]();if(i>=o-p+2)return a[o][h]();for(d=f(o,p),n=b.floor(i)+p-1,e=g(i,d,o,p,n),l=0,m=n-p+1;n>=m;m++)k>m&&m>=0&&(l+=a[m][h]()*e[m]);return l}};return[h("X"),h("Y"),0,function(){return a.length-1}]},D:function(b,c){var d=1e-5,e=1/(2*d);return 1==arguments.length||arguments.length>1&&!a.exists(arguments[1])?function(a,c){return(b(a+d,c)-b(a-d,c))*e}:function(a,f){return(b.apply(c,[a+d,f])-b.apply(c,[a-d,f]))*e}},riemann:function(a,c,d,e,f){var i,k,m,n,o,p,g=[],h=[],j=0,l=e;if(c=b.round(c),g[j]=l,h[j]=0,c>0)for(k=(f-e)/c,p=.01*k,i=0;c>i;i++){if("right"===d)m=a(l+k);else if("middle"===d)m=a(l+.5*k);else if("left"===d||"trapezodial"===d)m=a(l);else if("lower"===d)for(m=a(l),n=l+p;l+k>=n;n+=p)o=a(n),m>o&&(m=o);else for(m=a(l),n=l+p;l+k>=n;n+=p)o=a(n),o>m&&(m=o);j++,g[j]=l,h[j]=m,j++,l+=k,"trapezodial"===d&&(m=a(l)),g[j]=l,h[j]=m,j++,g[j]=l,h[j]=0}return[g,h]},riemannsum:function(a,c,d,e,f){var h,i,k,l,m,n,g=0,j=e;if(c=b.floor(c),c>0)for(i=(f-e)/c,n=.01*i,h=0;c>h;h++){if("right"===d)k=a(j+i);else if("middle"===d)k=a(j+.5*i);else if("trapezodial"===d)k=.5*(a(j+i)+a(j));else if("left"===d)k=a(j);else if("lower"===d)for(k=a(j),l=j+n;j+i>=l;l+=n)m=a(l),k>m&&(k=m);else for(k=a(j),l=j+n;j+i>=l;l+=n)m=a(l),m>k&&(k=m);g+=i*k,j+=i}return g},rungeKutta:function(b,d,e,f,g){var l,m,n,o,p,r,h=[],i=[],j=(e[1]-e[0])/f,k=e[0],q=d.length,s=[],t=0;for(a.isString(b)&&(b=c[b]||c.euler),r=b.s,l=0;q>l;l++)h[l]=d[l];for(m=0;f>m;m++){for(s[t]=[],l=0;q>l;l++)s[t][l]=h[l];for(t++,o=[],n=0;r>n;n++){for(l=0;q>l;l++)i[l]=0;for(p=0;n>p;p++)for(l=0;q>l;l++)i[l]+=b.A[n][p]*j*o[p][l];for(l=0;q>l;l++)i[l]+=h[l];o.push(g(k+b.c[n]*j,i))}for(l=0;q>l;l++)i[l]=0;for(p=0;r>p;p++)for(l=0;q>l;l++)i[l]+=b.b[p]*o[p][l];for(l=0;q>l;l++)h[l]=h[l]+j*i[l];k+=j}return s},maxIterationsRoot:80,maxIterationsMinimize:500,fzero:function(c,d,e){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,f=a.Math.eps,g=this.maxIterationsRoot,h=0,i=0,j=f;if(a.isArray(d)){if(d.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");k=d[0],n=c.apply(e,[k]),i++,l=d[1],o=c.apply(e,[l]),i++}else{for(k=d,n=c.apply(e,[k]),i++,q=0==k?1:k,r=[.9*q,1.1*q,q-1,q+1,.5*q,1.5*q,-q,2*q,-10*q,10*q],t=r.length,s=0;t>s&&(l=r[s],o=c.apply(e,[l]),i++,!(0>=n*o));s++);k>l&&(u=k,k=l,l=u,v=n,n=o,o=v)}if(n*o>0)return a.isArray(d)?this.fminbr(c,[k,l],e):this.Newton(c,k,e);for(m=k,p=n;g>h;){if(w=l-k,b.abs(p)<b.abs(o)&&(k=l,l=m,m=k,n=o,o=p,p=n),x=2*j*b.abs(l)+.5*f,A=.5*(m-l),b.abs(A)<=x&&b.abs(o)<=j)return l;b.abs(w)>=x&&b.abs(n)>b.abs(o)&&(C=m-l,k==m?(B=o/n,y=C*B,z=1-B):(z=n/p,B=o/p,D=o/n,y=D*(C*z*(z-B)-(l-k)*(B-1)),z=(z-1)*(B-1)*(D-1)),y>0?z=-z:y=-y,y<.75*C*z-.5*b.abs(x*z)&&y<b.abs(.5*w*z)&&(A=y/z)),b.abs(A)<x&&(A=A>0?x:-x),k=l,n=o,l+=A,o=c.apply(e,[l]),i++,(o>0&&p>0||0>o&&0>p)&&(m=k,p=n),h++}return l},fminbr:function(c,d,e){var f,g,h,i,j,k,l,m,s,t,u,v,w,x,y,z,n=.5*(3-b.sqrt(5)),o=a.Math.eps,p=b.sqrt(a.Math.eps),q=this.maxIterationsMinimize,r=0,A=0;if(!a.isArray(d)||d.length<2)throw new Error("JXG.Math.Numerics.fminbr: length of array x0 has to be at least two.");for(f=d[0],g=d[1],i=f+n*(g-f),l=c.apply(e,[i]),A++,h=i,j=i,k=l,m=l;q>r;){if(s=g-f,t=.5*(f+g),u=p*b.abs(h)+o/3,b.abs(h-t)+.5*s<=2*u)return h;v=n*(t>h?g-h:f-h),b.abs(h-j)>=u&&(y=(h-j)*(k-l),x=(h-i)*(k-m),w=(h-i)*x-(h-j)*y,x=2*(x-y),x>0?w=-w:x=-x,b.abs(w)<b.abs(v*x)&&w>x*(f-h+2*u)&&x*(g-h-2*u)>w&&(v=w/x)),b.abs(v)<u&&(v=v>0?u:-u),y=h+v,z=c.apply(e,[y]),A++,k>=z?(h>y?g=h:f=h,i=j,j=h,h=y,l=m,m=k,k=z):(h>y?f=y:g=y,m>=z||j==h?(i=j,j=y,l=m,m=z):(l>=z||i==h||i==j)&&(i=y,l=z)),r++}return h},reuleauxPolygon:function(c,d){var h,e=2*b.PI,f=e/d,g=(d-1)/2,i=0,j=function(j,k){return function(l,m){m||(i=c[0].Dist(c[g]),h=a.Math.Geometry.rad([c[0].X()+1,c[0].Y()],c[0],c[g%d]));var n=(l%e+e)%e,o=b.floor(n/f)%d;return isNaN(o)?o:(n=.5*n+.5*o*f+h,c[o][j]()+i*b[k](n))}};return[j("X","cos"),j("Y","sin"),0,2*b.PI]},RamerDouglasPeuker:function(c,d){var f,g,h,e=[],i=function(a,b,c,d,e){var f=j(a,b,c);f[0]>d?(i(a,b,f[1],d,e),i(a,f[1],c,d,e)):e.push(a[c])},j=function(c,d,e){var h,i,j,k,l,m,n,o,p,q,r,f=0,g=d;if(2>e-d)return[-1,0];if(j=c[d].scrCoords,k=c[e].scrCoords,isNaN(j[1]+j[2]+k[1]+k[2]))return[0/0,e];for(i=d+1;e>i;i++)l=c[i].scrCoords,m=l[1]-j[1],n=l[2]-j[2],o=k[1]-j[1],p=k[2]-j[2],q=o*o+p*p,q>=a.Math.eps?(r=(m*o+n*p)/q,0>r?r=0:r>1&&(r=1),m-=r*o,n-=r*p,h=m*m+n*n):(r=0,h=m*m+n*n),h>f&&(f=h,g=i);return[b.sqrt(f),g]};for(h=c.length,f=0;h>f&&isNaN(c[f].scrCoords[1]+c[f].scrCoords[2]);)f++;for(g=h-1;g>f&&isNaN(c[g].scrCoords[1]+c[g].scrCoords[2]);)g--;return f>g||f==h||(e[0]=c[f],i(c,f,g,d,e)),e}}}(JXG,Math),JXG.Math.Statistics={sum:function(a){var b,c=a.length,d=0;for(b=0;c>b;b++)d+=a[b];return d},prod:function(a){var b,c=a.length,d=1;for(b=0;c>b;b++)d*=a[b];return d},mean:function(a){return a.length>0?this.sum(a)/a.length:0},median:function(a){var b,c;return a.length>0?(b=a.slice(0),b.sort(function(a,b){return a-b}),c=b.length,1==c%2?b[parseInt(.5*c)]:.5*(b[.5*c-1]+b[.5*c])):0},variance:function(a){var b,c,d,e=a.length;if(e>1){for(b=this.mean(a),c=0,d=0;e>d;d++)c+=(a[d]-b)*(a[d]-b);return c/(a.length-1)}return 0},sd:function(a){return Math.sqrt(this.variance(a))},weightedMean:function(a,b){if(a.length!=b.length)throw new Error("JSXGraph error (Math.Statistics.weightedMean): Array dimension mismatch.");return a.length>0?this.mean(this.multiply(a,b)):0},max:function(a){return Math.max.apply(this,a)},min:function(a){return Math.min.apply(this,a)},range:function(a){return[this.min(a),this.max(a)]},abs:function(a){var b,c,d;if(JXG.isArray(a))for(c=a.length,d=[],b=0;c>b;b++)d[b]=Math.abs(a[b]);else d=Math.abs(a);return d},add:function(a,b){var c,d,e=[];if(JXG.isArray(a)&&JXG.isNumber(b))for(d=a.length,c=0;d>c;c++)e[c]=a[c]+b;else if(JXG.isNumber(a)&&JXG.isArray(b))for(d=b.length,c=0;d>c;c++)e[c]=a+b[c];else if(JXG.isArray(a)&&JXG.isArray(b))for(d=Math.min(a.length,b.length),c=0;d>c;c++)e[c]=a[c]+b[c];else e=a+b;return e},div:function(a,b){var c,d,e=[];if(JXG.isArray(a)&&JXG.isNumber(b))for(d=a.length,c=0;d>c;c++)e[c]=a[c]/b;else if(JXG.isNumber(a)&&JXG.isArray(b))for(d=b.length,c=0;d>c;c++)e[c]=a/b[c];else if(JXG.isArray(a)&&JXG.isArray(b))for(d=Math.min(a.length,b.length),c=0;d>c;c++)e[c]=a[c]/b[c];else e=a/b;return e},divide:JXG.shortcut(JXG.Math.Statistics,"div"),mod:function(a,b,c){var d,e,f=[],g=function(a,b){return a%b};if(c=JXG.def(c,!1),c&&(g=JXG.Math.mod),JXG.isArray(a)&&JXG.isNumber(b))for(e=a.length,d=0;e>d;d++)f[d]=g(a[d],b);else if(JXG.isNumber(a)&&JXG.isArray(b))for(e=b.length,d=0;e>d;d++)f[d]=g(a,b[d]);else if(JXG.isArray(a)&&JXG.isArray(b))for(e=Math.min(a.length,b.length),d=0;e>d;d++)f[d]=g(a[d],b[d]);else f=g(a,b);return f},multiply:function(a,b){var c,d,e=[];if(JXG.isArray(a)&&JXG.isNumber(b))for(d=a.length,c=0;d>c;c++)e[c]=a[c]*b;else if(JXG.isNumber(a)&&JXG.isArray(b))for(d=b.length,c=0;d>c;c++)e[c]=a*b[c];else if(JXG.isArray(a)&&JXG.isArray(b))for(d=Math.min(a.length,b.length),c=0;d>c;c++)e[c]=a[c]*b[c];else e=a*b;return e},subtract:function(a,b){var c,d,e=[];if(JXG.isArray(a)&&JXG.isNumber(b))for(d=a.length,c=0;d>c;c++)e[c]=a[c]-b;else if(JXG.isNumber(a)&&JXG.isArray(b))for(d=b.length,c=0;d>c;c++)e[c]=a-b[c];else if(JXG.isArray(a)&&JXG.isArray(b))for(d=Math.min(a.length,b.length),c=0;d>c;c++)e[c]=a[c]-b[c];else e=a-b;return e}},JXG.Math.Symbolic=function(a,b){return{generateSymbolicCoordinatesPartial:function(b,c,d,e){var i,j,k,f=function(a){var b;return b="underscore"===e?""+d+"_{"+a+"}":"brace"==e?""+d+"["+a+"]":""+d+a},g=c.ancestors,h=0;b.listOfFreePoints=[],b.listOfDependantPoints=[];for(j in g)if(i=0,a.isPoint(g[j])){for(k in g[j].ancestors)i++;0===i?(g[j].symbolic.x=g[j].coords.usrCoords[1],g[j].symbolic.y=g[j].coords.usrCoords[2],b.listOfFreePoints.push(g[j])):(h++,g[j].symbolic.x=f(h),h++,g[j].symbolic.y=f(h),b.listOfDependantPoints.push(g[j]))}return a.isPoint(c)&&(c.symbolic.x="x",c.symbolic.y="y"),h},clearSymbolicCoordinates:function(b){var c=function(b){var c,d=b&&b.length||0;for(c=0;d>c;c++)a.isPoint(b[c])&&(b[c].symbolic.x="",b[c].symbolic.y="")};c(b.listOfFreePoints),c(b.listOfDependantPoints),delete b.listOfFreePoints,delete b.listOfDependantPoints},generatePolynomials:function(b,c,d){var f,i,j,k,e=c.ancestors,g=[],h=[];d&&this.generateSymbolicCoordinatesPartial(b,c,"u","brace"),e[c.id]=c;
for(i in e)if(f=0,g=[],a.isPoint(e[i])){for(j in e[i].ancestors)f++;if(f>0)for(g=e[i].generatePolynomial(),k=0;k<g.length;k++)h.push(g[k])}return d&&this.clearSymbolicCoordinates(b),h},geometricLocusByGroebnerBase:function(c,d){var f,g,h,l,m,n,s,t,u,v,w,x,y,e=this.generateSymbolicCoordinatesPartial(c,d,"u","brace"),i={},j=new a.Coords(a.COORDS_BY_USR,[0,0],c),k=new a.Coords(a.COORDS_BY_USR,[c.canvasWidth,c.canvasHeight],c),o=1,p=0,q=0,r=0,z=function(a,b){var c;for(c=0;c<b.length;c++)if(b[c].id===a)return!0;return!1},A=c.options.locus;if(a.Server.modules.geoloci===b&&a.Server.loadModule("geoloci"),a.Server.modules.geoloci===b)throw new Error("JSXGraph: Unable to load JXG.Server module 'geoloci.py'.");if(v=j.usrCoords[1],w=k.usrCoords[1],x=k.usrCoords[2],y=j.usrCoords[2],A.translateToOrigin&&c.listOfFreePoints.length>0){for(l=A.toOrigin!==b&&null!=A.toOrigin&&z(A.toOrigin.id,c.listOfFreePoints)?A.toOrigin:c.listOfFreePoints[0],p=l.symbolic.x,q=l.symbolic.y,n=0;n<c.listOfFreePoints.length;n++)c.listOfFreePoints[n].symbolic.x-=p,c.listOfFreePoints[n].symbolic.y-=q;if(v-=p,w-=p,x-=q,y-=q,A.translateTo10&&c.listOfFreePoints.length>1){for(m=A.to10!==b&&null!=A.to10&&A.to10.id!=A.toOrigin.id&&z(A.to10.id,c.listOfFreePoints)?A.to10:c.listOfFreePoints[0].id==l.id?c.listOfFreePoints[1]:c.listOfFreePoints[0],r=a.Math.Geometry.rad([1,0],[0,0],[m.symbolic.x,m.symbolic.y]),s=Math.cos(-r),t=Math.sin(-r),n=0;n<c.listOfFreePoints.length;n++)u=c.listOfFreePoints[n].symbolic.x,c.listOfFreePoints[n].symbolic.x=s*c.listOfFreePoints[n].symbolic.x-t*c.listOfFreePoints[n].symbolic.y,c.listOfFreePoints[n].symbolic.y=t*u+s*c.listOfFreePoints[n].symbolic.y;if(m.symbolic.y=0,u=v,v=s*v-t*x,x=t*u+s*x,u=w,w=s*w-t*y,y=t*u+s*y,A.stretch&&Math.abs(m.symbolic.x)>a.Math.eps){for(o=m.symbolic.x,n=0;n<c.listOfFreePoints.length;n++)c.listOfFreePoints[n].symbolic.x/=o,c.listOfFreePoints[n].symbolic.y/=o;for(n in c.objects)c.objects[n].elementClass==a.OBJECT_CLASS_CIRCLE&&"pointRadius"==c.objects[n].method&&(i[n]=c.objects[n].radius,c.objects[n].radius/=o);v/=o,w/=o,x/=o,y/=o,m.symbolic.x=1}}for(n=0;n<c.listOfFreePoints.length;n++)u=c.listOfFreePoints[n].symbolic.x,Math.abs(u)<a.Math.eps&&(c.listOfFreePoints[n].symbolic.x=0),Math.abs(u-Math.round(u))<a.Math.eps&&(c.listOfFreePoints[n].symbolic.x=Math.round(u)),u=c.listOfFreePoints[n].symbolic.y,Math.abs(u)<a.Math.eps&&(c.listOfFreePoints[n].symbolic.y=0),Math.abs(u-Math.round(u))<a.Math.eps&&(c.listOfFreePoints[n].symbolic.y=Math.round(u))}f=this.generatePolynomials(c,d),g=f.join(","),this.cbp=function(a){h=a},this.cb=a.bind(this.cbp,this),a.Server.modules.geoloci.lociCoCoA(v,w,x,y,e,g,o,r,p,q,this.cb,!0),this.clearSymbolicCoordinates(c);for(n in i)c.objects[n].radius=i[n];return h}}}(JXG),JXG.Math.Geometry={},JXG.extend(JXG.Math.Geometry,{angle:function(a,b,c){var g,h,i,j,d=[],e=[],f=[];return null==a.coords?(d[0]=a[0],d[1]=a[1]):(d[0]=a.coords.usrCoords[1],d[1]=a.coords.usrCoords[2]),null==b.coords?(e[0]=b[0],e[1]=b[1]):(e[0]=b.coords.usrCoords[1],e[1]=b.coords.usrCoords[2]),null==c.coords?(f[0]=c[0],f[1]=c[1]):(f[0]=c.coords.usrCoords[1],f[1]=c.coords.usrCoords[2]),g=d[0]-e[0],h=d[1]-e[1],i=f[0]-e[0],j=f[1]-e[1],Math.atan2(g*j-h*i,g*i+h*j)},trueAngle:function(a,b,c){return 57.29577951308232*this.rad(a,b,c)},rad:function(a,b,c){var d,e,f,g,h,i,j;return null==a.coords?(d=a[0],e=a[1]):(d=a.coords.usrCoords[1],e=a.coords.usrCoords[2]),null==b.coords?(f=b[0],g=b[1]):(f=b.coords.usrCoords[1],g=b.coords.usrCoords[2]),null==c.coords?(h=c[0],i=c[1]):(h=c.coords.usrCoords[1],i=c.coords.usrCoords[2]),j=Math.atan2(i-g,h-f)-Math.atan2(e-g,d-f),0>j&&(j+=6.283185307179586),j},angleBisector:function(a,b,c,d){var k,l,m,e=a.coords.usrCoords,f=b.coords.usrCoords,g=c.coords.usrCoords,h=e[1]-f[1],i=e[2]-f[2],j=Math.sqrt(h*h+i*i);return JXG.exists(d)||(d=a.board),h/=j,i/=j,k=Math.acos(h),0>i&&(k*=-1),0>k&&(k+=2*Math.PI),h=g[1]-f[1],i=g[2]-f[2],j=Math.sqrt(h*h+i*i),h/=j,i/=j,l=Math.acos(h),0>i&&(l*=-1),0>l&&(l+=2*Math.PI),m=.5*(k+l),k>l&&(m+=Math.PI),h=Math.cos(m)+f[1],i=Math.sin(m)+f[2],new JXG.Coords(JXG.COORDS_BY_USER,[h,i],d)},reflection:function(a,b,c){var g,h,i,j,k,l,m,d=b.coords.usrCoords,e=a.point1.coords.usrCoords,f=a.point2.coords.usrCoords;return JXG.exists(c)||(c=b.board),k=f[1]-e[1],l=f[2]-e[2],g=d[1]-e[1],h=d[2]-e[2],m=(k*h-l*g)/(k*k+l*l),i=d[1]+2*m*l,j=d[2]-2*m*k,new JXG.Coords(JXG.COORDS_BY_USER,[i,j],c)},rotation:function(a,b,c,d){var g,h,i,j,k,l,e=b.coords.usrCoords,f=a.coords.usrCoords;return JXG.exists(d)||(d=b.board),g=e[1]-f[1],h=e[2]-f[2],i=Math.cos(c),j=Math.sin(c),k=g*i-h*j+f[1],l=g*j+h*i+f[2],new JXG.Coords(JXG.COORDS_BY_USER,[k,l],d)},perpendicular:function(a,b,c){var g,h,i,j,k,l,m,n,d=a.point1.coords.usrCoords,e=a.point2.coords.usrCoords,f=b.coords.usrCoords;return JXG.exists(c)||(c=b.board),b==a.point1?(g=d[1]+e[2]-d[2],h=d[2]-e[1]+d[1],i=!0):b==a.point2?(g=e[1]+d[2]-e[2],h=e[2]-d[1]+e[1],i=!1):Math.abs(d[1]-e[1])>JXG.Math.eps&&Math.abs(f[2]-(d[2]-e[2])*(f[1]-d[1])/(d[1]-e[1])-d[2])<JXG.Math.eps||Math.abs(d[1]-e[1])<=JXG.Math.eps&&Math.abs(d[1]-f[1])<JXG.Math.eps?(g=f[1]+e[2]-f[2],h=f[2]-e[1]+f[1],i=!0,Math.abs(g-f[1])<JXG.Math.eps&&Math.abs(h-f[2])<JXG.Math.eps&&(g=f[1]+d[2]-f[2],h=f[2]-d[1]+f[1],i=!1)):(j=d[2]-e[2],k=d[1]-e[1],l=e[1]*j-e[2]*k,m=f[1]*k+f[2]*j,n=j*j+k*k,Math.abs(n)<JXG.Math.eps&&(n=JXG.Math.eps),g=(l*j+m*k)/n,h=(m*j-l*k)/n,i=!0),[new JXG.Coords(JXG.COORDS_BY_USER,[g,h],c),i]},circumcenterMidpoint:JXG.shortcut(JXG.Math.Geometry,"circumcenter"),circumcenter:function(a,b,c,d){var h,i,j,k,e=a.coords.usrCoords,f=b.coords.usrCoords,g=c.coords.usrCoords;return JXG.exists(d)||(d=a.board),h=[f[0]-e[0],-f[2]+e[2],f[1]-e[1]],i=[.5*(e[0]+f[0]),.5*(e[1]+f[1]),.5*(e[2]+f[2])],j=JXG.Math.crossProduct(h,i),h=[g[0]-f[0],-g[2]+f[2],g[1]-f[1]],i=[.5*(f[0]+g[0]),.5*(f[1]+g[1]),.5*(f[2]+g[2])],k=JXG.Math.crossProduct(h,i),new JXG.Coords(JXG.COORDS_BY_USER,JXG.Math.crossProduct(j,k),d)},distance:function(a,b){var d,e,c=0;if(a.length!=b.length)return 0/0;for(e=a.length,d=0;e>d;d++)c+=(a[d]-b[d])*(a[d]-b[d]);return Math.sqrt(c)},affineDistance:function(a,b){var c;return a.length!=b.length?0/0:(c=this.distance(a,b),c>JXG.Math.eps&&(Math.abs(a[0])<JXG.Math.eps||Math.abs(b[0])<JXG.Math.eps)?1/0:c)},calcStraight:function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;if(null==d&&(d=10),i=a.visProp.straightfirst,j=a.visProp.straightlast,Math.abs(b.scrCoords[0])<JXG.Math.eps&&(i=!0),Math.abs(c.scrCoords[0])<JXG.Math.eps&&(j=!0),(i||j)&&(k=[],k[0]=a.stdform[0]-a.stdform[1]*a.board.origin.scrCoords[1]/a.board.unitX+a.stdform[2]*a.board.origin.scrCoords[2]/a.board.unitY,k[1]=a.stdform[1]/a.board.unitX,k[2]=a.stdform[2]/-a.board.unitY,!isNaN(k[0]+k[1]+k[2]))){for(l=[],l[0]=JXG.Math.crossProduct(k,[d,0,1]),l[1]=JXG.Math.crossProduct(k,[d,1,0]),l[2]=JXG.Math.crossProduct(k,[-d-a.board.canvasHeight,0,1]),l[3]=JXG.Math.crossProduct(k,[-d-a.board.canvasWidth,1,0]),m=0;4>m;m++)if(Math.abs(l[m][0])>JXG.Math.eps){for(n=2;n>0;n--)l[m][n]/=l[m][0];l[m][0]=1}if(e=!1,f=!1,!i&&Math.abs(b.usrCoords[0])>=JXG.Math.eps&&b.scrCoords[1]>=0&&b.scrCoords[1]<=a.board.canvasWidth&&b.scrCoords[2]>=0&&b.scrCoords[2]<=a.board.canvasHeight&&(e=!0),!j&&Math.abs(c.usrCoords[0])>=JXG.Math.eps&&c.scrCoords[1]>=0&&c.scrCoords[1]<=a.board.canvasWidth&&c.scrCoords[2]>=0&&c.scrCoords[2]<=a.board.canvasHeight&&(f=!0),Math.abs(l[1][0])<JXG.Math.eps?(g=l[0],h=l[2]):Math.abs(l[0][0])<JXG.Math.eps?(g=l[1],h=l[3]):l[1][2]<0?(g=l[0],h=l[3][2]>a.board.canvasHeight?l[2]:l[3]):l[1][2]>a.board.canvasHeight?(g=l[2],h=l[3][2]<0?l[0]:l[3]):(g=l[1],h=l[3][2]<0?l[0]:l[3][2]>a.board.canvasHeight?l[2]:l[3]),g=new JXG.Coords(JXG.COORDS_BY_SCREEN,g.slice(1),a.board),h=new JXG.Coords(JXG.COORDS_BY_SCREEN,h.slice(1),a.board),!e&&!f){if(!i&&j&&!this.isSameDirection(b,c,g)&&!this.isSameDirection(b,c,h))return;if(i&&!j&&!this.isSameDirection(c,b,g)&&!this.isSameDirection(c,b,h))return}e?f||(p=this.isSameDir(b,c,g,h)?h:g):f?o=this.isSameDir(b,c,g,h)?g:h:this.isSameDir(b,c,g,h)?(o=g,p=h):(p=g,o=h),o&&b.setCoordinates(JXG.COORDS_BY_USER,o.usrCoords.slice(1)),p&&c.setCoordinates(JXG.COORDS_BY_USER,p.usrCoords.slice(1))}},isSameDir:function(a,b,c,d){var e=b.usrCoords[1]-a.usrCoords[1],f=b.usrCoords[2]-a.usrCoords[2],g=d.usrCoords[1]-c.usrCoords[1],h=d.usrCoords[2]-c.usrCoords[2];return Math.abs(b.usrCoords[0])<JXG.Math.eps&&(e=b.usrCoords[1],f=b.usrCoords[2]),Math.abs(a.usrCoords[0])<JXG.Math.eps&&(e=-a.usrCoords[1],f=-a.usrCoords[2]),e*g+f*h>=0},isSameDirection:function(a,b,c){var d,e,f,g,h=!1;return d=b.usrCoords[1]-a.usrCoords[1],e=b.usrCoords[2]-a.usrCoords[2],f=c.usrCoords[1]-a.usrCoords[1],g=c.usrCoords[2]-a.usrCoords[2],Math.abs(d)<JXG.Math.eps&&(d=0),Math.abs(e)<JXG.Math.eps&&(e=0),Math.abs(f)<JXG.Math.eps&&(f=0),Math.abs(g)<JXG.Math.eps&&(g=0),d>=0&&f>=0?(e>=0&&g>=0||0>=e&&0>=g)&&(h=!0):0>=d&&0>=f&&(e>=0&&g>=0||0>=e&&0>=g)&&(h=!0),h},intersectLineLine:function(a,b,c){var h,i,j,k,l,d=a.point1.coords.usrCoords,e=a.point2.coords.usrCoords,f=b.point1.coords.usrCoords,g=b.point2.coords.usrCoords;return JXG.exists(c)||(c=a.board),h=d[1]*e[2]-d[2]*e[1],i=f[1]*g[2]-f[2]*g[1],j=(e[2]-d[2])*(f[1]-g[1])-(d[1]-e[1])*(g[2]-f[2]),Math.abs(j)<JXG.Math.eps&&(j=JXG.Math.eps),k=(h*(f[1]-g[1])-i*(d[1]-e[1]))/j,l=(i*(e[2]-d[2])-h*(g[2]-f[2]))/j,new JXG.Coords(JXG.COORDS_BY_USER,[k,l],c)},intersectCircleLine:function(a,b,c){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,d=b.point1.coords.usrCoords,e=b.point2.coords.usrCoords,f=a.center.coords.usrCoords;return JXG.exists(c)||(c=b.board),g=b.point1.Dist(b.point2),g>0?(h=a.center.Dist(b.point1),i=a.center.Dist(b.point2),j=(h*h+g*g-i*i)/(2*g),k=h*h-j*j,k=0>k?0:k,l=Math.sqrt(k),m=a.Radius(),n=Math.sqrt(m*m-l*l),o=e[1]-d[1],p=e[2]-d[2],q=f[1]+l/g*p,r=f[2]-l/g*o,h=e[1]*p-e[2]*o,i=q*o+r*p,s=p*p+o*o,Math.abs(s)<JXG.Math.eps&&(s=JXG.Math.eps),t=(h*p+i*o)/s,u=(i*p-h*o)/s,v=n/g,w=new JXG.Coords(JXG.COORDS_BY_USER,[t+v*o,u+v*p],c),x=new JXG.Coords(JXG.COORDS_BY_USER,[t-v*o,u-v*p],c),y=a.center.coords.distance(JXG.COORDS_BY_USER,w),y-1>m||isNaN(y)?[0]:[2,w,x]):[0]},intersectCircleCircle:function(a,b,c){var i,j,k,l,m,n,o,d={},e=a.Radius(),f=b.Radius(),g=a.center.coords.usrCoords,h=b.center.coords.usrCoords;return JXG.exists(c)||(c=a.board),i=e+f,j=Math.abs(e-f),k=a.center.coords.distance(JXG.COORDS_BY_USER,b.center.coords),k>i?[0]:j>k?[0]:0==k?[0]:(d[0]=1,l=h[1]-g[1],m=h[2]-g[2],n=(k*k-f*f+e*e)/(2*k),o=Math.sqrt(e*e-n*n),d[1]=new JXG.Coords(JXG.COORDS_BY_USER,[g[1]+n/k*l+o/k*m,g[2]+n/k*m-o/k*l],c),d[2]=new JXG.Coords(JXG.COORDS_BY_USER,[g[1]+n/k*l-o/k*m,g[2]+n/k*m+o/k*l],c),d)},meet:function(a,b,c,d){var e=JXG.Math.eps;return Math.abs(a[3])<e&&Math.abs(b[3])<e?this.meetLineLine(a,b,c,d):Math.abs(a[3])>=e&&Math.abs(b[3])<e?this.meetLineCircle(b,a,c,d):Math.abs(a[3])<e&&Math.abs(b[3])>=e?this.meetLineCircle(a,b,c,d):this.meetCircleCircle(a,b,c,d)},meetLineLine:function(a,b,c,d){var e=JXG.Math.crossProduct(a,b);return Math.abs(e[0])>JXG.Math.eps&&(e[1]/=e[0],e[2]/=e[0],e[0]=1),new JXG.Coords(JXG.COORDS_BY_USER,e,d)},meetLineCircle:function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n;return b[4]<JXG.Math.eps?Math.abs(JXG.Math.innerProduct([1,b[6],b[7]],a,3))<JXG.Math.eps?new JXG.Coords(JXG.COORDS_BY_USER,b.slice(6,8),d):new JXG.Coords(JXG.COORDS_BY_USER,[0/0,0/0],d):(g=b[0],f=b.slice(1,3),e=b[3],h=a[0],i=a.slice(1,3),j=e,k=f[0]*i[1]-f[1]*i[0],l=e*h*h-(f[0]*i[0]+f[1]*i[1])*h+g,m=k*k-4*j*l,m>=0?(m=Math.sqrt(m),n=[(-k+m)/(2*j),(-k-m)/(2*j)],0==c?new JXG.Coords(JXG.COORDS_BY_USER,[-n[0]*-i[1]-h*i[0],-n[0]*i[0]-h*i[1]],d):new JXG.Coords(JXG.COORDS_BY_USER,[-n[1]*-i[1]-h*i[0],-n[1]*i[0]-h*i[1]],d)):new JXG.Coords(JXG.COORDS_BY_USER,[0,0,0],d))},meetCircleCircle:function(a,b,c,d){var e;return a[4]<JXG.Math.eps?Math.abs(this.distance(a.slice(6,2),b.slice(6,8))-b[4])<JXG.Math.eps?new JXG.Coords(JXG.COORDS_BY_USER,a.slice(6,8),d):new JXG.Coords(JXG.COORDS_BY_USER,[0,0,0],d):b[4]<JXG.Math.eps?Math.abs(this.distance(b.slice(6,2),a.slice(6,8))-a[4])<JXG.Math.eps?new JXG.Coords(JXG.COORDS_BY_USER,b.slice(6,8),d):new JXG.Coords(JXG.COORDS_BY_USER,[0,0,0],d):(e=[b[3]*a[0]-a[3]*b[0],b[3]*a[1]-a[3]*b[1],b[3]*a[2]-a[3]*b[2],0,1,1/0,1/0,1/0],e=JXG.Math.normalize(e),this.meetLineCircle(e,a,c,d))},meetCurveCurve:function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,f=0;for(JXG.exists(e)||(e=a.board),arguments.callee.t1memo?(g=arguments.callee.t1memo,h=arguments.callee.t2memo):(g=c,h=d),n=a.X(g)-b.X(h),o=a.Y(g)-b.Y(h),p=n*n+o*o,q=a.board.D(a.X,a),r=b.board.D(b.X,b),s=a.board.D(a.Y,a),t=b.board.D(b.Y,b);p>JXG.Math.eps&&10>f;)i=q(g),j=-r(h),k=s(g),l=-t(h),m=i*l-j*k,g-=(l*n-j*o)/m,h-=(i*o-k*n)/m,n=a.X(g)-b.X(h),o=a.Y(g)-b.Y(h),p=n*n+o*o,f++;return arguments.callee.t1memo=g,arguments.callee.t2memo=h,Math.abs(g)<Math.abs(h)?new JXG.Coords(JXG.COORDS_BY_USER,[a.X(g),a.Y(g)],e):new JXG.Coords(JXG.COORDS_BY_USER,[b.X(h),b.Y(h)],e)},meetCurveLine:function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r;for(JXG.exists(d)||(d=a.board),g=0;1>=g;g++)if(arguments[g].elementClass==JXG.OBJECT_CLASS_CURVE)h=arguments[g];else{if(arguments[g].elementClass!=JXG.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't call meetCurveLine with parent class "+arguments[g].elementClass+".");i=arguments[g]}if(j=function(a){return i.stdform[0]+i.stdform[1]*h.X(a)+i.stdform[2]*h.Y(a)},arguments.callee.t1memo?(o=arguments.callee.t1memo,e=JXG.Math.Numerics.root(j,o)):(o=h.minX(),p=h.maxX(),e=JXG.Math.Numerics.root(j,[o,p])),arguments.callee.t1memo=e,q=h.X(e),r=h.Y(e),1==c){if(arguments.callee.t2memo&&(o=arguments.callee.t2memo,f=JXG.Math.Numerics.root(j,o)),!(Math.abs(f-e)>.1&&Math.abs(q-h.X(f))>.1&&Math.abs(r-h.Y(f))>.1))for(m=20,n=(h.maxX()-h.minX())/m,l=h.minX(),g=0;m>g&&(f=JXG.Math.Numerics.root(j,[l,l+n]),!(Math.abs(f-e)>.1&&Math.abs(q-h.X(f))>.1&&Math.abs(r-h.Y(f))>.1));g++)l+=n;e=f,arguments.callee.t2memo=e}return k=Math.abs(j(e))>JXG.Math.eps?0:1,new JXG.Coords(JXG.COORDS_BY_USER,[k,h.X(e),h.Y(e)],d)},projectPointToCircle:function(a,b,c){var g,h,i,d=a.coords.distance(JXG.COORDS_BY_USER,b.center.coords),e=a.coords.usrCoords,f=b.center.coords.usrCoords;return JXG.exists(c)||(c=a.board),Math.abs(d)<JXG.Math.eps&&(d=JXG.Math.eps),i=b.Radius()/d,g=f[1]+i*(e[1]-f[1]),h=f[2]+i*(e[2]-f[2]),new JXG.Coords(JXG.COORDS_BY_USER,[g,h],c)},projectPointToLine:function(a,b,c){var d=[0,b.stdform[1],b.stdform[2]];return JXG.exists(c)||(c=a.board),d=JXG.Math.crossProduct(d,a.coords.usrCoords),this.meetLineLine(d,b.stdform,0,c)},projectPointToCurve:function(a,b,c){JXG.exists(c)||(c=a.board);var d=a.X(),e=a.Y(),f=a.position||0,g=this.projectCoordsToCurve(d,e,f,b,c);return a.position=g[1],g[0]},projectCoordsToCurve:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,s=Number.POSITIVE_INFINITY;if(JXG.exists(e)||(e=d.board),"parameter"==d.visProp.curvetype||"polar"==d.visProp.curvetype){for(t=function(c){var e=a-d.X(c),f=b-d.Y(c);return e*e+f*f},w=t(c),y=20,x=(d.maxX()-d.minX())/y,u=d.minX(),g=0;y>g;g++)v=t(u),w>v&&(c=u,w=v),u+=x;c=JXG.Math.Numerics.root(JXG.Math.Numerics.D(t),c),c<d.minX()&&(c=d.maxX()+c-d.minX()),c>d.maxX()&&(c=d.minX()+c-d.maxX()),f=new JXG.Coords(JXG.COORDS_BY_USER,[d.X(c),d.Y(c)],e)}else if("plot"==d.visProp.curvetype)if(c=0,l=s,0==d.numberPoints)f=new JXG.Coords(JXG.COORDS_BY_USER,[0,1,1],e);else if(1==d.numberPoints)f=new JXG.Coords(JXG.COORDS_BY_USER,[d.Z(0),d.X(0),d.Y(0)],e);else for(g=0;g<d.numberPoints-1;g++)o=JXG.Math.crossProduct([d.Z(g+1),d.X(g+1),d.Y(g+1)],[d.Z(g),d.X(g),d.Y(g)]),p=[0,o[1],o[2]],p=JXG.Math.crossProduct(p,[1,a,b]),q=this.meetLineLine(p,o,0,e),j=d.X(g+1)-d.X(g),k=d.Y(g+1)-d.Y(g),Math.abs(j)>JXG.Math.eps?(h=q.usrCoords[1]-d.X(g),n=h/j):Math.abs(k)>JXG.Math.eps?(i=q.usrCoords[1]-d.Y(g),n=i/k):(n=0,q=new JXG.Coords(JXG.COORDS_BY_USER,[d.Z(g),d.X(g),d.Y(g)],e)),n>=0&&1>=n?(m=this.distance(q.usrCoords,[1,a,b]),r=g+n):0>n?(q=new JXG.Coords(JXG.COORDS_BY_USER,[d.Z(g),d.X(g),d.Y(g)],e),m=this.distance(q.usrCoords,[1,a,b]),r=g):n>1&&g+1==d.numberPoints-1&&(q=new JXG.Coords(JXG.COORDS_BY_USER,[d.Z(g+1),d.X(g+1),d.Y(g+1)],e),m=this.distance(q.usrCoords,[1,a,b]),r=d.numberPoints-1),l>m&&(l=m,c=r,f=q);else c=a,a=c,b=d.Y(c),f=new JXG.Coords(JXG.COORDS_BY_USER,[a,b],e);return[d.updateTransform(f),c]},projectPointToTurtle:function(a,b,c){var d,e,f,g,h,l,m,n,i=0,j=0,k=Number.POSITIVE_INFINITY,o=b.objects.length;for(JXG.exists(c)||(c=a.board),h=0;o>h;h++)m=b.objects[h],m.elementClass==JXG.OBJECT_CLASS_CURVE&&(d=this.projectPointToCurve(a,m),l=this.distance(d.usrCoords,a.coords.usrCoords),k>l&&(f=d.usrCoords[1],g=d.usrCoords[2],e=a.position,k=l,n=m,j=i),i+=m.numberPoints);return d=new JXG.Coords(JXG.COORDS_BY_USER,[f,g],c),a.position=e+j,n.updateTransform(d)},projectPointToPoint:function(a,b){return b.coords}}),JXG.Math.Poly={},JXG.Math.Poly.Ring=function(a){this.vars=a},JXG.extend(JXG.Math.Poly.Ring.prototype,{}),JXG.Math.Poly.Monomial=function(a,b,c){var d;if(!JXG.exists(a))throw new Error("JSXGraph error: In JXG.Math.Poly.monomial missing parameter 'ring'.");for(JXG.isArray(c)||(c=[]),c=c.slice(0,a.vars.length),d=c.length;d<a.vars.length;d++)c.push(0);this.ring=a,this.coefficient=b||0,this.exponents=JXG.deepCopy(c)},JXG.extend(JXG.Math.Poly.Monomial.prototype,{copy:function(){return new JXG.Math.Poly.Monomial(this.ring,this.coefficient,this.exponents)},print:function(){var b,a=[];for(b=0;b<this.ring.vars.length;b++)a.push(this.ring.vars[b]+"^"+this.exponents[b]);return this.coefficient+"*"+a.join("*")}}),JXG.Math.Poly.Polynomial=function(a,b){var d,c=function(){};if(!JXG.exists(a))throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial missing parameter 'ring'.");d=JXG.exists(b)&&"string"==typeof b?c(b):[],this.ring=a,this.monomials=d},JXG.extend(JXG.Math.Poly.Polynomial.prototype,{findSignature:function(a){var b;for(b=0;b<this.monomials.length;b++)if(JXG.cmpArrays(this.monomials[b].exponents,a))return b;return-1},addSubMonomial:function(a,b){var c;c=this.findSignature(a.exponents),c>-1?this.monomials[c].coefficient+=b*a.coefficient:(a.coefficient*=b,this.monomials.push(a))},add:function(a){var b;if(!JXG.exists(a)||a.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.add either summand is undefined or rings don't match.");if(JXG.isArray(a.exponents))this.addSubMonomial(a,1);else for(b=0;b<a.monomials.length;b++)this.addSubMonomial(a.monomials[b],1)},sub:function(a){var b;if(!JXG.exists(a)||a.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.sub either summand is undefined or rings don't match.");if(JXG.isArray(a.exponents))this.addSubMonomial(a,-1);else for(b=0;b<a.monomials.length;b++)this.addSubMonomial(a.monomials[b],-1)},copy:function(){var a,b;for(b=new JXG.Math.Poly.Polynomial(this.ring),a=0;a<this.monomials.length;a++)b.monomials.push(this.monomials[a].copy());return b},print:function(){var b,a=[];for(b=0;b<this.monomials.length;b++)a.push("("+this.monomials[b].print()+")");return a.join("+")}}),JXG.Complex=function(a,b){this.isComplex=!0,"undefined"==typeof a&&(a=0),"undefined"==typeof b&&(b=0),a.isComplex&&(b=a.imaginary,a=a.real),this.real=a,this.imaginary=b,this.absval=0,this.angle=0},JXG.extend(JXG.Complex.prototype,{toString:function(){return""+this.real+" + "+this.imaginary+"i"},add:function(a){"number"==typeof a?this.real+=a:(this.real+=a.real,this.imaginary+=a.imaginary)},sub:function(a){"number"==typeof a?this.real-=a:(this.real-=a.real,this.imaginary-=a.imaginary)},mult:function(a){var b,c;"number"==typeof a?(this.real*=a,this.imaginary*=a):(b=this.real,c=this.imaginary,this.real=b*a.real-c*a.imaginary,this.imaginary=b*a.imaginary+c*a.real)},div:function(a){var b,c,d;if("number"==typeof a){if(Math.abs(a)<Math.eps)return this.real=1/0,this.imaginary=1/0,void 0;this.real/=a,this.imaginary/=a}else{if(Math.abs(a.real)<Math.eps&&Math.abs(a.imaginary)<Math.eps)return this.real=1/0,this.imaginary=1/0,void 0;b=a.real*a.real+a.imaginary*a.imaginary,d=this.real,c=this.imaginary,this.real=(d*a.real+c*a.imaginary)/b,this.imaginary=(c*a.real-d*a.imaginary)/b}},conj:function(){this.imaginary*=-1}}),JXG.C={},JXG.C.add=function(a,b){var c=new JXG.Complex(a);return c.add(b),c},JXG.C.sub=function(a,b){var c=new JXG.Complex(a);return c.sub(b),c},JXG.C.mult=function(a,b){var c=new JXG.Complex(a);return c.mult(b),c},JXG.C.div=function(a,b){var c=new JXG.Complex(a);return c.div(b),c},JXG.C.conj=function(a){var b=new JXG.Complex(a);return b.conj(),b},JXG.C.abs=function(a){var b=new JXG.Complex(a);return b.conj(),b.mult(a),Math.sqrt(b.real)},JXG.AbstractRenderer=function(){this.vOffsetText=0,this.enhancedRendering=!0,this.container=null,this.type=""},JXG.extend(JXG.AbstractRenderer.prototype,{_updateVisual:function(a,b,c){(c||this.enhancedRendering)&&(b=b||{},a.visProp.draft?this.setDraft(a):(b.stroke||(this.setObjectStrokeWidth(a,a.visProp.strokewidth),this.setObjectStrokeColor(a,a.visProp.strokecolor,a.visProp.strokeopacity)),b.fill||this.setObjectFillColor(a,a.visProp.fillcolor,a.visProp.fillopacity),b.dash||this.setDashStyle(a,a.visProp),b.shadow||this.setShadow(a),b.gradient||this.setShadow(a)))},drawPoint:function(a){var b,c=JXG.Point.prototype.normalizeFace.call(this,a.visProp.face);b="o"===c?"ellipse":"[]"===c?"rect":"path",this.appendChildPrim(this.createPrim(b,a.id),a.visProp.layer),this.appendNodesToElement(a,b),this._updateVisual(a,{dash:!0,shadow:!0},!0),this.updatePoint(a)},updatePoint:function(a){var b=a.visProp.size,c=JXG.Point.prototype.normalizeFace.call(this,a.visProp.face);isNaN(a.coords.scrCoords[2]+a.coords.scrCoords[1])||(this._updateVisual(a,{dash:!1,shadow:!1}),b*=a.board&&a.board.options.point.zoom?Math.sqrt(a.board.zoomX*a.board.zoomY):1,"o"===c?this.updateEllipsePrim(a.rendNode,a.coords.scrCoords[1],a.coords.scrCoords[2],b+1,b+1):"[]"===c?this.updateRectPrim(a.rendNode,a.coords.scrCoords[1]-b,a.coords.scrCoords[2]-b,2*b,2*b):this.updatePathPrim(a.rendNode,this.updatePathStringPoint(a,b,c),a.board),this.setShadow(a))},changePointStyle:function(a){var b=this.getElementById(a.id);JXG.exists(b)&&this.remove(b),this.drawPoint(a),JXG.clearVisPropOld(a),a.visProp.visible||this.hide(a),a.visProp.draft&&this.setDraft(a)},drawLine:function(a){this.appendChildPrim(this.createPrim("line",a.id),a.visProp.layer),this.appendNodesToElement(a,"lines"),this.updateLine(a)},updateLine:function(a){var b=new JXG.Coords(JXG.COORDS_BY_USER,a.point1.coords.usrCoords,a.board),c=new JXG.Coords(JXG.COORDS_BY_USER,a.point2.coords.usrCoords,a.board),d=null;(a.visProp.firstarrow||a.visProp.lastarrow)&&(d=0),JXG.Math.Geometry.calcStraight(a,b,c,d),this.updateLinePrim(a.rendNode,b.scrCoords[1],b.scrCoords[2],c.scrCoords[1],c.scrCoords[2],a.board),this.makeArrows(a),this._updateVisual(a,{fill:!0})},drawTicks:function(a){var b=this.createPrim("path",a.id);this.appendChildPrim(b,a.visProp.layer),this.appendNodesToElement(a,"path")},updateTicks:function(){},drawCurve:function(a){this.appendChildPrim(this.createPrim("path",a.id),a.visProp.layer),this.appendNodesToElement(a,"path"),this._updateVisual(a,{shadow:!0},!0),this.updateCurve(a)},updateCurve:function(a){this._updateVisual(a),a.visProp.handdrawing?this.updatePathPrim(a.rendNode,this.updatePathStringBezierPrim(a),a.board):this.updatePathPrim(a.rendNode,this.updatePathStringPrim(a),a.board),this.makeArrows(a)},drawEllipse:function(a){this.appendChildPrim(this.createPrim("ellipse",a.id),a.visProp.layer),this.appendNodesToElement(a,"ellipse"),this.updateEllipse(a)},updateEllipse:function(a){this._updateVisual(a);var b=a.Radius();b>0&&Math.abs(a.center.coords.usrCoords[0])>JXG.Math.eps&&!isNaN(b+a.center.coords.scrCoords[1]+a.center.coords.scrCoords[2])&&b*a.board.unitX<2e6&&this.updateEllipsePrim(a.rendNode,a.center.coords.scrCoords[1],a.center.coords.scrCoords[2],b*a.board.unitX,b*a.board.unitY)},drawPolygon:function(a){this.appendChildPrim(this.createPrim("polygon",a.id),a.visProp.layer),this.appendNodesToElement(a,"polygon"),this.updatePolygon(a)},updatePolygon:function(a){this._updateVisual(a,{stroke:!0,dash:!0}),this.updatePolygonPrim(a.rendNode,a)},displayCopyright:function(){},drawInternalText:function(){},updateInternalText:function(){},drawText:function(a){var b,c;"html"===a.visProp.display?(b=this.container.ownerDocument.createElement("div"),b.style.position="absolute",b.className=a.visProp.cssclass,c=""==this.container.style.zIndex?0:parseInt(this.container.style.zIndex),b.style.zIndex=c+a.board.options.layer.text,this.container.appendChild(b),b.setAttribute("id",this.container.id+"_"+a.id)):b=this.drawInternalText(a),a.rendNode=b,a.htmlStr="",this.updateText(a)},updateText:function(a){var b=a.plaintext;a.visProp.visible&&(this.updateTextStyle(a,!1),"html"===a.visProp.display?(isNaN(a.coords.scrCoords[1]+a.coords.scrCoords[2])||("right"===a.visProp.anchorx?a.rendNode.style.right=parseInt(a.board.canvasWidth-a.coords.scrCoords[1])+"px":a.rendNode.style.left="middle"===a.visProp.anchorx?parseInt(a.coords.scrCoords[1]-.5*a.size[0])+"px":parseInt(a.coords.scrCoords[1])+"px",a.rendNode.style.top="top"===a.visProp.anchory?parseInt(a.coords.scrCoords[2]+this.vOffsetText)+"px":"middle"===a.visProp.anchory?parseInt(a.coords.scrCoords[2]-.5*a.size[1]+this.vOffsetText)+"px":parseInt(a.coords.scrCoords[2]-a.size[1]+this.vOffsetText)+"px"),a.htmlStr!==b&&(a.rendNode.innerHTML=b,a.htmlStr=b,a.visProp.usemathjax?MathJax.Hub.Queue(["Typeset",MathJax.Hub,a.rendNode]):a.visProp.useasciimathml&&AMprocessNode(a.rendNode,!1)),this.transformImage(a,a.transformations)):this.updateInternalText(a))},updateTextStyle:function(a,b){var c,d,e,f,g=a.visProp;if(b?(e=g.highlightstrokecolor,d=g.highlightstrokeopacity,f=g.highlightcssclass):(e=g.strokecolor,d=g.strokeopacity,f=g.cssclass),"html"===a.visProp.display||"canvas"!=this.type){if(c=JXG.evaluate(a.visProp.fontsize),a.visPropOld.fontsize!=c){try{a.rendNode.style.fontSize=c+"px"}catch(h){a.rendNode.style.fontSize=c}a.visPropOld.fontsize=c}a.visPropOld.cssclass!=f&&(a.rendNode.className=f,a.visPropOld.cssclass=f)}return"html"===a.visProp.display?this.setObjectStrokeColor(a,e,d):this.updateInternalTextStyle(a,e,d),this},updateInternalTextStyle:function(a,b,c){this.setObjectStrokeColor(a,b,c)},drawImage:function(){},updateImage:function(a){this.updateRectPrim(a.rendNode,a.coords.scrCoords[1],a.coords.scrCoords[2]-a.size[1],a.size[0],a.size[1]),this.updateImageURL(a),this.transformImage(a,a.transformations),this._updateVisual(a,{stroke:!0,dash:!0},!0)},joinTransforms:function(a,b){var l,c=[[1,0,0],[0,1,0],[0,0,1]],d=a.board.origin.scrCoords[1],e=a.board.origin.scrCoords[2],f=a.board.unitX,g=a.board.unitY,h=[[1,0,0],[-d,1,0],[-e,0,1]],i=[[1,0,0],[0,1/f,0],[0,0,-1/g]],j=[[1,0,0],[0,f,0],[0,0,-g]],k=[[1,0,0],[d,1,0],[e,0,1]],m=b.length;for(l=0;m>l;l++)c=JXG.Math.matMatMult(h,c),c=JXG.Math.matMatMult(i,c),c=JXG.Math.matMatMult(b[l].matrix,c),c=JXG.Math.matMatMult(j,c),c=JXG.Math.matMatMult(k,c);return c},transformImage:function(){},updateImageURL:function(){},appendChildPrim:function(){},appendNodesToElement:function(){},createPrim:function(){return null},remove:function(){},makeArrows:function(){},updateEllipsePrim:function(){},updateLinePrim:function(){},updatePathPrim:function(){},updatePathStringPoint:function(){},updatePathStringPrim:function(){},updatePathStringBezierPrim:function(){},updatePolygonPrim:function(){},updateRectPrim:function(){},setPropertyPrim:function(){},show:function(){},hide:function(){},setBuffering:function(){},setDashStyle:function(){},setDraft:function(a){if(a.visProp.draft){var b=a.board.options.elements.draft.color,c=a.board.options.elements.draft.opacity;a.type===JXG.OBJECT_TYPE_POLYGON?this.setObjectFillColor(a,b,c):(a.elementClass===JXG.OBJECT_CLASS_POINT?this.setObjectFillColor(a,b,c):this.setObjectFillColor(a,"none",0),this.setObjectStrokeColor(a,b,c),this.setObjectStrokeWidth(a,a.board.options.elements.draft.strokeWidth))}},removeDraft:function(a){a.type===JXG.OBJECT_TYPE_POLYGON?this.setObjectFillColor(a,a.visProp.fillcolor,a.visProp.fillopacity):(a.type===JXG.OBJECT_CLASS_POINT&&this.setObjectFillColor(a,a.visProp.fillcolor,a.visProp.fillopacity),this.setObjectStrokeColor(a,a.visProp.strokecolor,a.visProp.strokeopacity),this.setObjectStrokeWidth(a,a.visProp.strokewidth))},setGradient:function(){},updateGradient:function(){},setObjectFillColor:function(){},setObjectStrokeColor:function(){},setObjectStrokeWidth:function(){},setShadow:function(){},highlight:function(a){var b,c=a.visProp;if(!c.draft){if(a.type===JXG.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(a,c.highlightfillcolor,c.highlightfillopacity),b=0;b<a.borders.length;b++)this.setObjectStrokeColor(a.borders[b],a.borders[b].visProp.highlightstrokecolor,a.borders[b].visProp.highlightstrokeopacity);else a.type===JXG.OBJECT_TYPE_TEXT?this.updateTextStyle(a,!0):(this.setObjectStrokeColor(a,c.highlightstrokecolor,c.highlightstrokeopacity),this.setObjectFillColor(a,c.highlightfillcolor,c.highlightfillopacity));c.highlightstrokewidth&&this.setObjectStrokeWidth(a,Math.max(c.highlightstrokewidth,c.strokewidth))}return this},noHighlight:function(a){var b,c=a.visProp;if(!a.visProp.draft){if(a.type===JXG.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(a,c.fillcolor,c.fillopacity),b=0;b<a.borders.length;b++)this.setObjectStrokeColor(a.borders[b],a.borders[b].visProp.strokecolor,a.borders[b].visProp.strokeopacity);else a.type===JXG.OBJECT_TYPE_TEXT?this.updateTextStyle(a,!1):(this.setObjectStrokeColor(a,c.strokecolor,c.strokeopacity),this.setObjectFillColor(a,c.fillcolor,c.fillopacity));this.setObjectStrokeWidth(a,c.strokewidth)}return this},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(a){var b,c,d=function(d,e){var f;f=b.createElement("span"),c.appendChild(f),f.appendChild(document.createTextNode(d)),JXG.addEvent(f,"click",e,a)};b=a.containerObj.ownerDocument,c=b.createElement("div"),c.setAttribute("id",a.containerObj.id+"_navigationbar"),c.style.color=a.options.navbar.strokeColor,c.style.backgroundColor=a.options.navbar.fillColor,c.style.padding=a.options.navbar.padding,c.style.position=a.options.navbar.position,c.style.fontSize=a.options.navbar.fontSize,c.style.cursor=a.options.navbar.cursor,c.style.zIndex=a.options.navbar.zIndex,a.containerObj.appendChild(c),c.style.right=a.options.navbar.right,c.style.bottom=a.options.navbar.bottom,d("\xa0\u2013\xa0",a.zoomOut),d("\xa0o\xa0",a.zoom100),d("\xa0+\xa0",a.zoomIn),d("\xa0\u2190\xa0",a.clickLeftArrow),d("\xa0\u2193\xa0",a.clickUpArrow),d("\xa0\u2191\xa0",a.clickDownArrow),d("\xa0\u2192\xa0",a.clickRightArrow)},getElementById:function(a){return document.getElementById(this.container.id+"_"+a)},resize:function(){}}),JXG.NoRenderer=function(){this.enhancedRendering=!1,this.type="no"},JXG.extend(JXG.NoRenderer.prototype,{drawPoint:function(){},updatePoint:function(){},changePointStyle:function(){},drawLine:function(){},updateLine:function(){},drawTicks:function(){},updateTicks:function(){},drawCurve:function(){},updateCurve:function(){},drawEllipse:function(){},updateEllipse:function(){},drawPolygon:function(){},updatePolygon:function(){},displayCopyright:function(){},drawInternalText:function(){},updateInternalText:function(){},drawText:function(){},updateText:function(){},updateTextStyle:function(){},updateInternalTextStyle:function(){},drawImage:function(){},updateImage:function(){},transformImage:function(){},updateImageURL:function(){},appendChildPrim:function(){},appendNodesToElement:function(){},createPrim:function(){return null},remove:function(){},makeArrows:function(){},updateEllipsePrim:function(){},updateLinePrim:function(){},updatePathPrim:function(){},updatePathStringPoint:function(){},updatePathStringPrim:function(){},updatePathStringBezierPrim:function(){},updatePolygonPrim:function(){},updateRectPrim:function(){},setPropertyPrim:function(){},show:function(){},hide:function(){},setBuffering:function(){},setDashStyle:function(){},setDraft:function(){},removeDraft:function(){},setGradient:function(){},updateGradient:function(){},setObjectFillColor:function(){},setObjectStrokeColor:function(){},setObjectStrokeWidth:function(){},setShadow:function(){},highlight:function(){},noHighlight:function(){},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(){},getElementById:function(){return null
},resize:function(){}}),JXG.FileReader={parseFileContent:function(a,b,c,d){var e=!1;JXG.exists(d)||(d=!0);try{e=new XMLHttpRequest,"raw"==c.toLowerCase()?e.overrideMimeType("text/plain; charset=iso-8859-1"):e.overrideMimeType("text/xml; charset=iso-8859-1")}catch(f){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(f){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(f){e=!1}}}if(!e)return alert("AJAX not activated!"),void 0;e.open("GET",a,d),this.cbp="raw"===c.toLowerCase()?function(){var a=e;4==a.readyState&&b(a.responseText)}:function(){var a=e;if(4==a.readyState){var d="";d="undefined"==typeof a.responseStream||"PK"!=a.responseText.slice(0,2)&&31!=JXG.Util.asciiCharCodeAt(a.responseText.slice(0,1),0)?a.responseText:JXG.Util.Base64.decode(BinFileReader(a)),this.parseString(d,b,c,!1)}},this.cb=JXG.bind(this.cbp,this),e.onreadystatechange=this.cb;try{e.send(null)}catch(f){throw new Error("JSXGraph: A problem occurred while trying to read '"+a+"'.")}},cleanWhitespace:function(a){for(var b=a.firstChild;null!=b;)3!=b.nodeType||/\S/.test(b.nodeValue)?1==b.nodeType&&this.cleanWhitespace(b):a.removeChild(b),b=b.nextSibling},stringToXMLTree:function(a){"undefined"==typeof DOMParser&&(DOMParser=function(){},DOMParser.prototype.parseFromString=function(a){if("undefined"!=typeof ActiveXObject){var c=new ActiveXObject("MSXML.DomDocument");return c.loadXML(a),c}});var b=new DOMParser,c=b.parseFromString(a,"text/xml");return this.cleanWhitespace(c),c},parseString:function(a,b,c,d){var e,g;switch(c=c.toLowerCase()){case"cdy":case"cinderella":d&&(a=JXG.Util.Base64.decode(a)),a=JXG.CinderellaReader.readCinderella(a,b),b.xmlString=a;break;case"tracenpoche":b.xmlString=JXG.TracenpocheReader.readTracenpoche(a,b);break;case"graph":a=JXG.GraphReader.readGraph(a,b,!1);break;case"digraph":a=JXG.GraphReader.readGraph(a,updateboard,!0);break;case"geonext":a=JXG.GeonextReader.prepareString(a),g=!0;break;case"geogebra":d="PK"!==a.slice(0,2),a=JXG.GeogebraReader.prepareString(a,d),g=!0;break;case"intergeo":d&&(a=JXG.Util.Base64.decode(a)),a=JXG.IntergeoReader.prepareString(a),g=!0}g&&(b.xmlString=a,e=this.stringToXMLTree(a),this.readElements(e,b,c))},readElements:function(a,b,c){"geonext"==c.toLowerCase()?(b.suspendUpdate(),0!=a.getElementsByTagName("GEONEXT").length&&JXG.GeonextReader.readGeonext(a,b),b.unsuspendUpdate()):0!=a.getElementsByTagName("geogebra").length?JXG.GeogebraReader.readGeogebra(a,b):"intergeo"==c.toLowerCase()&&JXG.IntergeoReader.readIntergeo(a,b)}},/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent&&document&&document.write)&&document.write('<script type="text/vbscript">\nFunction Base64Encode(inData)\n  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"\n  Dim cOut, sOut, I\n  For I = 1 To LenB(inData) Step 3\n    Dim nGroup, pOut, sGroup\n    nGroup = &H10000 * AscB(MidB(inData, I, 1)) + _\n      &H100 * MyASC(MidB(inData, I + 1, 1)) + MyASC(MidB(inData, I + 2, 1))\n    nGroup = Oct(nGroup)\n    nGroup = String(8 - Len(nGroup), "0") & nGroup\n    pOut = Mid(Base64, CLng("&o" & Mid(nGroup, 1, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 3, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 5, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 7, 2)) + 1, 1)\n    sOut = sOut + pOut\n  Next\n  Select Case LenB(inData) Mod 3\n    Case 1: \'8 bit final\n      sOut = Left(sOut, Len(sOut) - 2) + "=="\n    Case 2: \'16 bit final\n      sOut = Left(sOut, Len(sOut) - 1) + "="\n  End Select\n  Base64Encode = sOut\nEnd Function\n\nFunction MyASC(OneChar)\n  If OneChar = "" Then MyASC = 0 Else MyASC = AscB(OneChar)\nEnd Function\n\nFunction BinFileReader(xhr)\n    Dim byteString\n    Dim b64String\n    Dim i\n    byteString = xhr.responseBody\n    ReDim byteArray(LenB(byteString))\n    For i = 1 To LenB(byteString)\n        byteArray(i-1) = AscB(MidB(byteString, i, 1))\n    Next\n    b64String = Base64Encode(byteString)\n    BinFileReader = b64String\nEnd Function\n</script>\n'),JXG.GeonextParser={},JXG.GeonextParser.replacePow=function(a){var b,c,d,e,f,g,h,i,j,k,l;for(a=a.replace(/(\s*)\^(\s*)/g,"^"),j=a.indexOf("^");j>=0;){if(i=a.slice(0,j),k=a.slice(j+1),")"==i.charAt(i.length-1)){for(b=1,c=i.length-2;c>=0&&b>0;)d=i.charAt(c),")"==d?b++:"("==d&&b--,c--;if(0!=b)throw new Error("JSXGraph: Missing '(' in expression");for(e="",g=i.substring(0,c+1),h=c;h>=0&&g.substr(h,1).match(/([\w\.]+)/);)e=RegExp.$1+e,h--;e+=i.substring(c+1,i.length),e=e.replace(/([\(\)\+\*\%\^\-\/\]\[])/g,"\\$1")}else e="[\\w\\.]+";if(k.match(/^([\w\.]*\()/)){for(b=1,c=RegExp.$1.length;c<k.length&&b>0;)d=k.charAt(c),")"==d?b--:"("==d&&b++,c++;if(0!=b)throw new Error("JSXGraph: Missing ')' in expression");f=k.substring(0,c),f=f.replace(/([\(\)\+\*\%\^\-\/\[\]])/g,"\\$1")}else f="[\\w\\.]+";l=new RegExp("("+e+")\\^("+f+")"),a=a.replace(l,"JXG.Math.pow($1,$2)"),j=a.indexOf("^")}return a},JXG.GeonextParser.replaceIf=function(a){var c,d,h,i,j,k,l,m,n,b="",e=null,f=null,g=null;if(h=a.indexOf("If("),0>h)return a;for(a=a.replace(/""/g,"0");h>=0;){for(c=a.slice(0,h),d=a.slice(h+3),j=1,i=0,k=-1,l=-1;i<d.length&&j>0;)m=d.charAt(i),")"==m?j--:"("==m?j++:","==m&&1==j&&(0>k?k=i:l=i),i++;if(n=d.slice(0,i-1),d=d.slice(i),0>k)return"";if(0>l)return"";e=n.slice(0,k),f=n.slice(k+1,l),g=n.slice(l+1),e=this.replaceIf(e),f=this.replaceIf(f),g=this.replaceIf(g),b+=c+"(("+e+")?("+f+"):("+g+"))",a=d,e=null,f=null,h=a.indexOf("If(")}return b+=d},JXG.GeonextParser.replaceSub=function(a){if(!a.indexOf)return a;for(var c,b=a.indexOf("_{");b>=0;)a=a.substr(0,b)+a.substr(b).replace(/_\{/,"<sub>"),c=a.substr(b).indexOf("}"),c>=0&&(a=a.substr(0,c)+a.substr(c).replace(/\}/,"</sub>")),b=a.indexOf("_{");for(b=a.indexOf("_");b>=0;)a=a.substr(0,b)+a.substr(b).replace(/_(.?)/,"<sub>$1</sub>"),b=a.indexOf("_");return a},JXG.GeonextParser.replaceSup=function(a){if(!a.indexOf)return a;for(var c,b=a.indexOf("^{");b>=0;)a=a.substr(0,b)+a.substr(b).replace(/\^\{/,"<sup>"),c=a.substr(b).indexOf("}"),c>=0&&(a=a.substr(0,c)+a.substr(c).replace(/\}/,"</sup>")),b=a.indexOf("^{");for(b=a.indexOf("^");b>=0;)a=a.substr(0,b)+a.substr(b).replace(/\^(.?)/,"<sup>$1</sup>"),b=a.indexOf("^");return a},JXG.GeonextParser.replaceNameById=function(a,b){var d,e,f,g,c=0,h=["X","Y","L","V"];for(g=0;g<h.length;g++)for(c=a.indexOf(h[g]+"(");c>=0;)c>=0&&(d=a.indexOf(")",c+2),d>=0&&(e=a.slice(c+2,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],a=a.slice(0,c+2)+f.id+a.slice(d))),d=a.indexOf(")",c+2),c=a.indexOf(h[g]+"(",d);for(c=a.indexOf("Dist(");c>=0;)c>=0&&(d=a.indexOf(",",c+5),d>=0&&(e=a.slice(c+5,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],a=a.slice(0,c+5)+f.id+a.slice(d))),d=a.indexOf(",",c+5),c=a.indexOf(",",d),d=a.indexOf(")",c+1),d>=0&&(e=a.slice(c+1,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],a=a.slice(0,c+1)+f.id+a.slice(d)),d=a.indexOf(")",c+1),c=a.indexOf("Dist(",d);for(h=["Deg","Rad"],g=0;g<h.length;g++)for(c=a.indexOf(h[g]+"(");c>=0;)c>=0&&(d=a.indexOf(",",c+4),d>=0&&(e=a.slice(c+4,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],a=a.slice(0,c+4)+f.id+a.slice(d))),d=a.indexOf(",",c+4),c=a.indexOf(",",d),d=a.indexOf(",",c+1),d>=0&&(e=a.slice(c+1,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],a=a.slice(0,c+1)+f.id+a.slice(d)),d=a.indexOf(",",c+1),c=a.indexOf(",",d),d=a.indexOf(")",c+1),d>=0&&(e=a.slice(c+1,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],a=a.slice(0,c+1)+f.id+a.slice(d)),d=a.indexOf(")",c+1),c=a.indexOf(h[g]+"(",d);return a},JXG.GeonextParser.replaceIdByObj=function(a){var b=/(X|Y|L)\(([\w_]+)\)/g;return a=a.replace(b,'this.board.objects["$2"].$1()'),b=/(V)\(([\w_]+)\)/g,a=a.replace(b,'this.board.objects["$2"].Value()'),b=/(Dist)\(([\w_]+),([\w_]+)\)/g,a=a.replace(b,'this.board.objects["$2"].Dist(this.board.objects["$3"])'),b=/(Deg)\(([\w_]+),([ \w\[\w_]+),([\w_]+)\)/g,a=a.replace(b,'JXG.Math.Geometry.trueAngle(this.board.objects["$2"],this.board.objects["$3"],this.board.objects["$4"])'),b=/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g,a=a.replace(b,'JXG.Math.Geometry.rad(this.board.objects["$1"],this.board.objects["$2"],this.board.objects["$3"])'),b=/N\((.+)\)/g,a=a.replace(b,"($1)")},JXG.GeonextParser.geonext2JS=function(a,b){var c,d,e,f=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc"],g=["Math.abs","Math.acos","Math.asin","Math.atan","Math.ceil","Math.cos","Math.exp","JXG.Math.factorial","Math.floor","Math.log","Math.max","Math.min","Math.random","this.board.round","Math.sin","Math.sqrt","Math.tan","Math.ceil"];for(a=a.replace(/&lt;/g,"<"),a=a.replace(/&gt;/g,">"),a=a.replace(/&amp;/g,"&"),d=a,d=this.replaceNameById(d,b),d=this.replaceIf(d),d=this.replacePow(d),d=this.replaceIdByObj(d),e=0;e<f.length;e++)c=new RegExp(["(\\W|^)(",f[e],")"].join(""),"ig"),d=d.replace(c,["$1",g[e]].join(""));return d=d.replace(/True/g,"true"),d=d.replace(/False/g,"false"),d=d.replace(/fasle/g,"false"),d=d.replace(/Pi/g,"Math.PI")},JXG.GeonextParser.findDependencies=function(a,b,c){"undefined"==typeof c&&(c=a.board);var e,f,g,d=c.elementsByName;for(e in d)e!=a.name&&(d[e].type==JXG.OBJECT_TYPE_TEXT?d[e].visProp.islabel||(g=e.replace(/\[/g,"\\["),g=g.replace(/\]/g,"\\]"),f=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+g+")(,[\\w\\[\\]'_ ]+)*\\)","g"),b.search(f)>=0&&d[e].addChild(a)):(g=e.replace(/\[/g,"\\["),g=g.replace(/\]/g,"\\]"),f=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+g+")(,[\\w\\[\\]'_ ]+)*\\)","g"),b.search(f)>=0&&d[e].addChild(a)))},JXG.GeonextParser.gxt2jc=function(a,b){var c;return a=a.replace(/&lt;/g,"<"),a=a.replace(/&gt;/g,">"),a=a.replace(/&amp;/g,"&"),c=a,c=this.replaceNameById2(c,b),c=c.replace(/True/g,"true"),c=c.replace(/False/g,"false"),c=c.replace(/fasle/g,"false")},JXG.GeonextParser.replaceNameById2=function(a,b){var d,e,f,g,c=0,h=["X","Y","L","V"];for(g=0;g<h.length;g++)for(c=a.indexOf(h[g]+"(");c>=0;)c>=0&&(d=a.indexOf(")",c+2),d>=0&&(e=a.slice(c+2,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],a=a.slice(0,c+2)+"$('"+f.id+"')"+a.slice(d))),d=a.indexOf(")",c+2),c=a.indexOf(h[g]+"(",d);for(c=a.indexOf("Dist(");c>=0;)c>=0&&(d=a.indexOf(",",c+5),d>=0&&(e=a.slice(c+5,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],a=a.slice(0,c+5)+"$('"+f.id+"')"+a.slice(d))),d=a.indexOf(",",c+5),c=a.indexOf(",",d),d=a.indexOf(")",c+1),d>=0&&(e=a.slice(c+1,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],a=a.slice(0,c+1)+"$('"+f.id+"')"+a.slice(d)),d=a.indexOf(")",c+1),c=a.indexOf("Dist(",d);for(h=["Deg","Rad"],g=0;g<h.length;g++)for(c=a.indexOf(h[g]+"(");c>=0;)c>=0&&(d=a.indexOf(",",c+4),d>=0&&(e=a.slice(c+4,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],a=a.slice(0,c+4)+"$('"+f.id+"')"+a.slice(d))),d=a.indexOf(",",c+4),c=a.indexOf(",",d),d=a.indexOf(",",c+1),d>=0&&(e=a.slice(c+1,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],a=a.slice(0,c+1)+"$('"+f.id+"')"+a.slice(d)),d=a.indexOf(",",c+1),c=a.indexOf(",",d),d=a.indexOf(")",c+1),d>=0&&(e=a.slice(c+1,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],a=a.slice(0,c+1)+"$('"+f.id+"')"+a.slice(d)),d=a.indexOf(")",c+1),c=a.indexOf(h[g]+"(",d);return a},JXG.Board=function(a,b,c,d,e,f,g,h,i,j,k){if(this.BOARD_MODE_NONE=0,this.BOARD_MODE_DRAG=1,this.BOARD_MODE_MOVE_ORIGIN=2,this.BOARD_QUALITY_LOW=1,this.BOARD_QUALITY_HIGH=2,this.BOARD_MODE_ZOOM=17,this.BOARD_MODE_CONSTRUCT=16,this.CONSTRUCTION_TYPE_POINT=1129599060,this.CONSTRUCTION_TYPE_CIRCLE=1129595724,this.CONSTRUCTION_TYPE_LINE=1129598030,this.CONSTRUCTION_TYPE_GLIDER=1129596740,this.CONSTRUCTION_TYPE_MIDPOINT=1129598288,this.CONSTRUCTION_TYPE_PERPENDICULAR=1129599044,this.CONSTRUCTION_TYPE_PARALLEL=1129599052,this.CONSTRUCTION_TYPE_INTERSECTION=1129597267,this.container=a,this.containerObj="undefined"!=typeof document?document.getElementById(this.container):null,"undefined"!=typeof document&&null==this.containerObj)throw new Error("\nJSXGraph: HTML container element '"+a+"' not found.");this.renderer=b,this.grids=[],this.options=JXG.deepCopy(JXG.Options),this.dimension=2,this.jc=new JXG.JessieCode,this.jc.use(this),this.origin={},this.origin.usrCoords=[1,0,0],this.origin.scrCoords=[1,d[0],d[1]],this.zoomX=e,this.zoomY=f,this.unitX=g*this.zoomX,this.unitY=h*this.zoomY,this.canvasWidth=i,this.canvasHeight=j,this.id=JXG.exists(c)&&""!==c&&"undefined"!=typeof document&&!JXG.exists(document.getElementById(c))?c:this.generateId(),this.eventHandlers={},this.hooks=[],this.dependentBoards=[],this.inUpdate=!1,this.objects={},this.objectsList=[],this.groups={},this.animationObjects={},this.highlightedObjects={},this.numObjects=0,this.elementsByName={},this.mode=this.BOARD_MODE_NONE,this.updateQuality=this.BOARD_QUALITY_HIGH,this.isSuspendedRedraw=!1,this.calculateSnapSizes(),this.drag_dx=0,this.drag_dy=0,this.mouse=null,this.touches=[],this.xmlString="",this.cPos=[],this.touchMoveLast=0,this.downObjects=[],this.showCopyright=!1,(null!=k&&k||null==k&&this.options.showCopyright)&&(this.showCopyright=!0,this.renderer.displayCopyright(JXG.JSXGraph.licenseText,this.options.text.fontSize)),this.needsFullUpdate=!1,this.reducedUpdate=!1,this.currentCBDef="none",this.geonextCompatibilityMode=!1,this.options.text.useASCIIMathML&&translateASCIIMath?init():this.options.text.useASCIIMathML=!1,this.hasMouseHandlers=!1,this.hasTouchHandlers=!1,this.hasMouseUp=!1,this.hasTouchEnd=!1,this.addEventHandlers(),this.methodMap={update:"update",on:"on",off:"off",setView:"setBoundingBox",setBoundingBox:"setBoundingBox",migratePoint:"migratePoint",colorblind:"emulateColorblindness"}},JXG.extend(JXG.Board.prototype,{generateName:function(a){if(a.type==JXG.OBJECT_TYPE_TICKS)return"";var b,h,c=2,d="",e="",f=[],g="";for(b=a.elementClass==JXG.OBJECT_CLASS_POINT?["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]:a.type==JXG.OBJECT_TYPE_ANGLE?["","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"]:["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],a.elementClass!==JXG.OBJECT_CLASS_POINT&&a.elementClass!=JXG.OBJECT_CLASS_LINE&&a.type!=JXG.OBJECT_TYPE_ANGLE&&(d=a.type===JXG.OBJECT_TYPE_POLYGON?"P_{":a.elementClass===JXG.OBJECT_CLASS_CIRCLE?"k_{":a.type===JXG.OBJECT_TYPE_TEXT?"t_{":"s_{",e="}"),h=0;c>h;h++)f[h]=0;for(;f[c-1]<b.length;){for(f[0]=1;f[0]<b.length;f[0]++){for(g=d,h=c;h>0;h--)g+=b[f[h-1]];if(null==this.elementsByName[g+e])return g+e}for(f[0]=b.length,h=1;c>h;h++)f[h-1]==b.length&&(f[h-1]=1,f[h]++)}return""},generateId:function(){for(var a=1;null!=JXG.JSXGraph.boards["jxgBoard"+a];)a=Math.round(65535*Math.random());return"jxgBoard"+a},setId:function(a,b){var c=this.numObjects++,d=a.id;return""!=d&&JXG.exists(d)||(d=this.id+b+c),a.id=d,this.objects[d]=a,a._pos=this.objectsList.length,this.objectsList[this.objectsList.length]=a,d},finalizeAdding:function(a){a.visProp.visible||this.renderer.hide(a)},finalizeLabel:function(a){!a.hasLabel||a.label.content.visProp.islabel||a.label.content.visProp.visible||this.renderer.hide(a.label.content)},getCoordsTopLeftCorner:function(){var a=this.containerObj,b=JXG.getOffset(a),c=document.documentElement.ownerDocument,d=function(b){var c=parseInt(JXG.getStyle(a,b));return isNaN(c)?0:c};return this.cPos.length>0&&(this.mode===JXG.BOARD_MODE_DRAG||this.mode===JXG.BOARD_MODE_MOVE_ORIGIN)?this.cPos:(!a.currentStyle&&c.defaultView&&(a=document.documentElement,b[0]+=d("margin-left"),b[1]+=d("margin-top"),b[0]+=d("border-left-width"),b[1]+=d("border-top-width"),b[0]+=d("padding-left"),b[1]+=d("padding-top"),a=this.containerObj),b[0]+=d("border-left-width"),b[1]+=d("border-top-width"),"vml"!==this.renderer.type&&(b[0]+=d("padding-left"),b[1]+=d("padding-top")),this.cPos=b,b)},getMousePosition:function(a,b){var d,c=this.getCoordsTopLeftCorner();return d=JXG.getPosition(a,b),[d[0]-c[0],d[1]-c[1]]},initMoveOrigin:function(a,b){this.drag_dx=a-this.origin.scrCoords[1],this.drag_dy=b-this.origin.scrCoords[2],this.mode=this.BOARD_MODE_MOVE_ORIGIN},initMoveObject:function(a,b,c,d){var e,f,h,g=[],i=this.objectsList.length,j={visProp:{layer:-1e4}};for(f=0;i>f;f++)if(e=this.objectsList[f],h=e.hasPoint&&e.hasPoint(a,b),e.visProp.visible&&h&&(e.triggerEventHandlers([d+"down","down"],c),this.downObjects.push(e)),(this.geonextCompatibilityMode&&(e.elementClass==JXG.OBJECT_CLASS_POINT||e.type==JXG.OBJECT_TYPE_TEXT)||!this.geonextCompatibilityMode)&&e.isDraggable&&e.visProp.visible&&!e.visProp.fixed&&!e.visProp.frozen&&h&&e.visProp.layer>=j.visProp.layer){if(JXG.exists(j.label)&&e==j.label.content)continue;j=e,g[0]=j}return g.length>0&&(this.mode=this.BOARD_MODE_DRAG),this.options.takeFirst&&(g.length=1),g},moveObject:function(a,b,c,d,e){var h,f=new JXG.Coords(JXG.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(a,b),this),g=c.obj;g.type!=JXG.OBJECT_TYPE_GLIDER?(isNaN(c.targets[0].Xprev+c.targets[0].Yprev)||g.setPositionDirectly(JXG.COORDS_BY_SCREEN,f.scrCoords.slice(1),[c.targets[0].Xprev,c.targets[0].Yprev]),c.targets[0].Xprev=f.scrCoords[1],c.targets[0].Yprev=f.scrCoords[2],this.update(g)):g.type==JXG.OBJECT_TYPE_GLIDER&&(h=g.coords,g.setPositionDirectly(JXG.COORDS_BY_USER,f.usrCoords.slice(1)),g.slideObject.elementClass==JXG.OBJECT_CLASS_CIRCLE?g.coords=JXG.Math.Geometry.projectPointToCircle(g,g.slideObject,this):g.slideObject.elementClass==JXG.OBJECT_CLASS_LINE&&(g.coords=JXG.Math.Geometry.projectPointToLine(g,g.slideObject,this)),0!=g.group.length?(g.group[g.group.length-1].dX=g.coords.scrCoords[1]-h.scrCoords[1],g.group[g.group.length-1].dY=g.coords.scrCoords[2]-h.scrCoords[2],g.group[g.group.length-1].update(this)):this.update(g)),g.triggerEventHandlers([e+"drag","drag"],d),this.updateInfobox(g),this.update(),g.highlight(!0)},twoFingerMove:function(a,b,c,d){var e,f,g;JXG.exists(c)&&JXG.exists(c.obj)&&(g=c.obj,e=new JXG.Coords(JXG.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(a[0],a[1]),this),f=new JXG.Coords(JXG.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(b[0],b[1]),this),g.elementClass===JXG.OBJECT_CLASS_LINE?this.moveLine(e,f,c,g):g.elementClass===JXG.OBJECT_CLASS_CIRCLE&&this.moveCircle(e,f,c,g),g.triggerEventHandlers(["touchdrag","drag"],d),c.targets[0].Xprev=e.scrCoords[1],c.targets[0].Yprev=e.scrCoords[2],c.targets[1].Xprev=f.scrCoords[1],c.targets[1].Yprev=f.scrCoords[2])},moveLine:function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(JXG.exists(c.targets[0])&&JXG.exists(c.targets[1])&&!isNaN(c.targets[0].Xprev+c.targets[0].Yprev+c.targets[1].Xprev+c.targets[1].Yprev)){if(e=a.usrCoords,f=b.usrCoords,g=new JXG.Coords(JXG.COORDS_BY_SCREEN,[c.targets[0].Xprev,c.targets[0].Yprev],this).usrCoords,h=new JXG.Coords(JXG.COORDS_BY_SCREEN,[c.targets[1].Xprev,c.targets[1].Yprev],this).usrCoords,j=[1,.5*(g[1]+h[1]),.5*(g[2]+h[2])],i=[1,.5*(e[1]+f[1]),.5*(e[2]+f[2])],l=JXG.Math.crossProduct(g,h),k=JXG.Math.crossProduct(e,f),n=JXG.Math.crossProduct(l,k),Math.abs(n[0])<JXG.Math.eps)return;n[1]/=n[0],n[2]/=n[0],o=JXG.Math.Geometry.rad(j.slice(1),n.slice(1),i.slice(1)),p=this.create("transform",[o,n[1],n[2]],{type:"rotate"}),p.update(),j=JXG.Math.matVecMult(p.matrix,j),j[1]/=j[0],j[2]/=j[0],q=this.create("transform",[i[1]-j[1],i[2]-j[2]],{type:"translate"}),q.update(),j=JXG.Math.matVecMult(q.matrix,j),m=JXG.Math.Geometry.distance(e,f)/JXG.Math.Geometry.distance(g,h),r=this.create("transform",[-i[1],-i[2]],{type:"translate"}),s=this.create("transform",[m,m],{type:"scale"}),t=this.create("transform",[i[1],i[2]],{type:"translate"}),p.melt(q).melt(r).melt(s).melt(t),p.applyOnce([d.point1,d.point2]),this.update(d.point1),d.highlight(!0)}},moveCircle:function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o;"pointCircle"!==d.method&&"pointLine"!==d.method&&JXG.exists(c.targets[0])&&JXG.exists(c.targets[1])&&!isNaN(c.targets[0].Xprev+c.targets[0].Yprev+c.targets[1].Xprev+c.targets[1].Yprev)&&(e=a.usrCoords,f=b.usrCoords,g=new JXG.Coords(JXG.COORDS_BY_SCREEN,[c.targets[0].Xprev,c.targets[0].Yprev],this).usrCoords,h=new JXG.Coords(JXG.COORDS_BY_SCREEN,[c.targets[1].Xprev,c.targets[1].Yprev],this).usrCoords,k=this.create("transform",[e[1]-g[1],e[2]-g[2]],{type:"translate"}),j=JXG.Math.Geometry.rad(h.slice(1),e.slice(1),f.slice(1)),i=JXG.Math.Geometry.distance(e,f)/JXG.Math.Geometry.distance(g,h),l=this.create("transform",[-e[1],-e[2]],{type:"translate"}),m=this.create("transform",[j],{type:"rotate"}),n=this.create("transform",[i,i],{type:"scale"}),o=this.create("transform",[e[1],e[2]],{type:"translate"}),k.melt(l).melt(m).melt(n).melt(o),k.applyOnce([d.center]),"twoPoints"===d.method?k.applyOnce([d.point2]):"pointRadius"===d.method&&JXG.isNumber(d.updateRadius.origin)&&d.setRadius(d.radius*i),this.update(d.center),d.highlight(!0))},highlightElements:function(a,b,c,d){var e,f,g,h=this.objectsList.length;for(e=0;h>e;e++)f=this.objectsList[e],g=f.id,f.visProp.highlight&&JXG.exists(f.hasPoint)&&f.visProp.visible&&f.hasPoint(a,b)&&(this.updateInfobox(f),JXG.exists(this.highlightedObjects[g])||(this.highlightedObjects[g]=f,f.highlight(),this.triggerEventHandlers(["mousehit","hit"],c,f,d)),f.mouseover?f.triggerEventHandlers(["mousemove","move"],c):(f.triggerEventHandlers(["mouseover","over"],c),f.mouseover=!0));for(e=0;h>e;e++)f=this.objectsList[e],g=f.id,f.mouseover&&(this.highlightedObjects[g]||(f.triggerEventHandlers(["mouseout","out"],c),f.mouseover=!1))},initXYstart:function(a){var b=[];return a.elementClass==JXG.OBJECT_CLASS_LINE?(b.push(a.point1.coords.usrCoords),b.push(a.point2.coords.usrCoords)):a.elementClass==JXG.OBJECT_CLASS_CIRCLE?b.push(a.center.coords.usrCoords):a.type==JXG.OBJECT_TYPE_GLIDER?b.push([a.position,a.position,a.position]):b.push(a.coords.usrCoords),b},mouseOriginMoveStart:function(a){var b=this.options.pan&&a.shiftKey;if(b){var c=this.getMousePosition(a);this.initMoveOrigin(c[0],c[1])}return b},mouseOriginMove:function(a){var b=this.mode==this.BOARD_MODE_MOVE_ORIGIN;if(b){var c=this.getMousePosition(a);this.moveOrigin(c[0],c[1])}return b},touchOriginMoveStart:function(a){var b=a[JXG.touchProperty],c=this.options.pan&&2==b.length&&JXG.Math.Geometry.distance([b[0].screenX,b[0].screenY],[b[1].screenX,b[1].screenY])<80;if(c){var d=this.getMousePosition(a,0);this.initMoveOrigin(d[0],d[1])}return c},touchOriginMove:function(a){var b=this.mode==this.BOARD_MODE_MOVE_ORIGIN;if(b){var c=this.getMousePosition(a,0);this.moveOrigin(c[0],c[1])}return b},originMoveEnd:function(){this.mode=this.BOARD_MODE_NONE},addEventHandlers:function(){this.addMouseEventHandlers(),this.addTouchEventHandlers()},addMouseEventHandlers:function(){this.hasMouseHandlers||"undefined"==typeof document||(JXG.addEvent(this.containerObj,"mousedown",this.mouseDownListener,this),JXG.addEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),JXG.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),JXG.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!0,this.containerObj.oncontextmenu=function(a){return JXG.exists(a)&&a.preventDefault(),!1})},addTouchEventHandlers:function(){this.hasTouchHandlers||"undefined"==typeof document||(JXG.addEvent(this.containerObj,"touchstart",this.touchStartListener,this),JXG.addEvent(this.containerObj,"touchmove",this.touchMoveListener,this),JXG.addEvent(this.containerObj,"gesturestart",this.gestureStartListener,this),JXG.addEvent(this.containerObj,"gesturechange",this.gestureChangeListener,this),this.hasTouchHandlers=!0)},removeMouseEventHandlers:function(){this.hasMouseHandlers&&"undefined"!=typeof document&&(JXG.removeEvent(this.containerObj,"mousedown",this.mouseDownListener,this),JXG.removeEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),this.hasMouseUp&&(JXG.removeEvent(document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),JXG.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),JXG.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!1)},removeTouchEventHandlers:function(){this.hasTouchHandlers&&"undefined"!=typeof document&&(JXG.removeEvent(this.containerObj,"touchstart",this.touchStartListener,this),JXG.removeEvent(this.containerObj,"touchmove",this.touchMoveListener,this),this.hasTouchEnd&&(JXG.removeEvent(document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),JXG.removeEvent(this.containerObj,"gesturestart",this.gestureStartListener,this),JXG.removeEvent(this.containerObj,"gesturechange",this.gestureChangeListener,this),this.hasTouchHandlers=!1)},removeEventHandlers:function(){this.removeMouseEventHandlers(),this.removeTouchEventHandlers()},clickLeftArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]+.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickRightArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]-.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickUpArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]-.1*this.canvasHeight),this},clickDownArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]+.1*this.canvasHeight),this},gestureChangeListener:function(a){var b,c=this.options.zoom.factorX,d=this.options.zoom.factorY;return this.options.zoom.wheel?(a.preventDefault(),this.mode===this.BOARD_MODE_NONE&&(b=new JXG.Coords(JXG.COORDS_BY_SCREEN,this.getMousePosition(a),this),this.options.zoom.factorX=a.scale/this.prevScale,this.options.zoom.factorY=a.scale/this.prevScale,this.zoomIn(b.usrCoords[1],b.usrCoords[2]),this.prevScale=a.scale,this.options.zoom.factorX=c,this.options.zoom.factorY=d),!1):!0},gestureStartListener:function(a){return this.options.zoom.wheel?(a.preventDefault(),this.prevScale=1,!1):!0},touchStartListener:function(a){var b,c,d,e,f,g,i,k,l,h=this.options.precision.touch,j=[],m=a[JXG.touchProperty];if(this.hasTouchEnd||(JXG.addEvent(document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!0),this.hasMouseHandlers&&this.removeMouseEventHandlers(),document.selection&&"function"==typeof document.selection.empty?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(a))return this.triggerEventHandlers(["touchstart","down"],a),!1;for(this.options.precision.hasPoint=this.options.precision.touch,b=0;b<m.length;b++)m[b].jxg_isused=!1;for(b=0;b<this.touches.length;b++)for(e=0;e<this.touches[b].targets.length;e++){this.touches[b].targets[e].num=-1,h=this.options.precision.touch;do{for(f=0;f<m.length;f++)if(Math.abs(Math.pow(m[f].screenX-this.touches[b].targets[e].X,2)+Math.pow(m[f].screenY-this.touches[b].targets[e].Y,2))<h*h){this.touches[b].targets[e].num=f,this.touches[b].targets[e].X=m[f].screenX,this.touches[b].targets[e].Y=m[f].screenY,m[f].jxg_isused=!0;break}h*=2}while(-1==this.touches[b].targets[e].num&&h<this.options.precision.touchMax);-1===this.touches[b].targets[e].num&&(JXG.debug("i couldn't find a targettouches for target no "+e+" on "+this.touches[b].obj.name+" ("+this.touches[b].obj.id+"). Removed the target."),JXG.debug("eps = "+h+", touchMax = "+JXG.Options.precision.touchMax),this.touches[b].targets.splice(b,1))}for(b=0;b<m.length;b++)if(!m[b].jxg_isused){if(c=this.getMousePosition(a,b),d=this.initMoveObject(c[0],c[1],a,"touch"),0!=d.length)if(i=d[d.length-1],JXG.isPoint(i)||i.type===JXG.OBJECT_TYPE_TEXT){for(l=[{num:b,X:m[b].screenX,Y:m[b].screenY,Xprev:0/0,Yprev:0/0,Xstart:[],Ystart:[],Zstart:[]}],j=this.initXYstart(i),g=0;g<j.length;g++)l[0].Xstart.push(j[g][1]),l[0].Ystart.push(j[g][2]),l[0].Zstart.push(j[g][0]);this.touches.push({obj:i,targets:l}),this.highlightedObjects[i.id]=i,i.highlight(!0)}else if(i.elementClass===JXG.OBJECT_CLASS_LINE||i.elementClass===JXG.OBJECT_CLASS_CIRCLE){for(k=!1,e=0;e<this.touches.length;e++)if(i.id===this.touches[e].obj.id){if(k=!0,1===this.touches[e].targets.length){var n={num:b,X:m[b].screenX,Y:m[b].screenY,Xprev:0/0,Yprev:0/0,Xstart:[],Ystart:[],Zstart:[]};for(j=this.initXYstart(i),g=0;g<j.length;g++)n.Xstart.push(j[g][1]),n.Ystart.push(j[g][2]),n.Zstart.push(j[g][0]);this.touches[e].targets.push(n)}m[b].jxg_isused=!0}if(!k){for(l=[{num:b,X:m[b].screenX,Y:m[b].screenY,Xprev:0/0,Yprev:0/0,Xstart:[],Ystart:[],Zstart:[]}],j=this.initXYstart(i),g=0;g<j.length;g++)l[0].Xstart.push(j[g][1]),l[0].Ystart.push(j[g][2]),l[0].Zstart.push(j[g][0]);this.touches.push({obj:i,targets:l}),this.highlightedObjects[i.id]=i,i.highlight(!0)}}m[b].jxg_isused=!0}if(this.touches.length>0&&(a.preventDefault(),a.stopPropagation()),JXG.isWebkitAndroid()){var o=new Date;this.touchMoveLast=o.getTime()-200}return this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchstart","down"],a),this.touches.length>0},touchMoveListener:function(a){var b,d,e=a[JXG.touchProperty];if(this.mode!==this.BOARD_MODE_NONE&&(a.preventDefault(),a.stopPropagation()),JXG.isWebkitAndroid()){var f=new Date;if(f=f.getTime(),f-this.touchMoveLast<80)return this.updateQuality=this.BOARD_QUALITY_HIGH,this.triggerEventHandlers(["touchmove","move"],a,this.mode),!1;this.touchMoveLast=f}if(this.mode!=this.BOARD_MODE_DRAG&&this.renderer.hide(this.infobox),this.options.precision.hasPoint=this.options.precision.touch,!this.touchOriginMove(a)&&this.mode==this.BOARD_MODE_DRAG)for(b=0;b<this.touches.length;b++)1===this.touches[b].targets.length?e[this.touches[b].targets[0].num]&&(this.touches[b].targets[0].X=e[this.touches[b].targets[0].num].screenX,this.touches[b].targets[0].Y=e[this.touches[b].targets[0].num].screenY,d=this.getMousePosition(a,this.touches[b].targets[0].num),this.moveObject(d[0],d[1],this.touches[b],a,"touch")):2===this.touches[b].targets.length&&this.touches[b].targets[0].num>-1&&this.touches[b].targets[1].num>-1&&e[this.touches[b].targets[0].num]&&e[this.touches[b].targets[1].num]&&(this.touches[b].targets[0].X=e[this.touches[b].targets[0].num].screenX,this.touches[b].targets[0].Y=e[this.touches[b].targets[0].num].screenY,this.touches[b].targets[1].X=e[this.touches[b].targets[1].num].screenX,this.touches[b].targets[1].Y=e[this.touches[b].targets[1].num].screenY,this.twoFingerMove(this.getMousePosition(a,this.touches[b].targets[0].num),this.getMousePosition(a,this.touches[b].targets[1].num),this.touches[b],a));return this.mode!=this.BOARD_MODE_DRAG&&this.renderer.hide(this.infobox),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchmove","move"],a,this.mode),this.mode===this.BOARD_MODE_NONE},touchEndListener:function(a){var b,c,d,g,h,e=this.options.precision.touch,f=[],i=a[JXG.touchProperty];if(this.triggerEventHandlers(["touchend","up"],a),this.renderer.hide(this.infobox),i.length>0){for(b=0;b<this.touches.length;b++)f[b]=this.touches[b];for(this.touches.length=0,b=0;b<i.length;b++)i[b].jxg_isused=!1;for(b=0;b<f.length;b++){for(g=!1,h=0,c=0;c<f[b].targets.length;c++)for(f[b].targets[c].found=!1,d=0;d<i.length;d++)if(Math.abs(Math.pow(i[d].screenX-f[b].targets[c].X,2)+Math.pow(i[d].screenY-f[b].targets[c].Y,2))<e*e){f[b].targets[c].found=!0,f[b].targets[c].num=d,f[b].targets[c].X=i[d].screenX,f[b].targets[c].Y=i[d].screenY,h++;break}if(JXG.isPoint(f[b].obj)?g=f[b].targets[0]&&f[b].targets[0].found:f[b].obj.elementClass===JXG.OBJECT_CLASS_LINE?g=f[b].targets[0]&&f[b].targets[0].found||f[b].targets[1]&&f[b].targets[1].found:f[b].obj.elementClass===JXG.OBJECT_CLASS_CIRCLE&&(g=1===h||3===h),g)for(this.touches.push({obj:f[b].obj,targets:[]}),c=0;c<f[b].targets.length;c++)f[b].targets[c].found&&this.touches[this.touches.length-1].targets.push({num:f[b].targets[c].num,X:f[b].targets[c].screenX,Y:f[b].targets[c].screenY,Xprev:0/0,Yprev:0/0,Xstart:f[b].targets[c].Xstart,Ystart:f[b].targets[c].Ystart,Zstart:f[b].targets[c].Zstart});else delete this.highlightedObjects[f[b].obj.id],f[b].obj.noHighlight()}}else this.touches.length=0;for(b=0;b<this.downObjects.length;b++){for(g=!1,c=0;c<this.touches.length;c++)this.touches[c].obj.id==this.downObjects[b].id&&(g=!0);
g||(this.downObjects[b].triggerEventHandlers(["touchup","up"],a),this.downObjects[b].snapToGrid(),this.downObjects.splice(b,1))}return i&&0!==i.length||(JXG.removeEvent(document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1,this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.originMoveEnd(),this.update()),!0},mouseDownListener:function(a){var b,c,d,e,f;if(document.selection&&"function"==typeof document.selection.empty?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this.hasMouseUp||(JXG.addEvent(document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!0),this.mouseOriginMoveStart(a))e=!1;else if(b=this.getMousePosition(a),c=this.initMoveObject(b[0],b[1],a,"mouse"),0==c.length)this.mode=this.BOARD_MODE_NONE,e=!0;else{for(this.mouse={obj:null,targets:[{X:b[0],Y:b[1],Xprev:0/0,Yprev:0/0}]},this.mouse.obj=c[c.length-1],this.dehighlightAll(),this.highlightedObjects[this.mouse.obj.id]=this.mouse.obj,this.mouse.obj.highlight(!0),this.mouse.targets[0].Xstart=[],this.mouse.targets[0].Ystart=[],this.mouse.targets[0].Zstart=[],d=this.initXYstart(this.mouse.obj),f=0;f<d.length;f++)this.mouse.targets[0].Xstart.push(d[f][1]),this.mouse.targets[0].Ystart.push(d[f][2]),this.mouse.targets[0].Zstart.push(d[f][0]);a&&a.preventDefault?a.preventDefault():window.event&&(window.event.returnValue=!1)}return this.triggerEventHandlers(["mousedown","down"],a),e},mouseUpListener:function(a){var b;for(this.triggerEventHandlers(["mouseup","up"],a),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mouse&&this.mouse.obj&&this.mouse.obj.snapToGrid(),this.originMoveEnd(),this.dehighlightAll(),this.update(),b=0;b<this.downObjects.length;b++)this.downObjects[b].triggerEventHandlers(["mouseup","up"],a);this.downObjects.length=0,this.hasMouseUp&&(JXG.removeEvent(document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),this.mouse=null},mouseMoveListener:function(a){var b;b=this.getMousePosition(a),this.updateQuality=this.BOARD_QUALITY_LOW,this.mode!=this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.renderer.hide(this.infobox)),this.mouseOriginMove(a)||(this.mode==this.BOARD_MODE_DRAG?this.moveObject(b[0],b[1],this.mouse,a,"mouse"):this.highlightElements(b[0],b[1],a,-1)),this.updateQuality=this.BOARD_QUALITY_HIGH,this.triggerEventHandlers(["mousemove","move"],a,this.mode)},mouseWheelListener:function(a){if(!this.options.zoom.wheel)return!0;a=a||window.event;var b=a.detail?-1*a.detail:a.wheelDelta/40,c=new JXG.Coords(JXG.COORDS_BY_SCREEN,this.getMousePosition(a),this);return b>0?this.zoomIn(c.usrCoords[1],c.usrCoords[2]):this.zoomOut(c.usrCoords[1],c.usrCoords[2]),a.preventDefault(),!1},updateInfobox:function(a){var b,c,d,e;return a.visProp.showinfobox?(a.elementClass==JXG.OBJECT_CLASS_POINT&&(d=a.coords.usrCoords[1],e=a.coords.usrCoords[2],this.infobox.setCoords(d+this.infobox.distanceX/this.unitX,e+this.infobox.distanceY/this.unitY),"string"!=typeof a.infoboxText?("auto"===a.visProp.infoboxdigits?(b=JXG.autoDigits(d),c=JXG.autoDigits(e)):JXG.isNumber(a.visProp.infoboxdigits)?(b=d.toFixed(a.visProp.infoboxdigits),c=e.toFixed(a.visProp.infoboxdigits)):(b=d,c=e),this.highlightInfobox(b,c,a)):this.highlightCustomInfobox(a.infoboxText,a),this.renderer.show(this.infobox)),this):this},highlightCustomInfobox:function(a){return this.infobox.setText(a),this},highlightInfobox:function(a,b){return this.highlightCustomInfobox("("+a+", "+b+")"),this},dehighlightAll:function(){var a,b,c=!1;for(a in this.highlightedObjects)b=this.highlightedObjects[a],this.hasMouseHandlers&&b.noHighlight(),c=!0;return this.highlightedObjects={},"canvas"==this.options.renderer&&c&&(this.prepareUpdate(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw()),this},getScrCoordsOfMouse:function(a,b){return[a,b]},getUsrCoordsOfMouse:function(a){var b=this.getCoordsTopLeftCorner(),c=JXG.getPosition(a),d=c[0]-b[0],e=c[1]-b[1],f=new JXG.Coords(JXG.COORDS_BY_SCREEN,[d,e],this);return f.usrCoords.slice(1)},getAllUnderMouse:function(a){var b=this.getAllObjectsUnderMouse(a);return b.push(this.getUsrCoordsOfMouse(a)),b},getAllObjectsUnderMouse:function(a){var g,h,b=this.getCoordsTopLeftCorner(),c=JXG.getPosition(a),d=c[0]-b[0],e=c[1]-b[1],f=[],i=this.objectsList.length;for(g=0;i>g;g++)h=this.objectsList[g],h.visProp.visible&&h.hasPoint&&h.hasPoint(d,e)&&(f[f.length]=h);return f},moveOrigin:function(a,b){var c,d,e=this.objectsList.length;for(JXG.exists(a)&&JXG.exists(b)&&(this.origin.scrCoords[1]=a,this.origin.scrCoords[2]=b,this.mode===this.BOARD_MODE_MOVE_ORIGIN&&(this.origin.scrCoords[1]-=this.drag_dx,this.origin.scrCoords[2]-=this.drag_dy)),d=0;e>d;d++)c=this.objectsList[d],c.visProp.frozen||c.elementClass!=JXG.OBJECT_CLASS_POINT&&c.elementClass!=JXG.OBJECT_CLASS_CURVE&&c.type!=JXG.OBJECT_TYPE_AXIS&&c.type!=JXG.OBJECT_TYPE_TEXT||c.elementClass!=JXG.OBJECT_CLASS_CURVE&&c.type!=JXG.OBJECT_TYPE_AXIS&&c.coords.usr2screen();return this.clearTraces(),this.fullUpdate(),this},addConditions:function(a){var e,f,g,h,i,j,b="var el, x, y, c, rgbo;\n",c=a.indexOf("<data>"),d=a.indexOf("</data>");if(!(0>c)){for(;c>=0;){e=a.slice(c+6,d),f=e.indexOf("="),g=e.slice(0,f),h=e.slice(f+1),f=g.indexOf("."),i=g.slice(0,f),j=this.elementsByName[JXG.unescapeHTML(i)];var k=g.slice(f+1).replace(/\s+/g,"").toLowerCase();switch(h=JXG.GeonextParser.geonext2JS(h,this),h=h.replace(/this\.board\./g,"this."),JXG.exists(this.elementsByName[i])||JXG.debug("debug conditions: |"+i+"| undefined"),b+='el = this.objects["'+j.id+'"];\n',k){case"x":b+="var y=el.coords.usrCoords[2];\n",b+="el.setPositionDirectly(JXG.COORDS_BY_USER,["+h+",y]);\n",b+="el.prepareUpdate().update();\n";break;case"y":b+="var x=el.coords.usrCoords[1];\n",b+="el.coords=new JXG.Coords(JXG.COORDS_BY_USER,[x,"+h+"],this);\n",b+="el.setPositionDirectly(JXG.COORDS_BY_USER,[x,"+h+"]);\n",b+="el.prepareUpdate().update();\n";break;case"visible":b+="var c="+h+";\n",b+="el.visProp.visible = c;\n",b+="if (c) {el.showElement();} else {el.hideElement();}\n";break;case"position":b+="el.position = "+h+";\n",b+="el.prepareUpdate().update(true);\n";break;case"stroke":b+="rgbo = JXG.rgba2rgbo("+h+");\n",b+="el.visProp.strokecolor = rgbo[0];\n",b+="el.visProp.strokeopacity = rgbo[1];\n";break;case"style":b+="el.setStyle("+h+");\n";break;case"strokewidth":b+="el.strokeWidth = "+h+";\n";break;case"fill":b+="var rgbo = JXG.rgba2rgbo("+h+");\n",b+="el.visProp.fillcolor = rgbo[0];\n",b+="el.visProp.fillopacity = rgbo[1];\n";break;case"label":break;default:JXG.debug("property '"+k+"' in conditions not yet implemented:"+h)}a=a.slice(d+7),c=a.indexOf("<data>"),d=a.indexOf("</data>")}b+="this.prepareUpdate().updateElements();\n",b+="return true;\n",b=b.replace(/&lt;/g,"<"),b=b.replace(/&gt;/g,">"),b=b.replace(/&amp;/g,"&"),this.updateConditions=new Function(b),this.updateConditions()}},updateConditions:function(){return!1},calculateSnapSizes:function(){var a=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this),b=new JXG.Coords(JXG.COORDS_BY_USER,[this.options.grid.gridX,this.options.grid.gridY],this),c=a.scrCoords[1]-b.scrCoords[1],d=a.scrCoords[2]-b.scrCoords[2];for(this.options.grid.snapSizeX=this.options.grid.gridX;Math.abs(c)>25;)this.options.grid.snapSizeX*=2,c/=2;for(this.options.grid.snapSizeY=this.options.grid.gridY;Math.abs(d)>25;)this.options.grid.snapSizeY*=2,d/=2;return this},applyZoom:function(){var a,b,c=this.objectsList.length;for(b=0;c>b;b++)a=this.objectsList[b],a.visProp.frozen||a.elementClass!=JXG.OBJECT_CLASS_POINT&&a.elementClass!=JXG.OBJECT_CLASS_CURVE&&a.type!=JXG.OBJECT_TYPE_AXIS&&a.type!=JXG.OBJECT_TYPE_TEXT||a.elementClass!=JXG.OBJECT_CLASS_CURVE&&a.type!=JXG.OBJECT_TYPE_AXIS&&a.coords.usr2screen();return this.calculateSnapSizes(),this.clearTraces(),this.fullUpdate(),this},zoomIn:function(a,b){var c=this.getBoundingBox(),d=this.options.zoom.factorX,e=this.options.zoom.factorY,f=(c[2]-c[0])*(1-1/d),g=(c[1]-c[3])*(1-1/e),h=.5,i=.5;return"number"==typeof a&&"number"==typeof b&&(h=(a-c[0])/(c[2]-c[0]),i=(c[1]-b)/(c[1]-c[3])),this.setBoundingBox([c[0]+f*h,c[1]-g*i,c[2]-f*(1-h),c[3]+g*(1-i)],!1),this.zoomX*=d,this.zoomY*=e,this.applyZoom(),this},zoomOut:function(a,b){var c=this.getBoundingBox(),d=this.options.zoom.factorX,e=this.options.zoom.factorY,f=(c[2]-c[0])*(1-d),g=(c[1]-c[3])*(1-e),h=.5,i=.5;return"number"==typeof a&&"number"==typeof b&&(h=(a-c[0])/(c[2]-c[0]),i=(c[1]-b)/(c[1]-c[3])),this.setBoundingBox([c[0]+f*h,c[1]-g*i,c[2]-f*(1-h),c[3]+g*(1-i)],!1),this.zoomX/=d,this.zoomY/=e,this.applyZoom(),this},zoom100:function(){var a=this.getBoundingBox(),b=.5*(a[2]-a[0])*(1-this.zoomX),c=.5*(a[1]-a[3])*(1-this.zoomY);return this.setBoundingBox([a[0]+b,a[1]-c,a[2]-b,a[3]+c],!1),this.zoomX=1,this.zoomY=1,this.applyZoom(),this},zoomAllPoints:function(){var e,f,g,h,j,a=0,b=0,c=0,d=0,i=this.objectsList.length;for(e=0;i>e;e++)j=this.objectsList[e],JXG.isPoint(j)&&j.visProp.visible&&(j.coords.usrCoords[1]<a?a=j.coords.usrCoords[1]:j.coords.usrCoords[1]>b&&(b=j.coords.usrCoords[1]),j.coords.usrCoords[2]>d?d=j.coords.usrCoords[2]:j.coords.usrCoords[2]<c&&(c=j.coords.usrCoords[2]));return f=50,g=f/this.unitX,h=f/this.unitY,this.zoomX=1,this.zoomY=1,this.setBoundingBox([a-g,d+h,b+g,c-h],!0),this.applyZoom(),this},zoomElements:function(a){var b,c,d,e,f=[0,0,0,0],g=[1,-1,-1,1];if(!JXG.isArray(a)||0===a.length)return this;for(b=0;b<a.length;b++)if(d=JXG.getRef(this,a[b]),e=d.bounds(),JXG.isArray(e))if(JXG.isArray(f))for(c=0;4>c;c++)g[c]*e[c]<g[c]*f[c]&&(f[c]=e[c]);else f=e;if(JXG.isArray(f)){for(c=0;4>c;c++)f[c]-=g[c];this.zoomX=1,this.zoomY=1,this.setBoundingBox(f,!0)}return this},setZoom:function(a,b){var c=this.options.zoom.factorX,d=this.options.zoom.factorY;return this.options.zoom.factorX=a/this.zoomX,this.options.zoom.factorY=b/this.zoomY,this.zoomIn(),this.options.zoom.factorX=c,this.options.zoom.factorY=d,this},removeObject:function(a){var b,c;if(JXG.isArray(a))for(c=0;c<a.length;c++)this.removeObject(a[c]);if(a=JXG.getReference(this,a),!JXG.exists(a))return this;try{for(b in a.childElements)a.childElements[b].board.removeObject(a.childElements[b]);for(b in this.objects)JXG.exists(this.objects[b].childElements)&&(delete this.objects[b].childElements[a.id],delete this.objects[b].descendants[a.id]);if(a._pos>-1)for(this.objectsList.splice(a._pos,1),b=a._pos;b<this.objectsList.length;b++)this.objectsList[b]._pos--;else JXG.debug("object "+a.id+" not found in list.");delete this.objects[a.id],delete this.elementsByName[a.name],a.visProp&&a.visProp.trace&&a.clearTrace(),JXG.exists(a.remove)&&a.remove()}catch(d){JXG.debug(a.id+": Could not be removed: "+d)}return this.update(),this},removeAncestors:function(a){for(var b in a.ancestors)this.removeAncestors(a.ancestors[b]);return this.removeObject(a),this},initGeonextBoard:function(){var a,b,c,d,e;return a=this.create("point",[0,0],{id:this.id+"g00e0",name:"Ursprung",withLabel:!1,visible:!1,fixed:!0}),b=this.create("point",[1,0],{id:this.id+"gX0e0",name:"Punkt_1_0",withLabel:!1,visible:!1,fixed:!0}),c=this.create("point",[0,1],{id:this.id+"gY0e0",name:"Punkt_0_1",withLabel:!1,visible:!1,fixed:!0}),d=this.create("line",[a,b],{id:this.id+"gXLe0",name:"X-Achse",withLabel:!1,visible:!1}),e=this.create("line",[a,c],{id:this.id+"gYLe0",name:"Y-Achse",withLabel:!1,visible:!1}),this},initInfobox:function(){var a=JXG.copyAttributes({},this.options,"infobox");return a.id=this.id+"_infobox",this.infobox=this.create("text",[0,0,"0,0"],a),this.infobox.distanceX=-20,this.infobox.distanceY=25,this.infobox.needsUpdateSize=!1,this.infobox.dump=!1,this.renderer.hide(this.infobox),this},resizeContainer:function(a,b){return this.canvasWidth=parseFloat(a),this.canvasHeight=parseFloat(b),this.containerObj.style.width=this.canvasWidth+"px",this.containerObj.style.height=this.canvasHeight+"px",this.renderer.resize(this.canvasWidth,this.canvasHeight),this},showDependencies:function(){var a,b,c,d,e;b="<p>\n";for(a in this.objects){e=0;for(c in this.objects[a].childElements)e++;e>=0&&(b+="<b>"+this.objects[a].id+":</b> ");for(c in this.objects[a].childElements)b+=this.objects[a].childElements[c].id+"("+this.objects[a].childElements[c].name+"), ";b+="<p>\n"}return b+="</p>\n",d=window.open(),d.document.open(),d.document.write(b),d.document.close(),this},showXML:function(){var a=window.open("");return a.document.open(),a.document.write("<pre>"+JXG.escapeHTML(this.xmlString)+"</pre>"),a.document.close(),this},prepareUpdate:function(){var a,b,c=this.objectsList.length;for(a=0;c>a;a++)b=this.objectsList[a],b.needsUpdate=b.needsRegularUpdate||this.needsFullUpdate;return this},updateElements:function(a){var b,c;for(a=JXG.getRef(this,a),b=0;b<this.objectsList.length;b++)c=this.objectsList[b],c.update(!JXG.exists(a)||c.id!==a.id);return this},updateRenderer:function(a){var b,c,d=this.objectsList.length;if("canvas"==this.options.renderer)this.updateRendererCanvas(a);else for(b=0;d>b;b++)c=this.objectsList[b],c.updateRenderer();return this},updateRendererCanvas:function(){var b,c,d,i,j,e=this.objectsList.length,f=this.options.layer,g=this.options.layer.numlayers,h=Number.NEGATIVE_INFINITY;for(d=0;g>d;d++){i=Number.POSITIVE_INFINITY;for(j in f)f[j]>h&&f[j]<i&&(i=f[j]);for(h=i,b=0;e>b;b++)c=this.objectsList[b],c.visProp.layer===i&&c.prepareUpdate().updateRenderer()}return this},addHook:function(a,b,c){return b=JXG.def(b,"update"),c=JXG.def(c,this),this.hooks.push([b,a]),this.on(b,a,c),this.hooks.length-1},on:function(a,b,c){return c=JXG.def(c,this),JXG.isArray(this.eventHandlers[a])||(this.eventHandlers[a]=[]),this.eventHandlers[a].push({handler:b,context:c}),this},addEvent:JXG.shortcut(JXG.Board.prototype,"on"),removeHook:function(a){return this.hooks[a]&&(this.off(this.hooks[a][0],this.hooks[a][1]),this.hooks[a]=null),this},off:function(a,b){var c;if(a&&JXG.isArray(this.eventHandlers[a]))return b?(c=JXG.indexOf(this.eventHandlers[a],b,"handler"),c>-1&&this.eventHandlers[a].splice(c,1)):this.eventHandlers[a].length=0,this},removeEvent:JXG.shortcut(JXG.Board.prototype,"off"),updateHooks:function(){return arguments[0]=JXG.def(arguments[0],"update"),this.triggerEventHandlers.apply(this,arguments),this},triggerEventHandlers:function(a){var b,c,d,e,f=Array.prototype.slice.call(arguments,1);for(JXG.isArray(a)||(a=[a]),c=0;c<a.length;c++)if(e=a[c],JXG.isArray(this.eventHandlers[e]))for(b=0;b<this.eventHandlers[e].length;b++)d=this.eventHandlers[e][b],d.handler.apply(d.context,f);return this},addChild:function(a){return this.dependentBoards.push(a),this.update(),this},removeChild:function(a){var b;for(b=this.dependentBoards.length-1;b>=0;b--)this.dependentBoards[b]==a&&this.dependentBoards.splice(b,1);return this},update:function(a){var b,c,d,e;if(this.inUpdate||this.isSuspendedUpdate)return this;for(this.inUpdate=!0,this.prepareUpdate(a).updateElements(a).updateConditions(),this.renderer.suspendRedraw(this),this.updateRenderer(a),this.renderer.unsuspendRedraw(),this.triggerEventHandlers("update"),c=this.dependentBoards.length,b=0;c>b;b++)d=this.dependentBoards[b].id,e=JXG.JSXGraph.boards[d],e!=this&&(e.updateQuality=this.updateQuality,e.prepareUpdate().updateElements().updateConditions(),e.renderer.suspendRedraw(),e.updateRenderer(),e.renderer.unsuspendRedraw(),e.triggerEventHandlers("update"));return this.inUpdate=!1,this},fullUpdate:function(){return this.needsFullUpdate=!0,this.update(),this.needsFullUpdate=!1,this},addGrid:function(){return this.create("grid",[]),this},removeGrids:function(){var a;for(a=0;a<this.grids.length;a++)this.removeObject(this.grids[a]);return this.grids.length=0,this.update(),this},create:function(a,b,c){var d,e;for(a=a.toLowerCase(),JXG.exists(b)||(b=[]),JXG.exists(c)||(c={}),e=0;e<b.length;e++)("text"!=a||2!=e)&&(b[e]=JXG.getReference(this,b[e]));if(null==JXG.JSXGraph.elements[a])throw new Error("JSXGraph: JXG.createElement: Unknown element type given: "+a);return d="function"==typeof JXG.JSXGraph.elements[a]?JXG.JSXGraph.elements[a](this,b,c):JXG.JSXGraph.elements[a].creator(this,b,c),JXG.exists(d)?(d.prepareUpdate&&d.update&&d.updateRenderer&&d.prepareUpdate().update().updateRenderer(),d):(JXG.debug("JSXGraph: JXG.createElement: failure creating "+a),d)},createElement:JXG.shortcut(JXG.Board.prototype,"create"),clearTraces:function(){var a;for(a=0;a<this.objectsList.length;a++)this.objectsList[a].clearTrace();return this.numTraces=0,this},suspendUpdate:function(){return this.isSuspendedUpdate=!0,this},unsuspendUpdate:function(){return this.isSuspendedUpdate=!1,this.update(),this},setBoundingBox:function(a,b){if(!JXG.isArray(a))return this;var c,d,e=JXG.getDimensions(this.container);return this.canvasWidth=parseInt(e.width),this.canvasHeight=parseInt(e.height),d=this.canvasWidth,c=this.canvasHeight,b?(this.unitX=d/(a[2]-a[0]),this.unitY=c/(a[1]-a[3]),Math.abs(this.unitX)<Math.abs(this.unitY)?this.unitY=Math.abs(this.unitX)*this.unitY/Math.abs(this.unitY):this.unitX=Math.abs(this.unitY)*this.unitX/Math.abs(this.unitX)):(this.unitX=d/(a[2]-a[0]),this.unitY=c/(a[1]-a[3])),this.moveOrigin(-this.unitX*a[0],this.unitY*a[1]),this},getBoundingBox:function(){var a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this),b=new JXG.Coords(JXG.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this);return[a.usrCoords[1],a.usrCoords[2],b.usrCoords[1],b.usrCoords[2]]},addAnimation:function(a){var b=this;return this.animationObjects[a.id]=a,this.animationIntervalCode||(this.animationIntervalCode=setInterval(function(){JXG.JSXGraph.boards[b.id].animate()},a.board.options.animationDelay)),this},stopAllAnimation:function(){var a;for(a in this.animationObjects)null!==this.animationObjects[a]&&(this.animationObjects[a]=null,delete this.animationObjects[a]);return clearInterval(this.animationIntervalCode),delete this.animationIntervalCode,this},animate:function(){var b,c,d,e,f,g,i,a=0,h=null;for(b in this.animationObjects)if(null!==this.animationObjects[b]){if(a++,c=this.animationObjects[b],c.animationPath&&(d=JXG.isFunction(c.animationPath)?c.animationPath((new Date).getTime()-c.animationStart):c.animationPath.pop(),!JXG.exists(d)||!JXG.isArray(d)&&isNaN(d)?delete c.animationPath:(c.setPositionDirectly(JXG.COORDS_BY_USER,d),c.prepareUpdate().update().updateRenderer(),h=c)),c.animationData){g=0;for(e in c.animationData)f=c.animationData[e].pop(),JXG.exists(f)?(g++,c.setProperty(e+":"+f)):delete c.animationData[f];0==g&&delete c.animationData}JXG.exists(c.animationData)||JXG.exists(c.animationPath)||(this.animationObjects[b]=null,delete this.animationObjects[b],JXG.exists(c.animationCallback)&&(i=c.animationCallback,c.animationCallback=null,i()))}return 0==a?(clearInterval(this.animationIntervalCode),delete this.animationIntervalCode):this.update(h),this},migratePoint:function(a,b){var c,d,e,f,g;a=JXG.getRef(this,a),b=JXG.getRef(this,b);for(d in a.childElements){c=a.childElements[d],f=!1;for(e in c)c[e]===a&&(c[e]=b,f=!0);for(f&&delete a.childElements[d],g=0;g<c.parents.length;g++)c.parents[g]===a.id&&(c.parents[g]=b.id);b.addChild(c)}return this.removeObject(a),this.update(),this},emulateColorblindness:function(a){var b,c,d=this;if(JXG.exists(a)||(a="none"),this.currentCBDef==a)return this;for(b in d.objects)c=d.objects[b],"none"!=a?("none"==this.currentCBDef&&(c.visPropOriginal={strokecolor:c.visProp.strokecolor,fillcolor:c.visProp.fillcolor,highlightstrokecolor:c.visProp.highlightstrokecolor,highlightfillcolor:c.visProp.highlightfillcolor}),c.setProperty({strokecolor:JXG.rgb2cb(c.visPropOriginal.strokecolor,a),fillcolor:JXG.rgb2cb(c.visPropOriginal.fillcolor,a),highlightstrokecolor:JXG.rgb2cb(c.visPropOriginal.highlightstrokecolor,a),highlightfillcolor:JXG.rgb2cb(c.visPropOriginal.highlightfillcolor,a)})):JXG.exists(c.visPropOriginal)&&JXG.extend(c.visProp,c.visPropOriginal);return this.currentCBDef=a,this.update(),this},getPartialConstruction:function(){var b,c;for(c=1;c<arguments.length;c++)b.push(arguments[c])},createRoulette:function(a,b,c,d,e,f,g){var h=this,i=function(){var p,i=0,j=0,k=0,l=c,m=JXG.Math.Numerics.root(function(c){var d=a.X(l),e=a.Y(l),f=b.X(c),g=b.Y(c);return(d-f)*(d-f)+(e-g)*(e-g)},[0,2*Math.PI]),n=0,o=0,q=h.create("transform",[function(){return i}],{type:"rotate"}),r=h.create("transform",[function(){return i},function(){return a.X(l)},function(){return a.Y(l)}],{type:"rotate"}),s=h.create("transform",[function(){return j},function(){return k}],{type:"translate"}),t=function(a,b,c){var d=JXG.Math.Numerics.D(a.X)(b),e=JXG.Math.Numerics.D(a.Y)(b),f=JXG.Math.Numerics.D(a.X)(c),g=JXG.Math.Numerics.D(a.Y)(c),h=JXG.Math.Numerics.D(a.X)(.5*(b+c)),i=JXG.Math.Numerics.D(a.Y)(.5*(b+c)),j=Math.sqrt(d*d+e*e),k=Math.sqrt(f*f+g*g),l=Math.sqrt(h*h+i*i);return(j+4*l+k)*(c-b)/6},u=function(a){return p-t(b,m,a)},v=Math.PI/18,w=9*v,x=null;return this.rolling=function(){n=l+e*d,p=t(a,l,n),o=JXG.Math.Numerics.root(u,m);var c=new JXG.Complex(a.X(n),a.Y(n)),f=new JXG.Complex(b.X(o),b.Y(o)),x=new JXG.Complex(JXG.Math.Numerics.D(a.X)(n),JXG.Math.Numerics.D(a.Y)(n)),y=new JXG.Complex(JXG.Math.Numerics.D(b.X)(o),JXG.Math.Numerics.D(b.Y)(o)),z=JXG.C.div(x,y);i=Math.atan2(z.imaginary,z.real),z.div(JXG.C.abs(z)),z.mult(f),j=c.real-z.real,k=c.imaginary-z.imaginary,-v>i&&i>-w?(i=-v,r.applyOnce(g)):i>v&&w>i?(i=v,r.applyOnce(g)):(q.applyOnce(g),s.applyOnce(g),l=n,m=o),h.update()},this.start=function(){return f>0&&(x=setInterval(this.rolling,f)),this},this.stop=function(){return clearInterval(x),this},this};return new i}}),JXG.Options={showCopyright:!0,showNavigation:!0,takeSizeFromFile:!1,renderer:"svg",takeFirst:!1,pan:!0,animationDelay:35,zoom:{factorX:1.25,factorY:1.25,wheel:!1},jc:{enabled:!0,compile:!0},navbar:{strokeColor:"#aaaaaa",fillColor:"#f5f5f5",padding:"2px",position:"absolute",fontSize:"10px",cursor:"pointer",zIndex:"100",right:"5px",bottom:"5px"},elements:{strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",fillColor:"red",highlightFillColor:"none",strokeOpacity:1,highlightStrokeOpacity:1,fillOpacity:1,highlightFillOpacity:1,strokeWidth:2,highlightStrokeWidth:2,fixed:!1,frozen:!1,withLabel:!1,visible:!0,priv:!1,layer:0,dash:0,shadow:!1,trace:!1,traceAttributes:{},highlight:!0,needsRegularUpdate:!0,snapToGrid:!1,draft:{draft:!1,strokeColor:"#565656",fillColor:"#565656",strokeOpacity:.8,fillOpacity:.8,strokeWidth:1}},ticks:{drawLabels:!1,label:{},drawZero:!1,insertTicks:!1,minTicksDistance:50,minorHeight:4,majorHeight:10,minorTicks:4,scale:1,scaleSymbol:"",labels:[],ticksDistance:1,strokeOpacity:1,strokeWidth:1,strokeColor:"black",highlightStrokeColor:"#888888"},precision:{touch:30,touchMax:100,mouse:4,epsilon:1e-4,hasPoint:4},layer:{numlayers:20,text:9,point:9,glider:9,arc:8,line:7,circle:6,curve:5,turtle:5,polygon:3,sector:3,angle:3,integral:3,axis:2,grid:1,image:0,trace:0},angle:{withLabel:!0,radius:.5,type:"sector",orthoType:"square",orthoSensitivity:1,fillColor:"#FF7F00",highlightFillColor:"#FF7F00",strokeColor:"#FF7F00",fillOpacity:.3,highlightFillOpacity:.3,radiuspoint:{withLabel:!1,visible:!1,name:""},pointsquare:{withLabel:!1,visible:!1,name:""},dot:{visible:!1,strokeColor:"none",fillColor:"black",size:2,face:"o",withLabel:!1,name:""},label:{position:"top",offset:[0,0],strokeColor:"#0000FF"}},arc:{label:{},firstArrow:!1,lastArrow:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",useDirection:!1},axis:{needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeWidth:1,highlightStrokeColor:"#888888",withTicks:!0,straightFirst:!0,straightLast:!0,lastArrow:!0,withLabel:!1,ticks:{label:{offset:[4,-9]},needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeColor:"#888888",drawLabels:!0,drawZero:!1,insertTicks:!0,minTicksDistance:10,minorHeight:4,majorHeight:-1,minorTicks:4,ticksDistance:1,strokeOpacity:.25},point1:{needsRegularUpdate:!1},point2:{needsRegularUpdate:!1},label:{position:"lft",offset:[10,-20]}},bisector:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},bisectorlines:{line1:{strokeColor:"black"},line2:{strokeColor:"black"}},chart:{chartStyle:"line",colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"],highlightcolors:null,fillcolor:null,highlightonsector:!1,highlightbysize:!1},circle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""},label:{position:"urt"}},circumcircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},circumcirclearc:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""}},circumcirclesector:{useDirection:!0,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},conic:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",foci:{fixed:!1,visible:!1,withLabel:!1,name:""}},curve:{strokeWidth:1,strokeColor:"#0000ff",fillColor:"none",handDrawing:!1,curveType:null,RDPsmoothing:!1,numberPointsHigh:1600,numberPointsLow:400,doAdvancedPlot:!0,label:{position:"lft"}},glider:{label:{}},grid:{needsRegularUpdate:!1,hasGrid:!1,gridX:1,gridY:1,strokeColor:"#C0C0C0",strokeOpacity:"0.5",strokeWidth:1,dash:0,snapToGrid:!1,snapSizeX:10,snapSizeY:10},image:{imageString:null,fillOpacity:1,rotate:0},incircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},infobox:{fontSize:12,isLabel:!1,strokeColor:"#bbbbbb",display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGinfobox",rotate:0,visible:!0},integral:{withLabel:!0,strokeWidth:0,strokeOpacity:0,fillOpacity:.8,curveLeft:{visible:!0,layer:9},baseLeft:{visible:!1,fixed:!1,withLabel:!1,name:""},curveRight:{visible:!0,layer:9},baseRight:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{fontSize:20}},label:{strokeColor:"black",fixed:!0,position:"urt",offset:[10,10]},legend:{style:"vertical",labels:["1","2","3","4","5","6","7","8"],colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"]},line:{firstArrow:!1,lastArrow:!1,straightFirst:!0,straightLast:!0,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#888888",withTicks:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},ticks:{drawLabels:!0,label:{offset:[4,-9]},drawZero:!1,insertTicks:!1,minTicksDistance:50,maxTicksDistance:300,minorHeight:4,majorHeight:-1,minorTicks:4,defaultDistance:1,strokeOpacity:.3},label:{position:"llft"}},locus:{translateToOrigin:!1,translateTo10:!1,stretch:!1,toOrigin:null,to10:null},normal:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},orthogonalprojection:{},parallel:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},perpendicular:{strokeColor:"#000000",straightFirst:!0,straightLast:!0},perpendicularsegment:{strokeColor:"#000000",straightFirst:!1,straightLast:!1,point:{visible:!1,fixed:!0,withLabel:!1,name:""}},point:{withLabel:!0,label:{},style:5,face:"o",size:3,fillColor:"#ff0000",highlightFillColor:"#EEEEEE",strokeWidth:2,strokeColor:"#ff0000",highlightStrokeColor:"#C3D9FF",zoom:!1,showInfobox:!0,infoboxDigits:"auto",draft:!1,attractors:[],attractorDistance:0,snatchDistance:0,snapToGrid:!1,snapSizeX:1,snapSizeY:1,snapToPoints:!1},polygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5},vertices:{withLabel:!0,strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!0},label:{offset:[0,0]}},riemannsum:{withLabel:!1,fillOpacity:.3,fillColor:"#ffff00"},sector:{fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,label:{offset:[0,0]}},semicircle:{midpoint:{visible:!1,withLabel:!1,fixed:!1,name:""}},slider:{snapWidth:-1,precision:2,firstArrow:!1,lastArrow:!1,withTicks:!0,withLabel:!0,layer:9,showInfobox:!1,name:"",visible:!0,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"#ffffff",highlightFillColor:"none",size:6,point1:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},point2:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},baseline:{needsRegularUpdate:!1,name:"",strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888"},ticks:{needsRegularUpdate:!1,drawLabels:!1,drawZero:!1,insertTicks:!0,minorHeight:4,majorHeight:10,minorTicks:0,defaultDistance:1,strokeOpacity:1,strokeWidth:1,strokeColor:"#000000"},highline:{strokeWidth:3,name:"",strokeColor:"#000000",highlightStrokeColor:"#888888"},label:{strokeColor:"#000000"}},text:{fontSize:12,digits:2,isLabel:!1,strokeColor:"#000000",useASCIIMathML:!1,useMathJax:!1,display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGtext",highlightCssClass:"JXGtext",withLabel:!1,rotate:0,visible:!0},tracecurve:{strokeColor:"#000000",fillColor:"none",numberPoints:100},turtle:{strokeWidth:1,fillColor:"none",strokeColor:"#000000",arrow:{strokeWidth:2,withLabel:!1,strokeColor:"#ff0000"}},shortcuts:{color:["strokeColor","fillColor"],opacity:["strokeOpacity","fillOpacity"],highlightColor:["highlightStrokeColor","highlightFillColor"],highlightOpacity:["highlightStrokeOpacity","highlightFillOpacity"],strokeWidth:["strokeWidth","highlightStrokeWidth"]}},JXG.Validator=function(){var k,a=function(a){return/^[0-9]+px$/.test(a)},b=function(a){return a in{html:0,internal:0}},c=function(a){return JXG.isString(a)},d=function(a){return JXG.exists(JXG.Point.prototype.normalizeFace.call(this,a))},e=function(a){return Math.abs(a-Math.round(a))<JXG.Math.eps},f=function(a){return e(a)&&a>0},h=function(a){return a in{vml:0,svg:0,canvas:0}},i=function(a){return a>0},j=function(a){return!(0>a)},l={},m={attractorDistance:j,color:c,defaultDistance:JXG.isNumber,display:b,doAdvancedPlot:!1,draft:!1,drawLabels:!1,drawZero:!1,face:d,factor:JXG.isNumber,fillColor:c,fillOpacity:JXG.isNumber,firstArrow:!1,fontSize:e,dash:e,gridX:JXG.isNumber,gridY:JXG.isNumber,hasGrid:!1,highlightFillColor:c,highlightFillOpacity:JXG.isNumber,highlightStrokeColor:c,highlightStrokeOpacity:JXG.isNumber,insertTicks:!1,lastArrow:!1,majorHeight:e,maxTicksDistance:f,minorHeight:e,minorTicks:f,minTicksDistance:f,numberPointsHigh:f,numberPointsLow:f,opacity:JXG.isNumber,radius:JXG.isNumber,RDPsmoothing:!1,renderer:h,right:a,showCopyright:!1,showInfobox:!1,showNavigation:!1,size:e,snapSizeX:i,snapSizeY:i,snapWidth:JXG.isNumber,snapToGrid:!1,snatchDistance:j,straightFirst:!1,straightLast:!1,stretch:!1,strokeColor:c,strokeOpacity:JXG.isNumber,strokeWidth:e,takeFirst:!1,takeSizeFromFile:!1,to10:!1,toOrigin:!1,translateTo10:!1,translateToOrigin:!1,useASCIIMathML:!1,useDirection:!1,useMathJax:!1,withLabel:!1,withTicks:!1,zoom:!1};for(k in m)l[k.toLowerCase()]=m[k];return l}(),JXG.useStandardOptions=function(a){var d,e,f,g,b=JXG.Options,c=a.hasGrid;a.options.grid.hasGrid=b.grid.hasGrid,a.options.grid.gridX=b.grid.gridX,a.options.grid.gridY=b.grid.gridY,a.options.grid.gridColor=b.grid.gridColor,a.options.grid.gridOpacity=b.grid.gridOpacity,a.options.grid.gridDash=b.grid.gridDash,a.options.grid.snapToGrid=b.grid.snapToGrid,a.options.grid.snapSizeX=b.grid.SnapSizeX,a.options.grid.snapSizeY=b.grid.SnapSizeY,a.takeSizeFromFile=b.takeSizeFromFile,g=function(a,b){a.visProp.fillcolor=b.fillColor,a.visProp.highlightfillcolor=b.highlightFillColor,a.visProp.strokecolor=b.strokeColor,a.visProp.highlightstrokecolor=b.highlightStrokeColor};for(d in a.objects)if(f=a.objects[d],f.elementClass==JXG.OBJECT_CLASS_POINT)g(f,b.point);else if(f.elementClass==JXG.OBJECT_CLASS_LINE){g(f,b.line);for(e in f.ticks)e.majorTicks=b.line.ticks.majorTicks,e.minTicksDistance=b.line.ticks.minTicksDistance,e.visProp.minorheight=b.line.ticks.minorHeight,e.visProp.majorheight=b.line.ticks.majorHeight
}else f.elementClass==JXG.OBJECT_CLASS_CIRCLE?g(f,b.circle):f.type==JXG.OBJECT_TYPE_ANGLE?g(f,b.angle):f.type==JXG.OBJECT_TYPE_ARC?g(f,b.arc):f.type==JXG.OBJECT_TYPE_POLYGON?g(f,b.polygon):f.type==JXG.OBJECT_TYPE_CONIC?g(f,b.conic):f.type==JXG.OBJECT_TYPE_CURVE?g(f,b.curve):f.type==JXG.OBJECT_TYPE_SECTOR&&(f.arc.visProp.fillcolor=b.sector.fillColor,f.arc.visProp.highlightfillcolor=b.sector.highlightFillColor,f.arc.visProp.fillopacity=b.sector.fillOpacity,f.arc.visProp.highlightfillopacity=b.sector.highlightFillOpacity);a.fullUpdate(),c&&!a.hasGrid?a.removeGrids(a):!c&&a.hasGrid&&a.create("grid",[])},JXG.useBlackWhiteOptions=function(a){var b=JXG.Options;b.point.fillColor=JXG.rgb2bw(b.point.fillColor),b.point.highlightFillColor=JXG.rgb2bw(b.point.highlightFillColor),b.point.strokeColor=JXG.rgb2bw(b.point.strokeColor),b.point.highlightStrokeColor=JXG.rgb2bw(b.point.highlightStrokeColor),b.line.fillColor=JXG.rgb2bw(b.line.fillColor),b.line.highlightFillColor=JXG.rgb2bw(b.line.highlightFillColor),b.line.strokeColor=JXG.rgb2bw(b.line.strokeColor),b.line.highlightStrokeColor=JXG.rgb2bw(b.line.highlightStrokeColor),b.circle.fillColor=JXG.rgb2bw(b.circle.fillColor),b.circle.highlightFillColor=JXG.rgb2bw(b.circle.highlightFillColor),b.circle.strokeColor=JXG.rgb2bw(b.circle.strokeColor),b.circle.highlightStrokeColor=JXG.rgb2bw(b.circle.highlightStrokeColor),b.arc.fillColor=JXG.rgb2bw(b.arc.fillColor),b.arc.highlightFillColor=JXG.rgb2bw(b.arc.highlightFillColor),b.arc.strokeColor=JXG.rgb2bw(b.arc.strokeColor),b.arc.highlightStrokeColor=JXG.rgb2bw(b.arc.highlightStrokeColor),b.polygon.fillColor=JXG.rgb2bw(b.polygon.fillColor),b.polygon.highlightFillColor=JXG.rgb2bw(b.polygon.highlightFillColor),b.sector.fillColor=JXG.rgb2bw(b.sector.fillColor),b.sector.highlightFillColor=JXG.rgb2bw(b.sector.highlightFillColor),b.curve.strokeColor=JXG.rgb2bw(b.curve.strokeColor),b.grid.gridColor=JXG.rgb2bw(b.grid.gridColor),JXG.useStandardOptions(a)},JXG.JSXGraph={licenseText:"JSXGraph v0.95 Copyright (C) see http://jsxgraph.org",boards:{},elements:{},rendererType:function(){function b(){document.body.scrollLeft,document.body.scrollTop}var a=function(a){var b,c;if(JXG.rendererFiles[a]){for(b=JXG.rendererFiles[a].split(","),c=0;c<b.length;c++)!function(a){JXG.require(JXG.requirePath+a+".js")}(b[c]);delete JXG.rendererFiles[a]}};return JXG.Options.renderer="no",JXG.supportsVML()&&(JXG.Options.renderer="vml",document.onmousemove=b,a("vml")),JXG.supportsCanvas()&&(JXG.Options.renderer="canvas",a("canvas")),JXG.supportsSVG()&&(JXG.Options.renderer="svg",a("svg")),JXG.Options.renderer}(),initBoard:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;return j=JXG.getDimensions(a),"undefined"==typeof b&&(b={}),"undefined"!=typeof b.boundingbox?(k=b.boundingbox,h=parseInt(j.width),i=parseInt(j.height),b.keepaspectratio?(f=h/(k[2]-k[0]),g=i/(-k[3]+k[1]),Math.abs(f)<Math.abs(g)?g=Math.abs(f)*g/Math.abs(g):f=Math.abs(g)*f/Math.abs(f)):(f=h/(k[2]-k[0]),g=i/(-k[3]+k[1])),d=-f*k[0],e=g*k[1]):(d="undefined"==typeof b.originX?150:b.originX,e="undefined"==typeof b.originY?150:b.originY,f="undefined"==typeof b.unitX?50:b.unitX,g="undefined"==typeof b.unitY?50:b.unitY),l="undefined"==typeof b.zoomfactor?1:b.zoom,m=l*("undefined"==typeof b.zoomX?1:b.zoomX),n=l*("undefined"==typeof b.zoomY?1:b.zoomY),o="undefined"==typeof b.showCopyright?JXG.Options.showCopyright:b.showCopyright,r="undefined"==typeof b.zoom?JXG.Options.zoom.wheel:b.zoom,s="undefined"==typeof b.pan?JXG.Options.pan:b.pan,c="svg"==JXG.Options.renderer?new JXG.SVGRenderer(document.getElementById(a)):"vml"==JXG.Options.renderer?new JXG.VMLRenderer(document.getElementById(a)):"silverlight"==JXG.Options.renderer?new JXG.SilverlightRenderer(document.getElementById(a),j.width,j.height):"canvas"==JXG.Options.renderer?new JXG.CanvasRenderer(document.getElementById(a)):new JXG.NoRenderer,q=new JXG.Board(a,c,"",[d,e],m,n,f,g,j.width,j.height,o),this.boards[q.id]=q,q.keepaspectratio=b.keepaspectratio,q.options.zoom.wheel=r,q.options.pan=s,q.suspendUpdate(),q.initInfobox(),b.axis&&(t="object"==typeof b.axis?b.axis:{ticks:{drawZero:!1}},q.defaultAxes={},q.defaultAxes.x=q.create("axis",[[0,0],[1,0]],t),q.defaultAxes.y=q.create("axis",[[0,0],[0,1]],t)),b.grid&&q.create("grid",[],"object"==typeof b.grid?b.grid:{}),"undefined"!=typeof b.shownavigation&&(b.showNavigation=b.shownavigation),p="undefined"==typeof b.showNavigation?q.options.showNavigation:b.showNavigation,p&&q.renderer.drawZoomBar(q),q.unsuspendUpdate(),q},loadBoardFromFile:function(a,b,c){var d,e,f;return d="svg"==JXG.Options.renderer?new JXG.SVGRenderer(document.getElementById(a)):"vml"==JXG.Options.renderer?new JXG.VMLRenderer(document.getElementById(a)):"silverlight"==JXG.Options.renderer?new JXG.SilverlightRenderer(document.getElementById(a),f.width,f.height):new JXG.CanvasRenderer(document.getElementById(a)),f=JXG.getDimensions(a),e=new JXG.Board(a,d,"",[150,150],1,1,50,50,f.width,f.height),e.initInfobox(),JXG.FileReader.parseFileContent(b,e,c),e.options.showNavigation&&e.renderer.drawZoomBar(e),this.boards[e.id]=e,e},loadBoardFromString:function(a,b,c){var d,e,f;return d="svg"==JXG.Options.renderer?new JXG.SVGRenderer(document.getElementById(a)):"vml"==JXG.Options.renderer?new JXG.VMLRenderer(document.getElementById(a)):"silverlight"==JXG.Options.renderer?new JXG.SilverlightRenderer(document.getElementById(a),e.width,e.height):new JXG.CanvasRenderer(document.getElementById(a)),e=JXG.getDimensions(a),f=new JXG.Board(a,d,"",[150,150],1,1,50,50,e.width,e.height),f.initInfobox(),JXG.FileReader.parseString(b,f,c,!0),f.options.showNavigation&&f.renderer.drawZoomBar(f),this.boards[f.id]=f,f},freeBoard:function(a){var b;"string"==typeof a&&(a=this.boards[a]),a.removeEventHandlers(),a.suspendUpdate();for(b in a.objects)a.removeObject(a.objects[b]);for(;a.containerObj.firstChild;)a.containerObj.removeChild(a.containerObj.firstChild);for(b in a.objects)delete a.objects[b];delete a.renderer,delete a.algebra,a.jc.creator.clearCache(),delete a.jc,delete this.boards[a.id]},registerElement:function(a,b){if(a=a.toLowerCase(),this.elements[a]=b,JXG.Board.prototype["_"+a])throw new Error("JSXGraph: Can't create wrapper method in JXG.Board because member '_"+a+"' already exists'");JXG.Board.prototype["_"+a]=function(b,c){return this.create(a,b,c)}},unregisterElement:function(a){delete this.elements[a.toLowerCase()],delete JXG.Board.prototype["_"+a.toLowerCase()]}},JXG.OBJECT_TYPE_ARC=1,JXG.OBJECT_TYPE_ARROW=2,JXG.OBJECT_TYPE_AXIS=3,JXG.OBJECT_TYPE_AXISPOINT=4,JXG.OBJECT_TYPE_TICKS=5,JXG.OBJECT_TYPE_CIRCLE=6,JXG.OBJECT_TYPE_CONIC=7,JXG.OBJECT_TYPE_CURVE=8,JXG.OBJECT_TYPE_GLIDER=9,JXG.OBJECT_TYPE_IMAGE=10,JXG.OBJECT_TYPE_LINE=11,JXG.OBJECT_TYPE_POINT=12,JXG.OBJECT_TYPE_SLIDER=13,JXG.OBJECT_TYPE_CAS=14,JXG.OBJECT_TYPE_GXTCAS=15,JXG.OBJECT_TYPE_POLYGON=16,JXG.OBJECT_TYPE_SECTOR=17,JXG.OBJECT_TYPE_TEXT=18,JXG.OBJECT_TYPE_ANGLE=19,JXG.OBJECT_TYPE_INTERSECTION=20,JXG.OBJECT_TYPE_TURTLE=21,JXG.OBJECT_TYPE_VECTOR=22,JXG.OBJECT_TYPE_OPROJECT=23,JXG.OBJECT_TYPE_GRID=24,JXG.OBJECT_CLASS_POINT=1,JXG.OBJECT_CLASS_LINE=2,JXG.OBJECT_CLASS_CIRCLE=3,JXG.OBJECT_CLASS_CURVE=4,JXG.OBJECT_CLASS_AREA=5,JXG.OBJECT_CLASS_OTHER=6,JXG.GeometryElement=function(a,b,c,d){var e,f;if(this.needsUpdate=!0,this.isDraggable=!1,this.isReal=!0,this.childElements={},this.hasLabel=!1,this.highlighted=!1,this.notExistingParents={},this.traces={},this.numTraces=0,this.transformations=[],this.baseElement=null,this.descendants={},this.ancestors={},this.symbolic={},this.elType="",this.dump=!0,this.subs={},this._pos=-1,this.stdform=[1,0,0,0,1,1,0,0],this.methodMap={setLabel:"setLabelText",getName:"getName",addTransform:"addTransform",setProperty:"setProperty",setAttribute:"setAttribute"},this.quadraticform=[[1,0,0],[0,1,0],[0,0,1]],this.visProp={},this.eventHandlers={},this.mouseover=!1,arguments.length>0){this.board=a,this.type=c,this.elementClass=d||JXG.OBJECT_CLASS_OTHER,this.id=b.id,e=b.name,JXG.exists(e)||(e=this.board.generateName(this)),this.board.elementsByName[e]=this,this.name=e,this.needsRegularUpdate=b.needsregularupdate,JXG.clearVisPropOld(this),b=this.resolveShortcuts(b);for(f in b)this._set(f,b[f]);this.visProp.draft=b.draft&&b.draft.draft,this.visProp.gradientangle="270",this.visProp.gradientsecondopacity=this.visProp.fillopacity,this.visProp.gradientpositionx=.5,this.visProp.gradientpositiony=.5}},JXG.extend(JXG.GeometryElement.prototype,{addChild:function(a){var b,c;this.childElements[a.id]=a,this.addDescendants(a),a.ancestors[this.id]=this;for(b in this.descendants){this.descendants[b].ancestors[this.id]=this;for(c in this.ancestors)this.descendants[b].ancestors[this.ancestors[c].id]=this.ancestors[c]}for(b in this.ancestors)for(c in this.descendants)this.ancestors[b].descendants[this.descendants[c].id]=this.descendants[c];return this},addDescendants:function(a){var b;this.descendants[a.id]=a;for(b in a.childElements)this.addDescendants(a.childElements[b]);return this},countChildren:function(){var a,c,b=0;c=this.childElements;for(a in c)c.hasOwnProperty(a)&&a.indexOf("Label")<0&&b++;return b},getName:function(){return this.name},addTransform:function(){},draggable:function(){return this.isDraggable&&!this.visProp.fixed&&!this.visProp.frozen&&this.type!=JXG.OBJECT_TYPE_GLIDER},generatePolynomial:function(){return[]},animate:function(a,b,c){c=c||{};var d,e,h,f=this.board.options.animationDelay,g=Math.ceil(b/(1*f)),i=this,j=!1;this.animationData={};var k=function(a,b,c){var d,e,f,j,k;for(d=JXG.rgb2hsv(a),e=JXG.rgb2hsv(b),f=(e[0]-d[0])/(1*g),j=(e[1]-d[1])/(1*g),k=(e[2]-d[2])/(1*g),i.animationData[c]=new Array(g),h=0;g>h;h++)i.animationData[c][g-h-1]=JXG.hsv2rgb(d[0]+(h+1)*f,d[1]+(h+1)*j,d[2]+(h+1)*k)},l=function(a,b,c,d){var e;if(a=parseFloat(a),b=parseFloat(b),!isNaN(a)&&!isNaN(b)){var f=(b-a)/(1*g);for(i.animationData[c]=new Array(g),h=0;g>h;h++)e=a+(h+1)*f,i.animationData[c][g-h-1]=d?Math.floor(e):e}};for(d in a)switch(e=d.toLowerCase()){case"strokecolor":case"fillcolor":k(this.visProp[e],a[d],e);break;case"size":if(this.elementClass!==JXG.OBJECT_CLASS_POINT)break;j=!0;case"strokeopacity":case"strokewidth":case"fillopacity":l(this.visProp[e],a[d],e,j)}return this.animationCallback=c.callback,this.board.addAnimation(this),this},update:function(){return this.visProp.trace&&this.cloneToBackground(!0),this},updateRenderer:function(){return this},hideElement:function(){return this.visProp.visible=!1,this.board.renderer.hide(this),null!=this.label&&this.hasLabel&&(this.label.hiddenByParent=!0,this.label.content.visProp.visible&&this.board.renderer.hide(this.label.content)),this},showElement:function(){return this.visProp.visible=!0,this.board.renderer.show(this),null!=this.label&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.content.visProp.visible&&this.board.renderer.show(this.label.content)),this},_set:function(a,b){a=a.toLocaleLowerCase(),this.visProp.hasOwnProperty(a)&&a.indexOf("color")>=0&&JXG.isString(b)&&9==b.length&&"#"===b.charAt(0)?(b=JXG.rgba2rgbo(b),this.visProp[a]=b[0],this.visProp[a.replace("color","opacity")]=b[1]):this.visProp[a]=b},resolveShortcuts:function(a){var b,c;for(b in JXG.Options.shortcuts)if(JXG.exists(a[b]))for(c=0;c<JXG.Options.shortcuts[b].length;c++)JXG.exists(a[JXG.Options.shortcuts[b][c]])||(a[JXG.Options.shortcuts[b][c]]=a[b]);return a},setLabelText:function(a){return a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;"),null!==this.label&&this.label.content.setText(a),this},setAttribute:JXG.shortcut(JXG.GeometryElement.prototype,"setProperty"),setProperty:function(){var a,b,c,d,e,f,g={};for(a=0;a<arguments.length;a++)d=arguments[a],JXG.isString(d)?(f=d.split(":"),g[JXG.trim(f[0])]=JXG.trim(f[1])):JXG.isArray(d)?g[d[0]]=d[1]:JXG.extend(g,d);g=this.resolveShortcuts(g);for(a in g)switch(b=a.replace(/\s+/g,"").toLowerCase(),c=g[a],b){case"name":delete this.board.elementsByName[this.name],this.name=c,this.board.elementsByName[this.name]=this;break;case"needsregularupdate":this.needsRegularUpdate=!("false"==c||0==c),this.board.renderer.setBuffering(this,this.needsRegularUpdate?"auto":"static");break;case"labelcolor":c=JXG.rgba2rgbo(c),e=c[1],c=c[0],0==e&&null!=this.label&&this.hasLabel&&this.label.content.hideElement(),null!=this.label&&this.hasLabel&&(this.label.color=c,this.board.renderer.setObjectStrokeColor(this.label.content,c,e)),this.type==JXG.OBJECT_TYPE_TEXT&&(this.visProp.strokecolor=c,this.visProp.strokeopacity=e,this.board.renderer.setObjectStrokeColor(this,this.visProp.strokecolor,this.visProp.strokeopacity));break;case"infoboxtext":this.infoboxText="string"==typeof c?c:!1;break;case"visible":"false"==c||0==c?(this.visProp.visible=!1,this.hideElement()):("true"==c||1==c)&&(this.visProp.visible=!0,this.showElement());break;case"face":this.elementClass==JXG.OBJECT_CLASS_POINT&&(this.visProp.face=c,this.board.renderer.changePointStyle(this));break;case"trace":"false"==c||0==c?(this.clearTrace(),this.visProp.trace=!1):this.visProp.trace=!0;break;case"gradient":this.visProp.gradient=c,this.board.renderer.setGradient(this);break;case"gradientsecondcolor":c=JXG.rgba2rgbo(c),this.visProp.gradientsecondcolor=c[0],this.visProp.gradientsecondopacity=c[1],this.board.renderer.updateGradient(this);break;case"gradientsecondopacity":this.visProp.gradientsecondopacity=c,this.board.renderer.updateGradient(this);break;case"withlabel":this.visProp.withlabel=c,c?this.label&&this.label.content?this.visProp.visible&&this.label.content.showElement():(this.createLabel(),this.visProp.visible||this.label.content.hideElement()):this.label&&this.label.content&&this.hasLabel&&this.label.content.hideElement(),this.hasLabel=c;break;case"rotate":(this.type===JXG.OBJECT_TYPE_TEXT&&"internal"==this.visProp.display||this.type===JXG.OBJECT_TYPE_IMAGE)&&this.addRotation(c);break;default:JXG.exists(this.visProp[b])&&(!JXG.Validator[b]||JXG.Validator[b]&&JXG.Validator[b](c)||JXG.Validator[b]&&JXG.isFunction(c)&&JXG.Validator[b](c()))&&(c=c.toLowerCase&&"false"===c.toLowerCase()?!1:c,this._set(b,c))}return this.visProp.needsregularupdate?this.board.update(this):this.board.fullUpdate(),this},getAttribute:JXG.shortcut(JXG.GeometryElement.prototype,"getProperty"),getProperty:function(a){var b;switch(a=a.toLowerCase()){case"needsregularupdate":b=this.needsRegularUpdate;break;case"labelcolor":b=this.label.color;break;case"infoboxtext":b=this.infoboxText;break;case"withlabel":b=this.hasLabel;break;default:b=this.visProp[a]}return b},setDash:function(a){return this.setProperty({dash:a}),this},prepareUpdate:function(){return this.needsUpdate=!0,this},remove:function(){return this.board.renderer.remove(this.board.renderer.getElementById(this.id)),this.hasLabel&&this.board.renderer.remove(this.board.renderer.getElementById(this.label.content.id)),this},getTextAnchor:function(){return new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board)},getLabelAnchor:function(){return new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board)},setStraight:function(){return this},setArrow:function(a,b){return this.visProp.firstarrow=a,this.visProp.lastarrow=b,this.prepareUpdate().update(),this},createGradient:function(){("linear"===this.visProp.gradient||"radial"===this.visProp.gradient)&&this.board.renderer.setGradient(this)},createLabel:function(){var a={};return a=JXG.deepCopy(this.visProp.label,null),a.id=this.id+"Label",a.isLabel=!0,a.visible=this.visProp.visible,a.anchor=this,a.priv=this.visProp.priv,this.nameHTML=JXG.GeonextParser.replaceSup(JXG.GeonextParser.replaceSub(this.name)),this.label={},this.visProp.withlabel&&(this.label.relativeCoords=[0,0],this.label.content=JXG.createText(this.board,[this.label.relativeCoords[0],-this.label.relativeCoords[1],this.nameHTML],a),this.label.content.dump=!1,this.label.color=this.label.content.visProp.strokecolor,this.visProp.visible||(this.label.hiddenByParent=!0,this.label.content.visProp.visible=!1),this.hasLabel=!0),this},highlight:function(a){return a=JXG.def(a,!1),(!this.highlighted||a)&&(this.highlighted=!0,this.board.renderer.highlight(this)),this},noHighlight:function(){return this.highlighted&&(this.highlighted=!1,this.board.renderer.noHighlight(this)),this},clearTrace:function(){var a;for(a in this.traces)this.board.renderer.remove(this.traces[a]);return this.numTraces=0,this},cloneToBackground:function(){return this},bounds:function(){},normalize:function(){return this.stdform=JXG.Math.normalize(this.stdform),this},toJSON:function(){var a='{"name":'+this.name;a+=', "id":'+this.id;var b=[];for(var c in this.visProp)null!=this.visProp[c]&&b.push('"'+c+'":'+this.visProp[c]);return a+=', "visProp":{'+b.toString()+"}",a+="}"},addRotation:function(a){var b,c,d,e,f,g=this;if((this.type===JXG.OBJECT_TYPE_TEXT&&"internal"===this.visProp.display||this.type===JXG.OBJECT_TYPE_IMAGE)&&0!=a){var b,c,d,e,f,g=this;b=this.board.create("transform",[function(){return-g.X()},function(){return-g.Y()}],{type:"translate"}),c=this.board.create("transform",[function(){return g.X()},function(){return g.Y()}],{type:"translate"}),d=this.board.create("transform",[function(){return g.board.unitX/g.board.unitY},function(){return 1}],{type:"scale"}),e=this.board.create("transform",[function(){return g.board.unitY/g.board.unitX},function(){return 1}],{type:"scale"}),f=this.board.create("transform",[a*Math.PI/180],{type:"rotate"}),b.bindTo(this),d.bindTo(this),f.bindTo(this),e.bindTo(this),c.bindTo(this)}return this},highlightStrokeColor:function(a){return this.setProperty({highlightStrokeColor:a}),this},strokeColor:function(a){return this.setProperty({strokeColor:a}),this},strokeWidth:function(a){return this.setProperty({strokeWidth:a}),this},fillColor:function(a){return this.setProperty({fillColor:a}),this},highlightFillColor:function(a){return this.setProperty({highlightFillColor:a}),this},labelColor:function(a){return this.setProperty({labelColor:a}),this},dash:function(a){return this.setProperty({dash:a}),this},visible:function(a){return this.setProperty({visible:a}),this},shadow:function(a){return this.setProperty({shadow:a}),this},getType:function(){return this.elType},getParents:function(){return this.parents},snapToGrid:function(){return this},getAttributes:function(){var c,a=JXG.deepCopy(this.visProp),b=["attractors","attractordistance","snatchdistance","traceattributes","frozen","shadow","gradientangle","gradientsecondopacity","gradientpositionx","gradientpositiony","needsregularupdate","zoom","layer","offset"];for(a.id=this.id,a.name=this.name,c=0;c<b.length;c++)delete a[b[c]];return a},hasPoint:function(){return!1},triggerEventHandlers:function(a){var b,c,e,f,d=Array.prototype.slice.call(arguments,1);for(JXG.isArray(a)||(a=[a]),e=0;e<a.length;e++)if(f=a[e],JXG.isArray(this.eventHandlers[f]))for(b=0;b<this.eventHandlers[f].length;b++)c=this.eventHandlers[f][b],c.handler.apply(c.context,d)},on:function(a,b,c){JXG.isArray(this.eventHandlers[a])||(this.eventHandlers[a]=[]),c=JXG.def(c,this),this.eventHandlers[a].push({handler:b,context:c})},addEvent:JXG.shortcut(JXG.GeometryElement.prototype,"on"),off:function(a,b){var c;a&&JXG.isArray(this.eventHandlers[a])&&(b?(c=JXG.indexOf(this.eventHandlers[a],b,"handler"),c>-1&&this.eventHandlers[a].splice(c,1)):this.eventHandlers[a].length=0)},removeEvent:JXG.shortcut(JXG.GeometryElement.prototype,"off")}),JXG.COORDS_BY_USER=1,JXG.COORDS_BY_SCREEN=2,JXG.Coords=function(a,b,c){this.board=c,this.usrCoords=[],this.scrCoords=[],this.setCoordinates(a,b)},JXG.extend(JXG.Coords.prototype,{normalizeUsrCoords:function(){var a=JXG.Math.eps;Math.abs(this.usrCoords[0])>a&&(this.usrCoords[1]/=this.usrCoords[0],this.usrCoords[2]/=this.usrCoords[0],this.usrCoords[0]=1)},usr2screen:function(a){var b=Math.round,c=this.board,d=this.usrCoords,e=c.origin.scrCoords;null===a||a?(this.scrCoords[0]=b(d[0]),this.scrCoords[1]=b(d[0]*e[1]+d[1]*c.unitX),this.scrCoords[2]=b(d[0]*e[2]-d[2]*c.unitY)):(this.scrCoords[0]=d[0],this.scrCoords[1]=d[0]*e[1]+d[1]*c.unitX,this.scrCoords[2]=d[0]*e[2]-d[2]*c.unitY)},screen2usr:function(){var a=this.board.origin.scrCoords,b=this.scrCoords,c=this.board;this.usrCoords[0]=1,this.usrCoords[1]=(b[1]-a[1])/c.unitX,this.usrCoords[2]=(a[2]-b[2])/c.unitY},distance:function(a,b){var d,g,c=0,e=this.usrCoords,f=this.scrCoords;if(a===JXG.COORDS_BY_USER){if(d=b.usrCoords,g=e[0]-d[0],c=g*g,c>JXG.Math.eps)return Number.POSITIVE_INFINITY;g=e[1]-d[1],c+=g*g,g=e[2]-d[2],c+=g*g}else d=b.scrCoords,g=f[1]-d[1],c+=g*g,g=f[2]-d[2],c+=g*g;return Math.sqrt(c)},setCoordinates:function(a,b,c){var d=this.usrCoords,e=this.scrCoords;return a===JXG.COORDS_BY_USER?(2===b.length?(d[0]=1,d[1]=b[0],d[2]=b[1]):(d[0]=b[0],d[1]=b[1],d[2]=b[2],this.normalizeUsrCoords()),this.usr2screen(c)):(e[1]=b[0],e[2]=b[1],this.screen2usr()),this}}),JXG.Point=function(a,b,c){this.constructor(a,c,JXG.OBJECT_TYPE_POINT,JXG.OBJECT_CLASS_POINT),null==b&&(b=[0,0]),this.coords=new JXG.Coords(JXG.COORDS_BY_USER,b,this.board),this.initialCoords=new JXG.Coords(JXG.COORDS_BY_USER,b,this.board),this.position=null,this.onPolygon=!1,this.slideObject=null,this.Xjc=null,this.Yjc=null,this.methodMap=JXG.deepCopy(this.methodMap,{move:"moveTo",glide:"makeGlider",X:"X",Y:"Y",free:"free",setPosition:"setGliderPosition"}),this.group=[],this.elType="point",this.id=this.board.setId(this,"P"),this.board.renderer.drawPoint(this),this.board.finalizeAdding(this),this.createLabel()},JXG.Point.prototype=new JXG.GeometryElement,JXG.extend(JXG.Point.prototype,{hasPoint:function(a,b){var d,c=this.coords.scrCoords;return d=parseFloat(this.visProp.size)+.5*parseFloat(this.visProp.strokewidth),d<this.board.options.precision.hasPoint&&(d=this.board.options.precision.hasPoint),Math.abs(c[1]-a)<d+2&&Math.abs(c[2]-b)<d+2},updateConstraint:function(){return this},update:function(a){return this.needsUpdate?("undefined"==typeof a&&(a=!1),this.type==JXG.OBJECT_TYPE_GLIDER&&(a?this.updateGliderFromParent():this.updateGlider()),(this.type==JXG.OBJECT_TYPE_CAS||this.type==JXG.OBJECT_TYPE_AXISPOINT)&&this.updateConstraint(),this.updateTransform(),this.visProp.trace&&this.cloneToBackground(!0),this):this},updateGlider:function(){var a,b,c,d,e,f,g,h,i,k,l,m,j=this.slideObject;if(j.elementClass==JXG.OBJECT_CLASS_CIRCLE)this.coords=JXG.Math.Geometry.projectPointToCircle(this,j,this.board),this.position=JXG.Math.Geometry.rad([j.center.X()+1,j.center.Y()],j.center,this);else if(j.elementClass==JXG.OBJECT_CLASS_LINE){if(this.onPolygon)if(b=j.point1.coords.usrCoords,c=j.point2.coords.usrCoords,a=1,d=c[a]-b[a],Math.abs(d)<JXG.Math.eps&&(a=2,d=c[a]-b[a]),g=JXG.Math.Geometry.projectPointToLine(this,j,this.board),h=(g.usrCoords[a]-b[a])/d,f=j.parentPolygon,0>h){for(a=0;a<f.borders.length;a++)if(j==f.borders[a]){j=f.borders[(a-1+f.borders.length)%f.borders.length];break}}else if(h>1)for(a=0;a<f.borders.length;a++)if(j==f.borders[a]){j=f.borders[(a+1+f.borders.length)%f.borders.length];break}b=j.point1.coords,c=j.point2.coords,d=b.distance(JXG.COORDS_BY_USER,c),b=b.usrCoords.slice(0),c=c.usrCoords.slice(0),d<JXG.Math.eps?(this.coords.setCoordinates(JXG.COORDS_BY_USER,b),this.position=0):(this.coords=JXG.Math.Geometry.projectPointToLine(this,j,this.board),Math.abs(c[0])<JXG.Math.eps?(a=1,d=c[a],Math.abs(d)<JXG.Math.eps&&(a=2,d=c[a]),d=(this.coords.usrCoords[a]-b[a])/d,i=d>=0?1:-1,d=Math.abs(d),this.position=i*d/(d+1)):Math.abs(b[0])<JXG.Math.eps?(a=1,d=b[a],Math.abs(d)<JXG.Math.eps&&(a=2,d=b[a]),d=(this.coords.usrCoords[a]-c[a])/d,this.position=0>d?(1-2*d)/(1-d):1/(d+1)):(a=1,d=c[a]-b[a],Math.abs(d)<JXG.Math.eps&&(a=2,d=c[a]-b[a]),this.position=(this.coords.usrCoords[a]-b[a])/d)),this.visProp.snapwidth>0&&Math.abs(this._smax-this._smin)>=JXG.Math.eps&&(this.position<0&&(this.position=0),this.position>1&&(this.position=1),e=this.position*(this._smax-this._smin)+this._smin,e=Math.round(e/this.visProp.snapwidth)*this.visProp.snapwidth,this.position=(e-this._smin)/(this._smax-this._smin),this.update(!0)),b=j.point1.coords.usrCoords,!j.visProp.straightfirst&&Math.abs(b[0])>JXG.Math.eps&&this.position<0&&(this.coords.setCoordinates(JXG.COORDS_BY_USER,b),this.position=0),c=j.point2.coords.usrCoords,!j.visProp.straightlast&&Math.abs(c[0])>JXG.Math.eps&&this.position>1&&(this.coords.setCoordinates(JXG.COORDS_BY_USER,c),this.position=1)}else j.type==JXG.OBJECT_TYPE_TURTLE?(this.updateConstraint(),this.coords=JXG.Math.Geometry.projectPointToTurtle(this,j,this.board)):j.elementClass==JXG.OBJECT_CLASS_CURVE?j.type==JXG.OBJECT_TYPE_ARC||j.type==JXG.OBJECT_TYPE_SECTOR?(this.coords=JXG.Math.Geometry.projectPointToCircle(this,j,this.board),m=JXG.Math.Geometry.rad(j.radiuspoint,j.center,this),k=0,l=JXG.Math.Geometry.rad(j.radiuspoint,j.center,j.anglepoint),this.position=m,("minor"==j.visProp.type&&l>Math.PI||"major"==j.visProp.type&&l<Math.PI)&&(k=l,l=2*Math.PI),(k>m||m>l)&&(this.position=l,(k>m&&m>.5*k||m>l&&m>.5*l+Math.PI)&&(this.position=k),this.updateGliderFromParent())):(this.updateConstraint(),this.coords=JXG.Math.Geometry.projectPointToCurve(this,j,this.board)):j.elementClass==JXG.OBJECT_CLASS_POINT&&(this.coords=JXG.Math.Geometry.projectPointToPoint(this,j,this.board))},updateGliderFromParent:function(){var a,b,c,d,f,e=this.slideObject;e.elementClass==JXG.OBJECT_CLASS_CIRCLE?(c=e.Radius(),this.coords.setCoordinates(JXG.COORDS_BY_USER,[e.center.X()+c*Math.cos(this.position),e.center.Y()+c*Math.sin(this.position)])):e.elementClass==JXG.OBJECT_CLASS_LINE?(a=e.point1.coords.usrCoords,b=e.point2.coords.usrCoords,Math.abs(b[0])<JXG.Math.eps?(d=Math.min(Math.abs(this.position),1-JXG.Math.eps),d/=1-d,this.position<0&&(d*=-1),this.coords.setCoordinates(JXG.COORDS_BY_USER,[a[0]+d*b[0],a[1]+d*b[1],a[2]+d*b[2]])):Math.abs(a[0])<JXG.Math.eps?(d=Math.max(this.position,JXG.Math.eps),d=Math.min(d,2-JXG.Math.eps),d=d>1?(d-1)/(d-2):(1-d)/d,this.coords.setCoordinates(JXG.COORDS_BY_USER,[b[0]+d*a[0],b[1]+d*a[1],b[2]+d*a[2]])):(d=this.position,this.coords.setCoordinates(JXG.COORDS_BY_USER,[a[0]+d*(b[0]-a[0]),a[1]+d*(b[1]-a[1]),a[2]+d*(b[2]-a[2])]))):e.type==JXG.OBJECT_TYPE_TURTLE?(this.coords.setCoordinates(JXG.COORDS_BY_USER,[e.Z(this.position),e.X(this.position),e.Y(this.position)]),this.updateConstraint(),this.coords=JXG.Math.Geometry.projectPointToTurtle(this,e,this.board)):e.elementClass==JXG.OBJECT_CLASS_CURVE?(this.coords.setCoordinates(JXG.COORDS_BY_USER,[e.Z(this.position),e.X(this.position),e.Y(this.position)]),e.type==JXG.OBJECT_TYPE_ARC||e.type==JXG.OBJECT_TYPE_SECTOR?(f=JXG.Math.Geometry.rad([e.center.X()+1,e.center.Y()],e.center,e.radiuspoint),c=e.Radius(),this.coords.setCoordinates(JXG.COORDS_BY_USER,[e.center.X()+c*Math.cos(this.position+f),e.center.Y()+c*Math.sin(this.position+f)])):(this.updateConstraint(),this.coords=JXG.Math.Geometry.projectPointToCurve(this,e,this.board))):e.elementClass==JXG.OBJECT_CLASS_POINT&&(this.coords=JXG.Math.Geometry.projectPointToPoint(this,e,this.board))},updateRenderer:function(){if(!this.needsUpdate)return this;if(this.visProp.visible&&this.visProp.size>0){var a=this.isReal;this.isReal=!isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]),this.isReal=Math.abs(this.coords.usrCoords[0])>JXG.Math.eps?this.isReal:!1,this.isReal?(a!=this.isReal&&(this.board.renderer.show(this),this.hasLabel&&this.label.content.visProp.visible&&this.board.renderer.show(this.label.content)),this.board.renderer.updatePoint(this)):a!=this.isReal&&(this.board.renderer.hide(this),this.hasLabel&&this.label.content.visProp.visible&&this.board.renderer.hide(this.label.content))}return this.hasLabel&&this.visProp.visible&&this.label.content&&this.label.content.visProp.visible&&this.isReal&&(this.label.content.update(),this.board.renderer.updateText(this.label.content)),this.needsUpdate=!1,this},X:function(){return this.coords.usrCoords[1]},Y:function(){return this.coords.usrCoords[2]},Z:function(){return this.coords.usrCoords[0]},XEval:function(){return this.coords.usrCoords[1]},YEval:function(){return this.coords.usrCoords[2]},ZEval:function(){return this.coords.usrCoords[0]},bounds:function(){return this.coords.usrCoords.slice(1).concat(this.coords.usrCoords.slice(1))},Dist:function(a){var b,e,c=a.coords.usrCoords,d=this.coords.usrCoords;return e=d[0]-c[0],b=e*e,e=d[1]-c[1],b+=e*e,e=d[2]-c[2],b+=e*e,Math.sqrt(b)},snapToGrid:function(){return this.handleSnapToGrid()},handleSnapToGrid:function(){var a,b,c=this.visProp.snapsizex,d=this.visProp.snapsizey;return this.visProp.snaptogrid&&(a=this.coords.usrCoords[1],b=this.coords.usrCoords[2],0>=c&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(c=this.board.defaultAxes.x.defaultTicks.ticksDelta*(this.board.defaultAxes.x.defaultTicks.visProp.minorticks+1)),0>=d&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(d=this.board.defaultAxes.y.defaultTicks.ticksDelta*(this.board.defaultAxes.y.defaultTicks.visProp.minorticks+1)),c>0&&d>0&&(this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[Math.round(a/c)*c,Math.round(b/d)*d],this.board))),this},handleSnapToPoints:function(){var a,b,c,d=0,e=1/0,f=null;if(this.visProp.snaptopoints){for(a in this.board.objects)b=this.board.objects[a],b.elementClass==JXG.OBJECT_CLASS_POINT&&b!==this&&b.visProp.visible&&(c=JXG.Math.Geometry.projectPointToPoint(this,b,this.board),d=c.distance(JXG.COORDS_BY_USER,this.coords),d<this.visProp.attractordistance&&e>d&&(e=d,f=c));null!=f&&this.coords.setCoordinates(JXG.COORDS_BY_USER,f.usrCoords)}return this},handleAttractors:function(){var b,c,d,a=this.visProp.attractors.length,e=0;if(0!=this.visProp.attractordistance){for(b=0;a>b;b++)if(c=JXG.getRef(this.board,this.visProp.attractors[b]),JXG.exists(c)&&c!==this){if(c.elementClass==JXG.OBJECT_CLASS_POINT?d=JXG.Math.Geometry.projectPointToPoint(this,c,this.board):c.elementClass==JXG.OBJECT_CLASS_LINE?d=JXG.Math.Geometry.projectPointToLine(this,c,this.board):c.elementClass==JXG.OBJECT_CLASS_CIRCLE?d=JXG.Math.Geometry.projectPointToCircle(this,c,this.board):c.elementClass==JXG.OBJECT_CLASS_CURVE?d=JXG.Math.Geometry.projectPointToCurve(this,c,this.board):c.type==JXG.OBJECT_TYPE_TURTLE&&(d=JXG.Math.Geometry.projectPointToTurtle(this,c,this.board)),e=d.distance(JXG.COORDS_BY_USER,this.coords),e<this.visProp.attractordistance){found=!0,(this.type!=JXG.OBJECT_TYPE_GLIDER||this.slideObject!=c)&&this.makeGlider(c);break}c==this.slideObject&&e>=this.visProp.snatchdistance&&(this.type=JXG.OBJECT_TYPE_POINT)}return this}},setPositionDirectly:function(a,b){var c,d,e,f,g,h,j,i=this.coords;if(this.coords=new JXG.Coords(a,b,this.board),this.handleSnapToGrid(),this.handleSnapToPoints(),this.handleAttractors(),0!=this.group.length){for(d=this.coords.usrCoords[1]-i.usrCoords[1],e=this.coords.usrCoords[2]-i.usrCoords[2],f=this.coords.usrCoords[0]=i.usrCoords[0],c=0;c<this.group.length;c++)for(g in this.group[c].objects)h=this.group[c].objects[g],h.initialCoords=new JXG.Coords(JXG.COORDS_BY_USER,[h.initialCoords.usrCoords[0]+f,h.initialCoords.usrCoords[1]+d,h.initialCoords.usrCoords[2]+e],this.board);this.group[this.group.length-1].dX=d,this.group[this.group.length-1].dY=e,this.group[this.group.length-1].dZ=f,this.group[this.group.length-1].update(this)}else{for(c=this.transformations.length-1;c>=0;c--)a===JXG.COORDS_BY_SCREEN?j=new JXG.Coords(a,b,this.board).usrCoords:(2===b.length&&(b=[1].concat(b)),j=b),this.initialCoords=new JXG.Coords(JXG.COORDS_BY_USER,JXG.Math.matVecMult(JXG.Math.inverse(this.transformations[c].matrix),j),this.board);this.update()}return this},setPositionByTransform:function(a,b){var c;return b=new JXG.Coords(a,b,this.board),c=this.board.create("transform",b.usrCoords.slice(1),{type:"translate"}),this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(c):this.addTransform(this,c),0==this.group.length&&this.update(),this},setPosition:function(a,b){return this.setPositionDirectly(a,b)},setGliderPosition:function(a){return(this.type=JXG.OBJECT_TYPE_GLIDER)&&(this.position=a,this.board.update()),this},makeGlider:function(a){return this.slideObject=JXG.getRef(this.board,a),this.type=JXG.OBJECT_TYPE_GLIDER,this.elType="glider",this.visProp.snapwidth=-1,this.slideObject.addChild(this),this.isDraggable=!0,this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)
},this.updateGlider(),this},free:function(){var a;if(this.type!==JXG.OBJECT_TYPE_GLIDER){if(this.isDraggable)return;this.isDraggable=!0,this.type=JXG.OBJECT_TYPE_POINT,this.XEval=function(){return this.coords.usrCoords[1]},this.YEval=function(){return this.coords.usrCoords[2]},this.ZEval=function(){return this.coords.usrCoords[0]},this.Xjc=null,this.Yjc=null}for(a in this.ancestors)delete this.ancestors[a].descendants[this.id],delete this.ancestors[a].childElements[this.id];this.ancestors=[],this.slideObject=null,this.elType="point",this.type=JXG.OBJECT_TYPE_POINT},addConstraint:function(a){this.type=JXG.OBJECT_TYPE_CAS;var c,d,e,b=[],g=["X","Y"];for(this.isDraggable=!1,d=0;d<a.length;d++)e=a[d],"string"==typeof e?(b[d]=this.board.jc.snippet(e,!0,null,!0),2===a.length&&(this[g[d]+"jc"]=a[d])):"function"==typeof e?b[d]=e:"number"==typeof e?b[d]=function(a){return function(){return a}}(e):"object"==typeof e&&"function"==typeof e.Value&&(b[d]=function(a){return function(){return a.Value()}}(e)),b[d].origin=e;return 1==a.length?this.updateConstraint=function(){var a=b[0]();JXG.isArray(a)?this.coords.setCoordinates(JXG.COORDS_BY_USER,a):this.coords=a}:2==a.length?(this.XEval=b[0],this.YEval=b[1],c="this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.XEval(),this.YEval()]);",this.updateConstraint=new Function("",c)):(this.ZEval=b[0],this.XEval=b[1],this.YEval=b[2],c="this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()]);",this.updateConstraint=new Function("",c)),this.board.isSuspendedUpdate||this.prepareUpdate().update().updateRenderer(),this},updateTransform:function(){if(0==this.transformations.length||null==this.baseElement)return this;var a,b;for(a=this===this.baseElement?this.transformations[0].apply(this.baseElement,"self"):this.transformations[0].apply(this.baseElement),this.coords.setCoordinates(JXG.COORDS_BY_USER,a),b=1;b<this.transformations.length;b++)this.coords.setCoordinates(JXG.COORDS_BY_USER,this.transformations[b].apply(this));return this},addTransform:function(a,b){var c,d=JXG.isArray(b)?b:[b],e=d.length;for(0===this.transformations.length&&(this.baseElement=a),c=0;e>c;c++)this.transformations.push(d[c]);return this},startAnimation:function(a,b){return this.type==JXG.OBJECT_TYPE_GLIDER&&"undefined"==typeof this.intervalCode&&(this.intervalCode=window.setInterval("JXG.JSXGraph.boards['"+this.board.id+"'].objects['"+this.id+"']._anim("+a+", "+b+")",250),"undefined"==typeof this.intervalCount&&(this.intervalCount=0)),this},stopAnimation:function(){return"undefined"!=typeof this.intervalCode&&(window.clearInterval(this.intervalCode),delete this.intervalCode),this},moveAlong:function(a,b,c){c=c||{};var h,i,d=[],e=this.board.options.animationDelay,f=function(b,c){return function(){return a[b][c]}},g=[],j=b/e;if(JXG.isArray(a)){for(h=0;h<a.length;h++)g[h]=JXG.isPoint(a[h])?a[h]:{elementClass:JXG.OBJECT_CLASS_POINT,X:f(h,0),Y:f(h,1)};if(b=b||0,0===b)return this.setPosition(JXG.COORDS_BY_USER,[g[g.length-1].X(),g[g.length-1].Y()]),this.board.update(this);for(i=JXG.Math.Numerics.Neville(g),h=0;j>h;h++)d[h]=[],d[h][0]=i[0]((j-h)/j*i[3]()),d[h][1]=i[1]((j-h)/j*i[3]());this.animationPath=d}else JXG.isFunction(a)&&(this.animationPath=a,this.animationStart=(new Date).getTime());return this.animationCallback=c.callback,this.board.addAnimation(this),this},moveTo:function(a,b,c){if(a=new JXG.Coords(JXG.COORDS_BY_USER,a,this.board),"undefined"==typeof b||0==b||Math.abs(a.usrCoords[0]-this.coords.usrCoords[0])>JXG.Math.eps)return this.setPosition(JXG.COORDS_BY_USER,a.usrCoords),this.board.update(this);c=c||{};var k,d=this.board.options.animationDelay,e=Math.ceil(b/(1*d)),f=new Array(e+1),g=this.coords.usrCoords[1],h=this.coords.usrCoords[2],i=a.usrCoords[1]-g,j=a.usrCoords[2]-h,l=function(a){return c.effect&&"<>"==c.effect?Math.pow(Math.sin(a/(1*e)*Math.PI/2),2):a/e};if(Math.abs(i)<JXG.Math.eps&&Math.abs(j)<JXG.Math.eps)return this;for(k=e;k>=0;k--)f[e-k]=[a.usrCoords[0],g+i*l(k),h+j*l(k)];return this.animationPath=f,this.animationCallback=c.callback,this.board.addAnimation(this),this},visit:function(a,b,c){"number"==typeof c?c={repeat:c}:(c=c||{},"undefined"==typeof c.repeat&&(c.repeat=1));var k,l,d=this.board.options.animationDelay,e=Math.ceil(b/(d*c.repeat)),f=new Array(c.repeat*(e+1)),g=this.coords.usrCoords[1],h=this.coords.usrCoords[2],i=a[0]-g,j=a[1]-h,m=function(a){var b=e/2>a?2*a/e:2*(e-a)/e;return c.effect&&"<>"==c.effect?Math.pow(Math.sin(b*Math.PI/2),2):b};for(l=0;l<c.repeat;l++)for(k=e;k>=0;k--)f[l*(e+1)+e-k]=[a[0],g+i*m(k),h+j*m(k)];return this.animationPath=f,this.animationCallback=c.callback,this.board.addAnimation(this),this},_anim:function(a,b){var c,d,e,f,g,h,j,k,i=1;return this.intervalCount++,this.intervalCount>b&&(this.intervalCount=0),this.slideObject.elementClass==JXG.OBJECT_CLASS_LINE?(c=this.slideObject.point1.coords.distance(JXG.COORDS_BY_SCREEN,this.slideObject.point2.coords),d=this.slideObject.getSlope(),"INF"!=d?(g=Math.atan(d),e=Math.round(this.intervalCount/b*c*Math.cos(g)),f=Math.round(this.intervalCount/b*c*Math.sin(g))):(e=0,f=Math.round(this.intervalCount/b*c)),0>a?(h=this.slideObject.point2,this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]>0?i=-1:0==this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]&&this.slideObject.point2.coords.scrCoords[2]-this.slideObject.point1.coords.scrCoords[2]>0&&(i=-1)):(h=this.slideObject.point1,this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]>0?i=-1:0==this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]&&this.slideObject.point1.coords.scrCoords[2]-this.slideObject.point2.coords.scrCoords[2]>0&&(i=-1)),this.coords.setCoordinates(JXG.COORDS_BY_SCREEN,[h.coords.scrCoords[1]+i*e,h.coords.scrCoords[2]+i*f])):this.slideObject.elementClass==JXG.OBJECT_CLASS_CURVE?(j=a>0?Math.round(this.intervalCount/b*this.board.canvasWidth):Math.round((b-this.intervalCount)/b*this.board.canvasWidth),this.coords.setCoordinates(JXG.COORDS_BY_SCREEN,[j,0]),this.coords=JXG.Math.Geometry.projectPointToCurve(this,this.slideObject,this.board)):this.slideObject.elementClass==JXG.OBJECT_CLASS_CIRCLE&&(g=0>a?2*(this.intervalCount/b)*Math.PI:2*((b-this.intervalCount)/b)*Math.PI,k=this.slideObject.Radius(),this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.slideObject.center.coords.usrCoords[1]+k*Math.cos(g),this.slideObject.center.coords.usrCoords[2]+k*Math.sin(g)])),this.board.update(this),this},setStyle:function(a){var b=["cross","cross","cross","circle","circle","circle","circle","square","square","square","plus","plus","plus"],c=[2,3,4,1,2,3,4,2,3,4,2,3,4];return this.visProp.face=b[a],this.visProp.size=c[a],this.board.renderer.changePointStyle(this),this},normalizeFace:function(a){var b={cross:"x",x:"x",circle:"o",o:"o",square:"[]","[]":"[]",plus:"+","+":"+",diamond:"<>","<>":"<>",triangleup:"^",a:"^","^":"^",monosigned:"-","-":"-",triangleleft:"<","<":"<",triangleright:">",">":">",monosignedleft:"-<","-<":"-<",doublesignedright:"-->","-->":"-->",doublesignedleft:"--<","--<":"--<",monosignedright:"->","->":"->"};return b[a]},remove:function(){this.hasLabel&&this.board.renderer.remove(this.board.renderer.getElementById(this.label.content.id)),this.board.renderer.remove(this.board.renderer.getElementById(this.id))},getTextAnchor:function(){return this.coords},getLabelAnchor:function(){return this.coords},face:function(a){this.setProperty({face:a})},size:function(a){this.setProperty({size:a})},cloneToBackground:function(){var a={};return a.id=this.id+"T"+this.numTraces,this.numTraces++,a.coords=this.coords,a.visProp=JXG.deepCopy(this.visProp,this.visProp.traceattributes,!0),a.visProp.layer=this.board.options.layer.trace,a.elementClass=JXG.OBJECT_CLASS_POINT,a.board=this.board,JXG.clearVisPropOld(a),this.board.renderer.drawPoint(a),this.traces[a.id]=a.rendNode,this},getParents:function(){var a=[this.Z(),this.X(),this.Y()];return this.parents&&(a=this.parents),this.type==JXG.OBJECT_TYPE_GLIDER&&(a=[this.X(),this.Y(),this.slideObject.id]),a}}),JXG.createPoint=function(a,b,c){var d,f,g,e=!1;for(g=JXG.copyAttributes(c,a.options,"point"),f=0;f<b.length;f++)("function"==typeof b[f]||"string"==typeof b[f])&&(e=!0);if(e)d=new JXG.Point(a,[0/0,0/0],g),d.addConstraint(b);else if(JXG.isNumber(b[0])&&JXG.isNumber(b[1]))d=new JXG.Point(a,b,g),JXG.exists(g.slideobject)?d.makeGlider(g.slideobject):d.baseElement=d,d.isDraggable=!0;else{if("object"!=typeof b[0]||"object"!=typeof b[1])throw new Error("JSXGraph: Can't create point with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [x,y], [z,x,y], [point,transformation]");d=new JXG.Point(a,[0,0],g),d.addTransform(b[0],b[1]),d.isDraggable=!1,d.parents=[b[0].id,b[1].id]}return d},JXG.createGlider=function(a,b,c){var d,e=JXG.copyAttributes(c,a.options,"glider");return d=1===b.length?a.create("point",[0,0],e):a.create("point",b.slice(0,2),e),d.makeGlider(b[b.length-1]),d},JXG.createIntersectionPoint=function(a,b,c){var d;b.push(0,0),d=a.create("point",[a.intersection(b[0],b[1],b[2],b[3])],c);try{b[0].addChild(d),b[1].addChild(d)}catch(e){throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.")}return d.elType="intersection",d.parents=[b[0].id,b[1].id,b[2]],null!=b[3]&&d.parents.push(b[3]),d.generatePolynomial=function(){var a=b[0].generatePolynomial(d),c=b[1].generatePolynomial(d);return 0==a.length||0==c.length?[]:[a[0],c[0]]},d},JXG.createOtherIntersectionPoint=function(a,b,c){var d;if(3!=b.length||!JXG.isPoint(b[2])||b[0].elementClass!=JXG.OBJECT_CLASS_LINE&&b[0].elementClass!=JXG.OBJECT_CLASS_CIRCLE||b[1].elementClass!=JXG.OBJECT_CLASS_LINE&&b[1].elementClass!=JXG.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'other intersection point' with parent types '"+typeof b[0]+"',  '"+typeof b[1]+"'and  '"+typeof b[2]+"'.\nPossible parent types: [circle|line,circle|line,point]");return d=a.create("point",[a.otherIntersection(b[0],b[1],b[2])],c),d.elType="otherintersection",d.parents=[b[0].id,b[1].id,b[2]],b[0].addChild(d),b[1].addChild(d),d.generatePolynomial=function(){var a=b[0].generatePolynomial(d),c=b[1].generatePolynomial(d);return 0==a.length||0==c.length?[]:[a[0],c[0]]},d},JXG.JSXGraph.registerElement("point",JXG.createPoint),JXG.JSXGraph.registerElement("glider",JXG.createGlider),JXG.JSXGraph.registerElement("intersection",JXG.createIntersectionPoint),JXG.JSXGraph.registerElement("otherintersection",JXG.createOtherIntersectionPoint),JXG.Line=function(a,b,c,d){this.constructor(a,d,JXG.OBJECT_TYPE_LINE,JXG.OBJECT_CLASS_LINE),this.point1=JXG.getReference(this.board,b),this.point2=JXG.getReference(this.board,c),this.ticks=[],this.defaultTicks=null,this.parentPolygon=null,this.id=this.board.setId(this,"L"),this.board.renderer.drawLine(this),this.board.finalizeAdding(this),this.elType="line",this.createLabel(),this.point1.addChild(this),this.point2.addChild(this),this.updateStdform()},JXG.Line.prototype=new JXG.GeometryElement,JXG.extend(JXG.Line.prototype,{hasPoint:function(a,b){var d,f,g,h,i,j,k,c=[],e=[1,a,b];return c[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/this.board.unitX+this.stdform[2]*this.board.origin.scrCoords[2]/this.board.unitY,c[1]=this.stdform[1]/this.board.unitX,c[2]=this.stdform[2]/-this.board.unitY,f=[0,c[1],c[2]],f=JXG.Math.crossProduct(f,e),f=JXG.Math.crossProduct(f,c),f[1]/=f[0],f[2]/=f[0],f[0]=1,d=(e[1]-f[1])*(e[1]-f[1])+(e[2]-f[2])*(e[2]-f[2]),isNaN(d)||d>this.board.options.precision.hasPoint*this.board.options.precision.hasPoint?!1:this.visProp.straightfirst&&this.visProp.straightlast?!0:(g=this.point1.coords,h=this.point2.coords,f=new JXG.Coords(JXG.COORDS_BY_SCREEN,f.slice(1),this.board).usrCoords,i=g.distance(JXG.COORDS_BY_USER,h),g=g.usrCoords.slice(0),h=h.usrCoords.slice(0),i<JXG.Math.eps?j=0:(i==Number.POSITIVE_INFINITY&&(i=1/JXG.Math.eps,Math.abs(h[0])<JXG.Math.eps?(i/=JXG.Math.Geometry.distance([0,0,0],h),h=[1,g[1]+h[1]*i,g[2]+h[2]*i]):(i/=JXG.Math.Geometry.distance([0,0,0],g),g=[1,h[1]+g[1]*i,h[2]+g[2]*i])),k=1,i=h[k]-g[k],Math.abs(i)<JXG.Math.eps&&(k=2,i=h[k]-g[k]),j=(f[k]-g[k])/i),!this.visProp.straightfirst&&0>j?!1:!this.visProp.straightlast&&j>1?!1:!0)},update:function(){var a;return this.needsUpdate?(this.constrained&&("undefined"!=typeof this.funps?(a=this.funps(),a&&a.length&&2===a.length&&(this.point1=a[0],this.point2=a[1])):("function"==typeof this.funp1&&(a=this.funp1(),JXG.isPoint(a)?this.point1=a:a&&a.length&&2===a.length&&this.point1.setPositionDirectly(JXG.COORDS_BY_USER,a)),"function"==typeof this.funp2&&(a=this.funp2(),JXG.isPoint(a)?this.point2=a:a&&a.length&&2===a.length&&this.point2.setPositionDirectly(JXG.COORDS_BY_USER,a)))),this.updateSegmentFixedLength(),this.updateStdform(),this.visProp.trace&&this.cloneToBackground(!0),this):this},updateSegmentFixedLength:function(){var a,b,c,d,e,f,g,h;return this.hasFixedLength?(a=this.point1.Dist(this.point2),b=this.fixedLength(),c=this.fixedLengthOldCoords[0].distance(JXG.COORDS_BY_USER,this.point1.coords),d=this.fixedLengthOldCoords[1].distance(JXG.COORDS_BY_USER,this.point2.coords),(c>JXG.Math.eps||d>JXG.Math.eps||a!=b)&&(e=this.point1.isDraggable&&this.point1.type!=JXG.OBJECT_TYPE_GLIDER&&!this.point1.visProp.fixed,f=this.point2.isDraggable&&this.point2.type!=JXG.OBJECT_TYPE_GLIDER&&!this.point2.visProp.fixed,a>JXG.Math.eps?c>d&&f||d>=c&&f&&!e?(this.point2.setPositionDirectly(JXG.COORDS_BY_USER,[this.point1.X()+(this.point2.X()-this.point1.X())*b/a,this.point1.Y()+(this.point2.Y()-this.point1.Y())*b/a]),this.point2.prepareUpdate().updateRenderer()):(d>=c&&e||c>d&&e&&!f)&&(this.point1.setPositionDirectly(JXG.COORDS_BY_USER,[this.point2.X()+(this.point1.X()-this.point2.X())*b/a,this.point2.Y()+(this.point1.Y()-this.point2.Y())*b/a]),this.point1.prepareUpdate().updateRenderer()):(g=Math.random()-.5,h=Math.random()-.5,a=Math.sqrt(g*g+h*h),f?(this.point2.setPositionDirectly(JXG.COORDS_BY_USER,[this.point1.X()+g*b/a,this.point1.Y()+h*b/a]),this.point2.prepareUpdate().updateRenderer()):e&&(this.point1.setPositionDirectly(JXG.COORDS_BY_USER,[this.point2.X()+g*b/a,this.point2.Y()+h*b/a]),this.point1.prepareUpdate().updateRenderer())),this.fixedLengthOldCoords[0].setCoordinates(JXG.COORDS_BY_USER,this.point1.coords.usrCoords),this.fixedLengthOldCoords[1].setCoordinates(JXG.COORDS_BY_USER,this.point2.coords.usrCoords)),this):this},updateStdform:function(){var a=JXG.Math.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=a[0],this.stdform[1]=a[1],this.stdform[2]=a[2],this.stdform[3]=0,this.normalize()},updateRenderer:function(){var a;return this.needsUpdate&&this.visProp.visible&&(a=this.isReal,this.isReal=!isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2])&&JXG.Math.innerProduct(this.stdform,this.stdform,3)>=JXG.Math.eps*JXG.Math.eps,this.isReal?(a!=this.isReal&&(this.board.renderer.show(this),this.hasLabel&&this.label.content.visProp.visible&&this.board.renderer.show(this.label.content)),this.board.renderer.updateLine(this)):a!=this.isReal&&(this.board.renderer.hide(this),this.hasLabel&&this.label.content.visProp.visible&&this.board.renderer.hide(this.label.content)),this.needsUpdate=!1),this.hasLabel&&this.label.content.visProp.visible&&this.isReal&&(this.label.content.update(),this.board.renderer.updateText(this.label.content)),this},generatePolynomial:function(a){var b=this.point1.symbolic.x,c=this.point1.symbolic.y,d=this.point2.symbolic.x,e=this.point2.symbolic.y,f=a.symbolic.x,g=a.symbolic.y;return[["(",c,")*(",f,")-(",c,")*(",d,")+(",g,")*(",d,")-(",b,")*(",g,")+(",b,")*(",e,")-(",f,")*(",e,")"].join("")]},getRise:function(){return Math.abs(this.stdform[2])>=JXG.Math.eps?-this.stdform[0]/this.stdform[2]:1/0},getSlope:function(){return Math.abs(this.stdform[2])>=JXG.Math.eps?-this.stdform[1]/this.stdform[2]:1/0},getAngle:function(){return Math.atan2(this.point2.Y()-this.point1.Y(),this.point2.X()-this.point1.X())},setStraight:function(a,b){return this.visProp.straightfirst=a,this.visProp.straightlast=b,this.board.renderer.updateLine(this),this},getTextAnchor:function(){return new JXG.Coords(JXG.COORDS_BY_USER,[.5*(this.point2.X()+this.point1.X()),.5*(this.point2.Y()+this.point1.Y())],this.board)},setLabelRelativeCoords:function(a){JXG.exists(this.label.content)&&(this.label.content.relativeCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a[0],-a[1]],this.board))},getLabelAnchor:function(){var a,b,c=0,d=0,e=0,f=new JXG.Coords(JXG.COORDS_BY_USER,this.point1.coords.usrCoords,this.board),g=new JXG.Coords(JXG.COORDS_BY_USER,this.point2.coords.usrCoords,this.board);switch((this.visProp.straightfirst||this.visProp.straightlast)&&JXG.Math.Geometry.calcStraight(this,f,g,0),f=f.scrCoords,g=g.scrCoords,this.label.content.visProp.position){case"lft":case"llft":case"ulft":f[1]<=g[1]?(a=f[1],b=f[2]):(a=g[1],b=g[2]);break;case"rt":case"lrt":case"urt":f[1]>g[1]?(a=f[1],b=f[2]):(a=g[1],b=g[2]);break;default:a=.5*(f[1]+g[1]),b=.5*(f[2]+g[2])}return(this.visProp.straightfirst||this.visProp.straightlast)&&(JXG.exists(this.label.content)&&(d=parseFloat(this.label.content.visProp.offset[0]),e=parseFloat(this.label.content.visProp.offset[1]),c=this.label.content.visProp.fontsize),Math.abs(a)<JXG.Math.eps?a=d:this.board.canvasWidth+JXG.Math.eps>a&&a>this.board.canvasWidth-c-JXG.Math.eps?a=this.board.canvasWidth-d-c:a+=d,JXG.Math.eps+c>b&&b>-JXG.Math.eps?b=e+c:this.board.canvasHeight+JXG.Math.eps>b&&b>this.board.canvasHeight-c-JXG.Math.eps?b=this.board.canvasHeight-e:b+=e),new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,b],this.board)},cloneToBackground:function(){var b,c,d,a={};return a.id=this.id+"T"+this.numTraces,a.elementClass=JXG.OBJECT_CLASS_LINE,this.numTraces++,a.point1=this.point1,a.point2=this.point2,a.stdform=this.stdform,a.board=this.board,a.visProp=JXG.deepCopy(this.visProp,this.visProp.traceattributes,!0),a.visProp.layer=this.board.options.layer.trace,JXG.clearVisPropOld(a),c=this.getSlope(),b=this.getRise(),a.getSlope=function(){return c},a.getRise=function(){return b},d=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawLine(a),this.board.renderer.enhancedRendering=d,this.traces[a.id]=a.rendNode,delete a,this},addTransform:function(a){var b,c=JXG.isArray(a)?a:[a],d=c.length;for(b=0;d>b;b++)this.point1.transformations.push(c[b]),this.point2.transformations.push(c[b]);return this},setPosition:function(a,b){var c;return b=new JXG.Coords(a,b,this.board),c=this.board.create("transform",b.usrCoords.slice(1),{type:"translate"}),this.point1.transformations.length>0&&this.point1.transformations[this.point1.transformations.length-1].isNumericMatrix?this.point1.transformations[this.point1.transformations.length-1].melt(c):this.point1.addTransform(this.point1,c),this.point2.transformations.length>0&&this.point2.transformations[this.point2.transformations.length-1].isNumericMatrix?this.point2.transformations[this.point2.transformations.length-1].melt(c):this.point2.addTransform(this.point2,c),this},setPositionDirectly:function(a,b,c){var d,e,f=new JXG.Coords(a,b,this.board),g=new JXG.Coords(a,c,this.board);return this.point1.draggable()&&this.point2.draggable()?(d=JXG.Math.Statistics.subtract(f.usrCoords,g.usrCoords),e=this.board.create("transform",d.slice(1),{type:"translate"}),e.applyOnce([this.point1,this.point2]),this):this},snapToGrid:function(){return this.visProp.snaptogrid&&(this.point1.snapToGrid(),this.point2.snapToGrid()),this},X:function(a){var c,b=this.stdform[2];return c=Math.abs(this.point1.coords.usrCoords[0])>JXG.Math.eps?this.point1.coords.usrCoords[1]:this.point2.coords.usrCoords[1],a=2*(a-.5),0>a?(a*=-1,(1-a)*c+a*b):(1-a)*c-a*b},Y:function(a){var c,b=this.stdform[1];return c=Math.abs(this.point1.coords.usrCoords[0])>JXG.Math.eps?this.point1.coords.usrCoords[2]:this.point2.coords.usrCoords[2],a=2*(a-.5),0>a?(a*=-1,(1-a)*c-a*b):(1-a)*c+a*b},Z:function(a){var b=Math.abs(this.point1.coords.usrCoords[0])>JXG.Math.eps?this.point1.coords.usrCoords[0]:this.point2.coords.usrCoords[0];return a=2*(a-.5),0>a&&(a*=-1),(1-a)*b},L:function(){return this.point1.Dist(this.point2)},minX:function(){return 0},maxX:function(){return 1},bounds:function(){var a=this.point1.coords.usrCoords,b=this.point2.coords.usrCoords;return[Math.min(a[1],b[1]),Math.max(a[2],b[2]),Math.max(a[1],b[1]),Math.min(a[2],b[2])]},addTicks:function(a){return(""==a.id||"undefined"==typeof a.id)&&(a.id=this.id+"_ticks_"+(this.ticks.length+1)),this.board.renderer.drawTicks(a),this.ticks.push(a),a.id},remove:function(){this.removeAllTicks(),JXG.GeometryElement.prototype.remove.call(this)},removeAllTicks:function(){var b;for(b=this.ticks.length;b>0;b--)this.removeTicks(this.ticks[b-1]);this.ticks=new Array,this.board.update()},removeTicks:function(a){var b,c;for(null!=this.defaultTicks&&this.defaultTicks==a&&(this.defaultTicks=null),b=this.ticks.length;b>0;b--)if(this.ticks[b-1]==a){for(this.board.removeObject(this.ticks[b-1]),c=0;c<this.ticks[b-1].ticks.length;c++)null!=this.ticks[b-1].labels[c]&&this.board.removeObject(this.ticks[b-1].labels[c]);delete this.ticks[b-1];break}},hideElement:function(){var a;for(JXG.GeometryElement.prototype.hideElement.call(this),a=0;a<this.ticks.length;a++)this.ticks[a].hideElement()},showElement:function(){var a;for(JXG.GeometryElement.prototype.showElement.call(this),a=0;a<this.ticks.length;a++)this.ticks[a].showElement()}}),JXG.createLine=function(a,b,c){var d,e,f,g,h,k,i=[],j=!1;if(2==b.length){if(JXG.isArray(b[0])&&b[0].length>1)h=JXG.copyAttributes(c,a.options,"line","point1"),e=a.create("point",b[0],h);else if(JXG.isString(b[0])||b[0].elementClass==JXG.OBJECT_CLASS_POINT)e=JXG.getReference(a,b[0]);else if("function"==typeof b[0]&&b[0]().elementClass==JXG.OBJECT_CLASS_POINT)e=b[0](),j=!0;else{if("function"!=typeof b[0]||!b[0]().length||2!==b[0]().length)throw new Error("JSXGraph: Can't create line with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");h=JXG.copyAttributes(c,a.options,"line","point1"),e=JXG.createPoint(a,b[0](),h),j=!0}if(JXG.isArray(b[1])&&b[1].length>1)h=JXG.copyAttributes(c,a.options,"line","point2"),f=a.create("point",b[1],h);else if(JXG.isString(b[1])||b[1].elementClass==JXG.OBJECT_CLASS_POINT)f=JXG.getReference(a,b[1]);else if("function"==typeof b[1]&&b[1]().elementClass==JXG.OBJECT_CLASS_POINT)f=b[1](),j=!0;else{if("function"!=typeof b[1]||!b[1]().length||2!==b[1]().length)throw new Error("JSXGraph: Can't create line with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");h=JXG.copyAttributes(c,a.options,"line","point2"),f=JXG.createPoint(a,b[1](),h),j=!0}h=JXG.copyAttributes(c,a.options,"line"),d=new JXG.Line(a,e,f,h),j?(d.constrained=!0,d.funp1=b[0],d.funp2=b[1]):d.isDraggable=!0,d.constrained||(d.parents=[e.id,f.id])}else if(3==b.length){for(k=!0,g=0;3>g;g++)if("number"==typeof b[g])i[g]=function(a){return function(){return a}}(b[g]);else{if("function"!=typeof b[g])throw new Error("JSXGraph: Can't create line with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"' and '"+typeof b[2]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");i[g]=b[g],k=!1}h=JXG.copyAttributes(c,a.options,"line","point1"),e=k?a.create("point",[i[2]()*i[2]()+i[1]()*i[1](),i[2]()-i[1]()*i[0]()+i[2](),-i[1]()-i[2]()*i[0]()-i[1]()],h):a.create("point",[function(){return.5*(0+i[2]()*i[2]()+i[1]()*i[1]())},function(){return.5*(i[2]()-i[1]()*i[0]()+i[2]())},function(){return.5*(-i[1]()-i[2]()*i[0]()-i[1]())}],h),h=JXG.copyAttributes(c,a.options,"line","point2"),f=k?a.create("point",[i[2]()*i[2]()+i[1]()*i[1](),-i[1]()*i[0]()+i[2](),-i[2]()*i[0]()-i[1]()],h):a.create("point",[function(){return i[2]()*i[2]()+i[1]()*i[1]()},function(){return-i[1]()*i[0]()+i[2]()},function(){return-i[2]()*i[0]()-i[1]()}],h),e.prepareUpdate().update(),f.prepareUpdate().update(),h=JXG.copyAttributes(c,a.options,"line"),d=new JXG.Line(a,e,f,h),d.isDraggable=k,k&&(d.parents=[i[0](),i[1](),i[2]()])}else if(1==b.length&&"function"==typeof b[0]&&2==b[0]().length&&b[0]()[0].elementClass==JXG.OBJECT_CLASS_POINT&&b[0]()[1].elementClass==JXG.OBJECT_CLASS_POINT){var l=b[0]();h=JXG.copyAttributes(c,a.options,"line"),d=new JXG.Line(a,l[0],l[1],h),d.constrained=!0,d.funps=b[0]}else{if(1!=b.length||"function"!=typeof b[0]||3!=b[0]().length||"number"!=typeof b[0]()[0]||"number"!=typeof b[0]()[1]||"number"!=typeof b[0]()[2])throw new Error("JSXGraph: Can't create line with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");l=b[0],h=JXG.copyAttributes(c,a.options,"line","point1"),e=a.create("point",[function(){var a=l();return[.5*(0+a[2]*a[2]+a[1]*a[1]),.5*(a[2]-a[1]*a[0]+a[2]),.5*(-a[1]-a[2]*a[0]-a[1])]}],h),h=JXG.copyAttributes(c,a.options,"line","point2"),f=a.create("point",[function(){var a=l();return[a[2]*a[2]+a[1]*a[1],-a[1]*a[0]+a[2],-a[2]*a[0]-a[1]]}],h),h=JXG.copyAttributes(c,a.options,"line"),d=new JXG.Line(a,e,f,h),d.constrained=!0,d.funps=b[0]}return d},JXG.JSXGraph.registerElement("line",JXG.createLine),JXG.createSegment=function(a,b,c){var d;if(c.straightFirst=!1,c.straightLast=!1,d=a.create("line",b.slice(0,2),c),3==b.length){if(d.hasFixedLength=!0,JXG.isNumber(b[2]))d.fixedLength=function(){return b[2]};else{if(!JXG.isFunction(b[2]))throw new Error("JSXGraph: Can't create segment with third parent type '"+typeof b[2]+"'.\nPossible third parent types: number or function");d.fixedLength=b[2]}d.fixedLengthOldCoords=[],d.fixedLengthOldCoords[0]=new JXG.Coords(JXG.COORDS_BY_USER,d.point1.coords.usrCoords.slice(1,3),a),d.fixedLengthOldCoords[1]=new JXG.Coords(JXG.COORDS_BY_USER,d.point2.coords.usrCoords.slice(1,3),a)}return d.elType="segment",d},JXG.JSXGraph.registerElement("segment",JXG.createSegment),JXG.createArrow=function(a,b,c){var d;return c.firstArrow=!1,c.lastArrow=!0,d=a.create("line",b,c).setStraight(!1,!1),d.type=JXG.OBJECT_TYPE_VECTOR,d.elType="arrow",d},JXG.JSXGraph.registerElement("arrow",JXG.createArrow),JXG.createAxis=function(a,b,c){var d,e,f;if(!JXG.isArray(b[0])&&!JXG.isPoint(b[0])||!JXG.isArray(b[1])&&!JXG.isPoint(b[1]))throw new Error("JSXGraph: Can't create point with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");d=JXG.copyAttributes(c,a.options,"axis"),e=a.create("line",b,d),e.type=JXG.OBJECT_TYPE_AXIS,e.isDraggable=!1,e.point1.isDraggable=!1,e.point2.isDraggable=!1;for(var g in e.ancestors)e.ancestors[g].type=JXG.OBJECT_TYPE_AXISPOINT;return d=JXG.copyAttributes(c,a.options,"axis","ticks"),f=JXG.exists(d.ticksdistance)?d.ticksdistance:JXG.isArray(d.ticks)?d.ticks:1,e.defaultTicks=a.create("ticks",[e,f],d),e.defaultTicks.dump=!1,e.elType="axis",e.subs={ticks:e.defaultTicks},e},JXG.JSXGraph.registerElement("axis",JXG.createAxis),JXG.createTangent=function(a,b,c){var d,e,f,g,h,i,j,k;if(1==b.length)d=b[0],e=d.slideObject;else{if(2!=b.length)throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [glider], [point,line|curve|circle|conic]");if(JXG.isPoint(b[0]))d=b[0],e=b[1];else{if(!JXG.isPoint(b[1]))throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [glider], [point,line|curve|circle|conic]");e=b[0],d=b[1]}}if(e.elementClass==JXG.OBJECT_CLASS_LINE?k=a.create("line",[e.point1,e.point2],c):e.elementClass==JXG.OBJECT_CLASS_CURVE&&e.type!=JXG.OBJECT_TYPE_CONIC?"plot"!=e.visProp.curvetype?(f=e.X,g=e.Y,k=a.create("line",[function(){return-d.X()*a.D(g)(d.position)+d.Y()*a.D(f)(d.position)},function(){return a.D(g)(d.position)},function(){return-a.D(f)(d.position)}],c),d.addChild(k),k.glider=d):(k=a.create("line",[function(){return h=Math.floor(d.position),h==e.numberPoints-1&&h--,0>h?1:e.Y(h)*e.X(h+1)-e.X(h)*e.Y(h+1)},function(){return h=Math.floor(d.position),h==e.numberPoints-1&&h--,0>h?0:e.Y(h+1)-e.Y(h)},function(){return h=Math.floor(d.position),h==e.numberPoints-1&&h--,0>h?0:e.X(h)-e.X(h+1)}],c),d.addChild(k),k.glider=d):e.type==JXG.OBJECT_TYPE_TURTLE?(k=a.create("line",[function(){for(h=Math.floor(d.position),i=0;i<e.objects.length;i++)if(j=e.objects[i],j.type==JXG.OBJECT_TYPE_CURVE){if(h<j.numberPoints)break;h-=j.numberPoints}return h==j.numberPoints-1&&h--,0>h?1:j.Y(h)*j.X(h+1)-j.X(h)*j.Y(h+1)},function(){for(h=Math.floor(d.position),i=0;i<e.objects.length;i++)if(j=e.objects[i],j.type==JXG.OBJECT_TYPE_CURVE){if(h<j.numberPoints)break;h-=j.numberPoints,moveTo(funps)}return h==j.numberPoints-1&&h--,0>h?0:j.Y(h+1)-j.Y(h)},function(){for(h=Math.floor(d.position),i=0;i<e.objects.length;i++)if(j=e.objects[i],j.type==JXG.OBJECT_TYPE_CURVE){if(h<j.numberPoints)break;h-=j.numberPoints}return h==j.numberPoints-1&&h--,0>h?0:j.X(h)-j.X(h+1)}],c),d.addChild(k),k.glider=d):(e.elementClass==JXG.OBJECT_CLASS_CIRCLE||e.type==JXG.OBJECT_TYPE_CONIC)&&(k=a.create("line",[function(){return JXG.Math.matVecMult(e.quadraticform,d.coords.usrCoords)[0]},function(){return JXG.Math.matVecMult(e.quadraticform,d.coords.usrCoords)[1]},function(){return JXG.Math.matVecMult(e.quadraticform,d.coords.usrCoords)[2]}],c),d.addChild(k),k.glider=d),!JXG.exists(k))throw new Error("JSXGraph: Couldn't create tangent with the given parents.");for(k.elType="tangent",k.parents=[],h=0;h<b.length;h++)k.parents.push(b[h].id);return k},JXG.JSXGraph.registerElement("tangent",JXG.createTangent),JXG.JSXGraph.registerElement("polar",JXG.createTangent),JXG.Group=function(a,b,c){var d,e,f,g,h;if(this.board=a,this.objects={},d=this.board.numObjects,this.board.numObjects++,this.id=""!=b&&JXG.exists(b)?b:this.board.id+"Group"+d,this.board.groups[this.id]=this,this.type=JXG.OBJECT_TYPE_POINT,this.elementClass=JXG.OBJECT_CLASS_POINT,this.name=""!=c&&JXG.exists(c)?c:"group_"+this.board.generateName(this),delete this.type,4==arguments.length&&JXG.isArray(arguments[3]))e=arguments[3];else for(e=[],f=3;f<arguments.length;f++)e.push(arguments[f]);for(f=0;f<e.length;f++)g=JXG.getReference(this.board,e[f]),g.visProp.fixed||g.type!=JXG.OBJECT_TYPE_POINT&&g.type!=JXG.OBJECT_TYPE_GLIDER||(0!=g.group.length?this.addGroup(g.group[g.group.length-1]):this.addPoint(g));for(h in this.objects)this.objects[h].group.push(this);this.dX=0,this.dY=0},JXG.extend(JXG.Group.prototype,{ungroup:function(){var a;for(a in this.objects)this.objects[a].group[this.objects[a].group.length-1]==this&&this.objects[a].group.pop(),delete this.objects[a]},update:function(a){var c,b=null;for(c in this.objects)b=this.objects[c],b.id!=a.id&&(b.coords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[b.coords.scrCoords[1]+this.dX,b.coords.scrCoords[2]+this.dY],b.board));for(c in this.objects)JXG.exists(this.board.objects[c])?this.objects[c].update(!1):delete this.objects[c];return this},addPoint:function(a){this.objects[a.id]=a},addPoints:function(a){var b;for(b in a)this.objects[b.id]=b},addGroup:function(a){var b;for(b in a.objects)this.addPoint(a.objects[b])},setProperty:function(){var a;for(a in this.objects)this.objects[a].setProperty.apply(this.objects[a],arguments)}}),JXG.createGroup=function(a,b,c){var d,e=new JXG.Group(a,c.id,c.name,b);for(e.elType="group",e.parents=[],d=0;d<b.length;d++)e.parents.push(b[d].id);return e},JXG.JSXGraph.registerElement("group",JXG.createGroup),JXG.Circle=function(a,b,c,d,e){this.constructor(a,e,JXG.OBJECT_TYPE_CIRCLE,JXG.OBJECT_CLASS_CIRCLE),this.method=b,this.midpoint=JXG.getReference(this.board,c),this.center=JXG.getReference(this.board,c),this.point2=null,this.radius=0,this.line=null,this.circle=null,"twoPoints"==b?(this.point2=JXG.getReference(a,d),this.radius=this.Radius()):"pointRadius"==b?(this.gxtterm=d,this.updateRadius=JXG.createFunction(d,this.board,null,!0),this.updateRadius()):"pointLine"==b?(this.line=JXG.getReference(a,d),this.radius=this.line.point1.coords.distance(JXG.COORDS_BY_USER,this.line.point2.coords)):"pointCircle"==b&&(this.circle=JXG.getReference(a,d),this.radius=this.circle.Radius()),this.id=this.board.setId(this,"C"),this.board.renderer.drawEllipse(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="circle",this.createLabel(),this.center.addChild(this),"pointRadius"==b?this.notifyParents(d):"pointLine"==b?this.line.addChild(this):"pointCircle"==b?this.circle.addChild(this):"twoPoints"==b&&this.point2.addChild(this),this.methodMap=JXG.deepCopy(this.methodMap,{setRadius:"setRadius",getRadius:"getRadius",radius:"Radius"})
},JXG.Circle.prototype=new JXG.GeometryElement,JXG.extend(JXG.Circle.prototype,{hasPoint:function(a,b){var c=this.board.options.precision.hasPoint/this.board.unitX,d=this.center.coords.usrCoords,e=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,b],this.board),f=this.Radius(),g=Math.sqrt((d[1]-e.usrCoords[1])*(d[1]-e.usrCoords[1])+(d[2]-e.usrCoords[2])*(d[2]-e.usrCoords[2]));return Math.abs(g-f)<c},generatePolynomial:function(a){var b=this.center.symbolic.x,c=this.center.symbolic.y,d=a.symbolic.x,e=a.symbolic.y,f=this.generateRadiusSquared();if(""==f)return[];var g="(("+d+")-("+b+"))^2 + (("+e+")-("+c+"))^2 - ("+f+")";return[g]},generateRadiusSquared:function(){var b,c,d,e,f,g,a="";return"twoPoints"==this.method?(b=this.center.symbolic.x,c=this.center.symbolic.y,d=this.point2.symbolic.x,e=this.point2.symbolic.y,a="(("+d+")-("+b+"))^2 + (("+e+")-("+c+"))^2"):"pointRadius"==this.method?"number"==typeof this.radius&&(a=""+this.radius*this.radius):"pointLine"==this.method?(d=this.line.point1.symbolic.x,e=this.line.point1.symbolic.y,f=this.line.point2.symbolic.x,g=this.line.point2.symbolic.y,a="(("+d+")-("+f+"))^2 + (("+e+")-("+g+"))^2"):"pointCircle"==this.method&&(a=this.circle.Radius()),a},update:function(){return this.needsUpdate&&(this.visProp.trace&&this.cloneToBackground(!0),"pointLine"==this.method?this.radius=this.line.point1.coords.distance(JXG.COORDS_BY_USER,this.line.point2.coords):"pointCircle"==this.method?this.radius=this.circle.Radius():"pointRadius"==this.method&&(this.radius=this.updateRadius()),this.updateStdform(),this.updateQuadraticform()),this},updateQuadraticform:function(){var a=this.center,b=a.X(),c=a.Y(),d=this.Radius();this.quadraticform=[[b*b+c*c-d*d,-b,-c],[-b,1,0],[-c,0,1]]},updateStdform:function(){this.stdform[3]=.5,this.stdform[4]=this.Radius(),this.stdform[1]=-this.center.coords.usrCoords[1],this.stdform[2]=-this.center.coords.usrCoords[2],this.normalize()},updateRenderer:function(){if(this.needsUpdate&&this.visProp.visible){var a=this.isReal;this.isReal=!isNaN(this.center.coords.usrCoords[1]+this.center.coords.usrCoords[2]+this.Radius())&&this.center.isReal,this.isReal?(a!=this.isReal&&(this.board.renderer.show(this),this.hasLabel&&this.label.content.visProp.visible&&this.board.renderer.show(this.label.content)),this.board.renderer.updateEllipse(this)):a!=this.isReal&&(this.board.renderer.hide(this),this.hasLabel&&this.label.content.visProp.visible&&this.board.renderer.hide(this.label.content)),this.needsUpdate=!1}this.hasLabel&&this.label.content.visProp.visible&&this.isReal&&(this.label.content.update(),this.board.renderer.updateText(this.label.content))},notifyParents:function(a){"string"==typeof a&&JXG.GeonextParser.findDependencies(this,a+"",this.board)},setRadius:function(a){return this.updateRadius=JXG.createFunction(a,this.board,null,!0),this.board.update(),this},Radius:function(a){return JXG.exists(a)?(this.setRadius(a),this.Radius()):"twoPoints"==this.method?0==JXG.Math.Geometry.distance(this.point2.coords.usrCoords,[0,0,0])||0==JXG.Math.Geometry.distance(this.center.coords.usrCoords,[0,0,0])?0/0:this.center.Dist(this.point2):"pointLine"==this.method||"pointCircle"==this.method?this.radius:"pointRadius"==this.method?this.updateRadius():void 0},getRadius:function(){return this.Radius()},getTextAnchor:function(){return this.center.coords},getLabelAnchor:function(){var c,d,a=this.Radius(),b=this.center.coords.usrCoords;switch(this.visProp.label.position){case"lft":c=b[1]-a,d=b[2];break;case"llft":c=b[1]-Math.sqrt(.5)*a,d=b[2]-Math.sqrt(.5)*a;break;case"rt":c=b[1]+a,d=b[2];break;case"lrt":c=b[1]+Math.sqrt(.5)*a,d=b[2]-Math.sqrt(.5)*a;break;case"urt":c=b[1]+Math.sqrt(.5)*a,d=b[2]+Math.sqrt(.5)*a;break;case"top":c=b[1],d=b[2]+a;break;case"bot":c=b[1],d=b[2]-a;break;case"ulft":default:c=b[1]-Math.sqrt(.5)*a,d=b[2]+Math.sqrt(.5)*a}return new JXG.Coords(JXG.COORDS_BY_USER,[c,d],this.board)},cloneToBackground:function(){var b,c,a={};return a.id=this.id+"T"+this.numTraces,a.elementClass=JXG.OBJECT_CLASS_CIRCLE,this.numTraces++,a.center={},a.center.coords=this.center.coords,b=this.Radius(),a.Radius=function(){return b},a.getRadius=function(){return b},a.board=this.board,a.visProp=JXG.deepCopy(this.visProp,this.visProp.traceattributes,!0),a.visProp.layer=this.board.options.layer.trace,JXG.clearVisPropOld(a),c=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawEllipse(a),this.board.renderer.enhancedRendering=c,this.traces[a.id]=a.rendNode,this},addTransform:function(a){var b,c=JXG.isArray(a)?a:[a],d=c.length;for(b=0;d>b;b++)this.center.transformations.push(c[b]),"twoPoints"===this.method&&this.point2.transformations.push(c[b]);return this},snapToGrid:function(){return this.visProp.snaptogrid&&(this.center.snapToGrid(),"twoPoints"===this.method&&this.point2.snapToGrid()),this},setPosition:function(a,b){var c;return b=new JXG.Coords(a,b,this.board),c=this.board.create("transform",b.usrCoords.slice(1),{type:"translate"}),this.addTransform(c),this},setPositionDirectly:function(a,b,c){b=new JXG.Coords(a,b,this.board),c=new JXG.Coords(a,c,this.board);var f,g,d=JXG.Math.Statistics.subtract(b.usrCoords,c.usrCoords),e=this.parents.length;for(f=0;e>f;f++)if(!JXG.getRef(this.board,this.parents[f]).draggable())return this;for(f=0;e>f;f++)g=JXG.getRef(this.board,this.parents[f]),g.coords.setCoordinates(JXG.COORDS_BY_USER,JXG.Math.Statistics.add(g.coords.usrCoords,d));return this.update(),this},X:function(a){return this.Radius()*Math.cos(2*a*Math.PI)+this.center.coords.usrCoords[1]},Y:function(a){return this.Radius()*Math.sin(2*a*Math.PI)+this.center.coords.usrCoords[2]},Z:function(){return 1},minX:function(){return 0},maxX:function(){return 1},Area:function(){var a=this.Radius();return a*a*Math.PI},bounds:function(){var a=this.center.coords.usrCoords,b=this.Radius();return[a[1]-b,a[2]+b,a[1]+b,a[2]-b]}}),JXG.createCircle=function(a,b,c){var d,e,f,g,h=!0;for(e=[],f=0;f<b.length;f++)JXG.isPoint(b[f])?e[f]=b[f]:JXG.isArray(b[f])&&b[f].length>1?(g=JXG.copyAttributes(c,a.options,"circle","center"),e[f]=a.create("point",b[f],g)):e[f]=b[f];if(g=JXG.copyAttributes(c,a.options,"circle"),2==b.length&&JXG.isPoint(e[0])&&JXG.isPoint(e[1]))d=new JXG.Circle(a,"twoPoints",e[0],e[1],g);else if((JXG.isNumber(e[0])||JXG.isFunction(e[0])||JXG.isString(e[0]))&&JXG.isPoint(e[1]))d=new JXG.Circle(a,"pointRadius",e[1],e[0],g);else if((JXG.isNumber(e[1])||JXG.isFunction(e[1])||JXG.isString(e[1]))&&JXG.isPoint(e[0]))d=new JXG.Circle(a,"pointRadius",e[0],e[1],g);else if(e[0].elementClass==JXG.OBJECT_CLASS_CIRCLE&&JXG.isPoint(e[1]))d=new JXG.Circle(a,"pointCircle",e[1],e[0],g);else if(e[1].elementClass==JXG.OBJECT_CLASS_CIRCLE&&JXG.isPoint(e[0]))d=new JXG.Circle(a,"pointCircle",e[0],e[1],g);else if(e[0].elementClass==JXG.OBJECT_CLASS_LINE&&JXG.isPoint(e[1]))d=new JXG.Circle(a,"pointLine",e[1],e[0],g);else if(e[1].elementClass==JXG.OBJECT_CLASS_LINE&&JXG.isPoint(e[0]))d=new JXG.Circle(a,"pointLine",e[0],e[1],g);else{if(!(3==b.length&&JXG.isPoint(e[0])&&JXG.isPoint(e[1])&&JXG.isPoint(e[2])))throw new Error("JSXGraph: Can't create circle with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point], [point,number], [point,function], [point,circle], [point,point,point]");d=JXG.createCircumcircle(a,e,c)}for(d.isDraggable=h,d.parents=[],f=0;f<b.length;f++)b[f].id&&d.parents.push(b[f].id);return d.elType="circle",d},JXG.JSXGraph.registerElement("circle",JXG.createCircle),JXG.createEllipse=function(a,b,c){var e,f,g,h,d=[],i=JXG.copyAttributes(c,a.options,"conic","foci"),j=JXG.copyAttributes(c,a.options,"conic");for(g=0;2>g;g++)if(b[g].length>1)d[g]=a.create("point",b[g],i);else if(JXG.isPoint(b[g]))d[g]=JXG.getReference(a,b[g]);else if("function"==typeof b[g]&&b[g]().elementClass===JXG.OBJECT_CLASS_POINT)d[g]=b[g]();else{if(!JXG.isString(b[g]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");d[g]=JXG.getReference(a,b[g])}if(JXG.isNumber(b[2]))f=JXG.createFunction(b[2],a);else if("function"==typeof b[2]&&JXG.isNumber(b[2]()))f=b[2];else{if(JXG.isPoint(b[2]))e=JXG.getReference(a,b[2]);else if(b[2].length>1)e=a.create("point",b[2],i);else if("function"==typeof b[2]&&b[2]().elementClass==JXG.OBJECT_CLASS_POINT)e=b[2]();else{if(!JXG.isString(b[2]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"' and '"+typeof b[2]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");e=JXG.getReference(a,b[2])}f=function(){return e.Dist(d[0])+e.Dist(d[1])}}"undefined"==typeof b[4]&&(b[4]=1.0001*Math.PI),"undefined"==typeof b[3]&&(b[3]=-1.0001*Math.PI);var k=a.create("point",[function(){return.5*(d[0].X()+d[1].X())},function(){return.5*(d[0].Y()+d[1].Y())}],i),l=function(){var f,g,h,a=d[0].X(),b=d[0].Y(),c=d[1].X(),e=d[1].Y(),i=c-a>0?1:-1;f=Math.abs(c-a)>1e-7?Math.atan2(e-b,c-a)+(0>i?Math.PI:0):(e-b>0?.5:-.5)*Math.PI,g=Math.cos(f),h=Math.sin(f);var j=[[1,0,0],[k.X(),g,-h],[k.Y(),h,g]];return j},m=a.create("curve",[function(){return 0},function(){return 0},b[3],b[4]],j),n=function(a,b){var o,p,c=.5*f(),e=c*c,g=.5*d[1].Dist(d[0]),i=e-g*g,j=Math.sqrt(i),n=[[1,0,0],[0,1,0],[0,0,1]];return b||(h=l(),o=k.X(),p=k.Y(),n[0][0]=h[0][0],n[0][1]=0,n[0][2]=0,n[1][0]=o*(1-h[1][1])+p*h[1][2],n[1][1]=h[1][1],n[1][2]=h[2][1],n[2][0]=p*(1-h[1][1])-o*h[1][2],n[2][1]=h[1][2],n[2][2]=h[2][2],m.quadraticform=JXG.Math.matMatMult(JXG.Math.transpose(n),JXG.Math.matMatMult([[-1+o*o/(c*c)+p*p/i,-o/e,-o/i],[-o/e,1/e,0],[-p/i,0,1/i]],n))),JXG.Math.matVecMult(h,[1,c*Math.cos(a),j*Math.sin(a)])};return m.X=function(a,b){return n(a,b)[1]},m.Y=function(a,b){return n(a,b)[2]},m.midpoint=k,m.type=JXG.OBJECT_TYPE_CONIC,m},JXG.createHyperbola=function(a,b,c){var e,f,g,h,d=[],i=JXG.copyAttributes(c,a.options,"conic","foci"),j=JXG.copyAttributes(c,a.options,"conic");for(g=0;2>g;g++)if(b[g].length>1)d[g]=a.create("point",b[g],attr_focu);else if(JXG.isPoint(b[g]))d[g]=JXG.getReference(a,b[g]);else if("function"==typeof b[g]&&b[g]().elementClass==JXG.OBJECT_CLASS_POINT)d[g]=b[g]();else{if(!JXG.isString(b[g]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");d[g]=JXG.getReference(a,b[g])}if(JXG.isNumber(b[2]))f=JXG.createFunction(b[2],a);else if("function"==typeof b[2]&&JXG.isNumber(b[2]()))f=b[2];else{if(JXG.isPoint(b[2]))e=JXG.getReference(a,b[2]);else if(b[2].length>1)e=a.create("point",b[2],i);else if("function"==typeof b[2]&&b[2]().elementClass==JXG.OBJECT_CLASS_POINT)e=b[2]();else{if(!JXG.isString(b[2]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"' and '"+typeof b[2]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");e=JXG.getReference(a,b[2])}f=function(){return e.Dist(d[0])-e.Dist(d[1])}}"undefined"==typeof b[4]&&(b[4]=1.0001*Math.PI),"undefined"==typeof b[3]&&(b[3]=-1.0001*Math.PI);var k=a.create("point",[function(){return.5*(d[0].X()+d[1].X())},function(){return.5*(d[0].Y()+d[1].Y())}],i),l=function(){var f,a=d[0].X(),b=d[0].Y(),c=d[1].X(),e=d[1].Y(),g=c-a>0?1:-1;f=Math.abs(c-a)>1e-7?Math.atan2(e-b,c-a)+(0>g?Math.PI:0):(e-b>0?.5:-.5)*Math.PI;var h=[[1,0,0],[k.X(),Math.cos(f),-Math.sin(f)],[k.Y(),Math.sin(f),Math.cos(f)]];return h},m=a.create("curve",[function(){return 0},function(){return 0},b[3],b[4]],j),n=function(a,b){var o,p,c=.5*f(),e=c*c,g=.5*d[1].Dist(d[0]),i=Math.sqrt(-c*c+g*g),j=i*i,n=[[1,0,0],[0,1,0],[0,0,1]];return b||(h=l(),o=k.X(),p=k.Y(),n[0][0]=h[0][0],n[0][1]=0,n[0][2]=0,n[1][0]=o*(1-h[1][1])+p*h[1][2],n[1][1]=h[1][1],n[1][2]=h[2][1],n[2][0]=p*(1-h[1][1])-o*h[1][2],n[2][1]=h[1][2],n[2][2]=h[2][2],m.quadraticform=JXG.Math.matMatMult(JXG.Math.transpose(n),JXG.Math.matMatMult([[-1+o*o/e+p*p/j,-o/e,p/j],[-o/e,1/e,0],[p/j,0,-1/j]],n))),JXG.Math.matVecMult(h,[1,c/Math.cos(a),i*Math.tan(a)])};return m.X=function(a,b){return n(a,b)[1]},m.Y=function(a,b){return n(a,b)[2]},m.midpoint=k,m.type=JXG.OBJECT_TYPE_CONIC,m},JXG.createParabola=function(a,b,c){var f,d=b[0],e=b[1],g=JXG.copyAttributes(c,a.options,"conic","foci"),h=JXG.copyAttributes(c,a.options,"conic");if(b[0].length>1)d=a.create("point",b[0],g);else if(JXG.isPoint(b[0]))d=JXG.getReference(a,b[0]);else if("function"==typeof b[0]&&b[0]().elementClass==JXG.OBJECT_CLASS_POINT)d=b[0]();else{if(!JXG.isString(b[0]))throw new Error("JSXGraph: Can't create Parabola with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,line]");d=JXG.getReference(a,b[0])}"undefined"==typeof b[3]&&(b[3]=10),"undefined"==typeof b[2]&&(b[2]=-10);var i=a.create("point",[function(){var b=[0,e.stdform[1],e.stdform[2]];return b=JXG.Math.crossProduct(b,d.coords.usrCoords),JXG.Math.Geometry.meetLineLine(b,e.stdform,0,a).usrCoords}],g),j=function(){var a=Math.atan(e.getSlope()),b=.5*(i.X()+d.X()),c=.5*(i.Y()+d.Y());a+=d.Y()-i.Y()<0||d.Y()==i.Y()&&d.X()>i.X()?Math.PI:0;var f=[[1,0,0],[b*(1-Math.cos(a))+c*Math.sin(a),Math.cos(a),-Math.sin(a)],[c*(1-Math.cos(a))-b*Math.sin(a),Math.sin(a),Math.cos(a)]];return f},k=a.create("curve",[function(){return 0},function(){return 0},b[2],b[3]],h),l=function(a,b){var c=.5*i.Dist(d),e=[[1,0,0],[0,1,0],[0,0,1]],g=.5*(i.X()+d.X()),h=.5*(i.Y()+d.Y());return b||(f=j(),e[0][0]=f[0][0],e[0][1]=0,e[0][2]=0,e[1][0]=g*(1-f[1][1])+h*f[1][2],e[1][1]=f[1][1],e[1][2]=f[2][1],e[2][0]=h*(1-f[1][1])-g*f[1][2],e[2][1]=f[1][2],e[2][2]=f[2][2],k.quadraticform=JXG.Math.matMatMult(JXG.Math.transpose(e),JXG.Math.matMatMult([[4*-h*c-g*g,g,2*c],[g,-1,0],[2*c,0,0]],e))),JXG.Math.matVecMult(f,[1,a+g,a*a/(4*c)+h])};return k.X=function(a,b){return l(a,b)[1]},k.Y=function(a,b){return l(a,b)[2]},k.type=JXG.OBJECT_TYPE_CONIC,k},JXG.createConic=function(a,b,c){var e,f,g,h,j,k,m,n,o,d=[[1,0,0],[0,1,0],[0,0,1]],i=[[1,0,0],[0,1,0],[0,0,1]],l=[],p=[],q=JXG.copyAttributes(c,a.options,"conic","foci"),r=JXG.copyAttributes(c,a.options,"conic");if(5==b.length)o=!0;else{if(6!=b.length)throw new Error("JSXGraph: Can't create generic Conic with "+parent.length+" parameters.");o=!1}if(o)for(m=0;5>m;m++)if(b[m].length>1)l[m]=a.create("point",b[m],q);else if(JXG.isPoint(b[m]))l[m]=JXG.getReference(a,b[m]);else if("function"==typeof b[m]&&b[m]().elementClass==JXG.OBJECT_CLASS_POINT)l[m]=b[m]();else{if(!JXG.isString(b[m]))throw new Error("JSXGraph: Can't create Conic section with parent types '"+typeof b[m]+"'.\nPossible parent types: [point,point,point,point,point], [a00,a11,a22,a01,a02,a12]");l[m]=JXG.getReference(a,b[m])}else n=[[0,0,0],[0,0,0],[0,0,0]],n[0][0]=JXG.isFunction(b[2])?function(){return b[2]()}:function(){return b[2]},n[0][1]=JXG.isFunction(b[4])?function(){return b[4]()}:function(){return b[4]},n[0][2]=JXG.isFunction(b[5])?function(){return b[5]()}:function(){return b[5]},n[1][1]=JXG.isFunction(b[0])?function(){return b[0]()}:function(){return b[0]},n[1][2]=JXG.isFunction(b[3])?function(){return b[3]()}:function(){return b[3]},n[2][2]=JXG.isFunction(b[1])?function(){return b[1]()}:function(){return b[1]};var s=function(a){var b,c;for(b=0;3>b;b++)for(c=b;3>c;c++)a[b][c]+=a[c][b];for(b=0;3>b;b++)for(c=0;b>c;c++)a[b][c]=a[c][b];return a},t=function(a,b){var c,d,e=[[0,0,0],[0,0,0],[0,0,0]];for(c=0;3>c;c++)for(d=0;3>d;d++)e[c][d]=a[c]*b[d];return s(e)},u=function(a,b,c){var d,e,f,h,i,g=[[0,0,0],[0,0,0],[0,0,0]];for(f=JXG.Math.matVecMult(b,c),d=JXG.Math.innerProduct(c,f),f=JXG.Math.matVecMult(a,c),e=JXG.Math.innerProduct(c,f),h=0;3>h;h++)for(i=0;3>i;i++)g[h][i]=d*a[h][i]-e*b[h][i];return g},v=a.create("curve",[function(){return 0},function(){return 0},0,2*Math.PI],r),w=function(a,b){var c,m,q,r;if(!b){if(o){for(c=0;5>c;c++)p[c]=l[c].coords.usrCoords;j=t(JXG.Math.crossProduct(p[0],p[1]),JXG.Math.crossProduct(p[2],p[3])),k=t(JXG.Math.crossProduct(p[0],p[2]),JXG.Math.crossProduct(p[1],p[3])),i=u(j,k,p[4])}else for(c=0;3>c;c++)for(m=c;3>m;m++)i[c][m]=n[c][m](),m>c&&(i[m][c]=i[c][m]);for(v.quadraticform=i,e=JXG.Math.Numerics.Jacobi(i),e[0][0][0]<0&&(e[0][0][0]*=-1,e[0][1][1]*=-1,e[0][2][2]*=-1),c=0;3>c;c++){for(q=0,m=0;3>m;m++)q+=e[1][m][c]*e[1][m][c];for(q=Math.sqrt(q),m=0;3>m;m++);}d=e[1],h=Math.sqrt(Math.abs(e[0][0][0])),f=Math.sqrt(Math.abs(e[0][1][1])),g=Math.sqrt(Math.abs(e[0][2][2]))}return e[0][1][1]<=0&&e[0][2][2]<=0?r=JXG.Math.matVecMult(d,[1/h,Math.cos(a)/f,Math.sin(a)/g]):e[0][1][1]<=0&&e[0][2][2]>0?r=JXG.Math.matVecMult(d,[Math.cos(a)/h,1/f,Math.sin(a)/g]):e[0][2][2]<0&&(r=JXG.Math.matVecMult(d,[Math.sin(a)/h,Math.cos(a)/f,1/g])),r[1]/=r[0],r[2]/=r[0],r[0]=1,r};return v.X=function(a,b){return w(a,b)[1]},v.Y=function(a,b){return w(a,b)[2]},v.midpoint=a.create("point",[function(){var a=v.quadraticform;return[a[1][1]*a[2][2]-a[1][2]*a[1][2],a[1][2]*a[0][2]-a[2][2]*a[0][1],a[0][1]*a[1][2]-a[1][1]*a[0][2]]}],q),v.type=JXG.OBJECT_TYPE_CONIC,v},JXG.JSXGraph.registerElement("ellipse",JXG.createEllipse),JXG.JSXGraph.registerElement("hyperbola",JXG.createHyperbola),JXG.JSXGraph.registerElement("parabola",JXG.createParabola),JXG.JSXGraph.registerElement("conic",JXG.createConic),JXG.Polygon=function(a,b,c){this.constructor(a,c,JXG.OBJECT_TYPE_POLYGON,JXG.OBJECT_CLASS_AREA);var d,e,f,g=JXG.copyAttributes(c,a.options,"polygon","borders");for(this.withLines=c.withlines,this.attr_line=g,this.vertices=[],d=0;d<b.length;d++)e=JXG.getRef(this.board,b[d]),this.vertices[d]=e;if(this.vertices[this.vertices.length-1]!=this.vertices[0]&&this.vertices.push(this.vertices[0]),this.borders=[],this.withLines)for(d=0;d<this.vertices.length-1;d++)g.id=g.ids&&g.ids[d],g.strokecolor=JXG.isArray(g.colors)&&g.colors[d%g.colors.length]||g.strokecolor,g.strokecolor===!1&&(g.strokecolor="none"),f=JXG.createSegment(a,[this.vertices[d],this.vertices[d+1]],g),f.dump=!1,this.borders[d]=f,f.parentPolygon=this;for(d=0;d<this.vertices.length-1;d++)e=JXG.getReference(this.board,this.vertices[d]),e.addChild(this);this.createLabel(),this.id=this.board.setId(this,"Py"),this.board.renderer.drawPolygon(this),this.board.finalizeAdding(this),this.methodMap.borders="borders",this.methodMap.vertices="vertices",this.elType="polygon"},JXG.Polygon.prototype=new JXG.GeometryElement,JXG.extend(JXG.Polygon.prototype,{hasPoint:function(a,b){var c,d,e,f=!1;if(this.visProp.hasinnerpoints)for(e=this.vertices.length,c=0,d=e-2;e-1>c;d=c++)this.vertices[c].coords.scrCoords[2]>b!=this.vertices[d].coords.scrCoords[2]>b&&a<(this.vertices[d].coords.scrCoords[1]-this.vertices[c].coords.scrCoords[1])*(b-this.vertices[c].coords.scrCoords[2])/(this.vertices[d].coords.scrCoords[2]-this.vertices[c].coords.scrCoords[2])+this.vertices[c].coords.scrCoords[1]&&(f=!f);else for(e=this.borders.length,c=0;e>c;c++)if(this.borders[c].hasPoint(a,b)){f=!0;break}return f},updateRenderer:function(){this.needsUpdate&&(this.board.renderer.updatePolygon(this),this.needsUpdate=!1),this.hasLabel&&this.label.content.visProp.visible&&(this.label.content.update(),this.board.renderer.updateText(this.label.content))},getTextAnchor:function(){var e,a=this.vertices[0].X(),b=this.vertices[0].Y(),c=a,d=b;for(e=0;e<this.vertices.length;e++)this.vertices[e].X()<a&&(a=this.vertices[e].X()),this.vertices[e].X()>c&&(c=this.vertices[e].X()),this.vertices[e].Y()>b&&(b=this.vertices[e].Y()),this.vertices[e].Y()<d&&(d=this.vertices[e].Y());return new JXG.Coords(JXG.COORDS_BY_USER,[.5*(a+c),.5*(b+d)],this.board)},getLabelAnchor:JXG.shortcut(JXG.Polygon.prototype,"getTextAnchor"),cloneToBackground:function(){var b,a={};return a.id=this.id+"T"+this.numTraces,this.numTraces++,a.vertices=this.vertices,a.visProp=JXG.deepCopy(this.visProp,this.visProp.traceattributes,!0),a.visProp.layer=this.board.options.layer.trace,a.board=this.board,JXG.clearVisPropOld(a),b=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawPolygon(a),this.board.renderer.enhancedRendering=b,this.traces[a.id]=a.rendNode,this},hideElement:function(){var a;for(this.visProp.visible=!1,this.board.renderer.hide(this),a=0;a<this.borders.length;a++)this.borders[a].hideElement();this.hasLabel&&JXG.exists(this.label)&&(this.label.hiddenByParent=!0,this.label.content.visProp.visible&&this.board.renderer.hide(this.label.content))},showElement:function(){var a;for(this.visProp.visible=!0,this.board.renderer.show(this),a=0;a<this.borders.length;a++)this.borders[a].showElement();this.hasLabel&&JXG.exists(this.label)&&this.label.content.visProp.visible&&this.board.renderer.show(this.label.content)},Area:function(){var b,a=0;for(b=0;b<this.vertices.length-1;b++)a+=this.vertices[b].X()*this.vertices[b+1].Y()-this.vertices[b+1].X()*this.vertices[b].Y();return a/=2,Math.abs(a)},remove:function(){var a;for(a=0;a<this.borders.length;a++)this.board.removeObject(this.borders[a]);this.board.renderer.remove(this.rendNode)},findPoint:function(a){var b;if(!JXG.isPoint(a))return-1;for(b=0;b<this.vertices.length;b++)if(this.vertices[b].id===a.id)return b;return-1},addPoints:function(){var a=Array.prototype.slice.call(arguments);return this.insertPoints.apply(this,[this.vertices.length-2].concat(a))},insertPoints:function(){var a,b,d,c=[];if(0===arguments.length)return this;if(a=arguments[0],0>a||a>this.vertices.length-2)return this;for(b=1;b<arguments.length;b++)JXG.isPoint(arguments[b])&&c.push(arguments[b]);if(d=this.vertices.slice(0,a+1).concat(c),this.vertices=d.concat(this.vertices.slice(a+1)),this.withLines){for(d=this.borders.slice(0,a),this.board.removeObject(this.borders[a]),b=0;b<c.length;b++)d.push(JXG.createSegment(this.board,[this.vertices[a+b],this.vertices[a+b+1]],this.attr_line));d.push(JXG.createSegment(this.board,[this.vertices[a+c.length],this.vertices[a+c.length+1]],this.attr_line)),this.borders=d.concat(this.borders.slice(a))}return this.board.update(),this},removePoints:function(){var a,b,c,d=[],e=[],f=[],g=[];for(this.vertices=this.vertices.slice(0,this.vertices.length-1),a=0;a<arguments.length;a++)JXG.isPoint(arguments[a])&&(c=this.findPoint(arguments[a])),JXG.isNumber(c)&&c>-1&&c<this.vertices.length&&-1===JXG.indexOf(f,c)&&f.push(c);for(f=f.sort(),d=this.vertices.slice(),e=this.borders.slice(),this.withLines&&g.push([f[f.length-1]]),a=f.length-1;a>-1;a--)d[f[a]]=-1,this.withLines&&f[a]-1>f[a-1]&&(g[g.length-1][1]=f[a],g.push([f[a-1]]));for(this.withLines&&(g[g.length-1][1]=f[0]),this.vertices=[],a=0;a<d.length;a++)JXG.isPoint(d[a])&&this.vertices.push(d[a]);if(this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.withLines){for(a=0;a<g.length;a++){for(b=g[a][1]-1;b<g[a][0]+1;b++)0>b?(b=0,this.board.removeObject(this.borders[e.length-1]),e[e.length-1]=-1):b>e.length-1&&(b=e.length-1),this.board.removeObject(this.borders[b]),e[b]=-1;0!==g[a][1]&&g[a][0]!==d.length-1&&(e[g[a][0]-1]=JXG.createSegment(this.board,[d[Math.max(g[a][1]-1,0)],d[Math.min(g[a][0]+1,this.vertices.length-1)]],this.attr_line))}for(this.borders=[],a=0;a<e.length;a++)-1!==e[a]&&this.borders.push(e[a]);(5===g[0][1]||0===g[g.length-1][1])&&this.borders.push(JXG.createSegment(this.board,[this.vertices[0],this.vertices[this.vertices.length-2]],this.attr_line))}return this.board.update(),this},getParents:function(){var b,a=[];for(b=0;b<this.vertices.length;b++)a.push(this.vertices[b].id);return a},getAttributes:function(){var b,a=JXG.GeometryElement.prototype.getAttributes.call(this);if(this.withLines)for(a.lines=a.lines||{},a.lines.ids=[],a.lines.colors=[],b=0;b<this.borders.length;b++)a.lines.ids.push(this.borders[b].id),a.lines.colors.push(this.borders[b].visProp.strokecolor);return a}}),JXG.createPolygon=function(a,b,c){var d,e,f=JXG.copyAttributes(c,a.options,"polygon");for(e=0;e<b.length;e++)if(b[e]=JXG.getReference(a,b[e]),!JXG.isPoint(b[e]))throw new Error("JSXGraph: Can't create polygon with parent types other than 'point'.");return d=new JXG.Polygon(a,b,f)},JXG.createRegularPolygon=function(a,b,c){var d,e,f,h,j,k,l,g=[];if(JXG.isNumber(b[b.length-1])&&3!=b.length)throw new Error("JSXGraph: A regular polygon needs two points and a number as input.");if(j=b.length,f=b[j-1],!JXG.isNumber(f)&&!JXG.isPoint(JXG.getReference(a,f))||3>f)throw new Error("JSXGraph: The third parameter has to be number greater than 2 or a point.");for(JXG.isPoint(JXG.getReference(a,f))?(f=j,k=!0):(j--,k=!1),e=0;j>e;e++)if(b[e]=JXG.getReference(a,b[e]),!JXG.isPoint(b[e]))throw new Error("JSXGraph: Can't create regular polygon if the first two parameters aren't points.");for(g[0]=b[0],g[1]=b[1],l=JXG.copyAttributes(c,a.options,"polygon","vertices"),e=2;f>e;e++)h=a.create("transform",[Math.PI*(2-(f-2)/f),g[e-1]],{type:"rotate"}),k?(g[e]=b[e],g[e].addTransform(b[e-2],h)):(JXG.isArray(l.ids)&&l.ids.length>=f-2&&(l.id=l.ids[e-2]),g[e]=a.create("point",[g[e-2],h],l),g[e].type=JXG.OBJECT_TYPE_CAS);return l=JXG.copyAttributes(c,a.options,"polygon"),d=a.create("polygon",g,l),d.elType="regularpolygon",d},JXG.JSXGraph.registerElement("polygon",JXG.createPolygon),JXG.JSXGraph.registerElement("regularpolygon",JXG.createRegularPolygon),JXG.Curve=function(a,b,c){this.constructor(a,c,JXG.OBJECT_TYPE_CURVE,JXG.OBJECT_CLASS_CURVE),this.points=[],this.numberPoints=this.visProp.numberpointshigh,this.bezierDegree=1,this.dataX=null,this.dataY=null,this.varname=null!=b[0]?b[0]:"x",this.xterm=b[1],this.yterm=b[2],this.generateTerm(this.varname,this.xterm,this.yterm,b[3],b[4]),this.updateCurve(),this.id=this.board.setId(this,"G"),this.board.renderer.drawCurve(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="curve",this.createLabel(),"string"==typeof this.xterm&&this.notifyParents(this.xterm),"string"==typeof this.yterm&&this.notifyParents(this.yterm)},JXG.Curve.prototype=new JXG.GeometryElement,JXG.extend(JXG.Curve.prototype,{minX:function(){if("polar"==this.visProp.curvetype)return 0;var a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this.board);return a.usrCoords[1]},maxX:function(){var a;return"polar"==this.visProp.curvetype?2*Math.PI:(a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[this.board.canvasWidth,0],this.board),a.usrCoords[1])},Z:function(){return 1},hasPoint:function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,z,A,e=1/0,w=this.visProp.numberpointslow,x=(this.maxX()-this.minX())/w,y=this.board.options.precision.hasPoint/this.board.unitX,B=!0;if(y*=y,z=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,b],this.board),a=z.usrCoords[1],b=z.usrCoords[2],"parameter"==this.visProp.curvetype||"polar"==this.visProp.curvetype||"functiongraph"==this.visProp.curvetype)for(A=this.transformations.length,h=0,d=this.minX();w>h;h++){for(j=this.X(d,B),k=this.Y(d,B),i=0;A>i;i++)g=this.transformations[i],g.update(),f=JXG.Math.matVecMult(g.matrix,[1,j,k]),j=f[1],k=f[2];if(e=(a-j)*(a-j)+(b-k)*(b-k),y>e)return!0;d+=x}else if("plot"==this.visProp.curvetype){for((!JXG.exists(c)||0>c)&&(c=0),A=this.numberPoints,h=c;A-1>h;h++){for(l=this.X(h),m=this.X(h+1),n=this.Y(h),o=this.Y(h+1),i=0;i<this.transformations.length;i++)g=this.transformations[i],g.update(),f=JXG.Math.matVecMult(g.matrix,[1,l,n]),l=f[1],n=f[2],f=JXG.Math.matVecMult(g.matrix,[1,m,o]),m=f[1],o=f[2];if(s=m-l,t=o-n,q=a-l,r=b-n,v=s*s+t*t,v>=JXG.Math.eps?(u=q*s+r*t,p=u/v,e=q*q+r*r-p*u):(p=0,e=q*q+r*r),p>=0&&1>=p&&y>e)return!0}return!1}return y>e},allocatePoints:function(){var a,b;if(b=this.numberPoints,this.points.length<this.numberPoints)for(a=this.points.length;b>a;a++)this.points[a]=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board)},update:function(){if(this.needsUpdate&&!this.board.needsFullUpdate&&this.Y&&this.Y.toJS){if(this.Y.toJS()==this.YtoJS&&this.Y.deps&&0===JXG.keys(this.Y.deps,!0).length)return this;this.YtoJS=this.Y.toJS()}return this.needsUpdate&&(this.visProp.trace&&this.cloneToBackground(!0),this.updateCurve()),this},updateRenderer:function(){return this.needsUpdate&&this.visProp.visible&&(this.board.renderer.updateCurve(this),this.needsUpdate=!1,this.hasLabel&&this.label.content.visProp.visible&&(this.label.content.update(),this.board.renderer.updateText(this.label.content))),this},updateDataArray:function(){},updateCurve:function(){var a,b,c,d,e,f,g=!1;if(this.updateDataArray(),b=this.minX(),c=this.maxX(),null!=this.dataX)for(this.numberPoints=this.dataX.length,a=this.numberPoints,this.allocatePoints(),f=0;a>f;f++)d=f,e=null!=this.dataY?f:this.X(d),this.points[f].setCoordinates(JXG.COORDS_BY_USER,[this.X(d,g),this.Y(e,g)],!1),this.updateTransform(this.points[f]),g=!0;else this.visProp.doadvancedplot?this.updateParametricCurve(b,c,a):(this.numberPoints=this.board.updateQuality==this.board.BOARD_QUALITY_HIGH?this.visProp.numberpointshigh:this.visProp.numberpointslow,this.allocatePoints(),this.updateParametricCurveNaive(b,c,this.numberPoints));return this},updateParametricCurveNaive:function(a,b,c){var d,e,f=!1,g=(b-a)/c;for(d=0;c>d;d++)e=a+d*g,this.points[d].setCoordinates(JXG.COORDS_BY_USER,[this.X(e,f),this.Y(e,f)],!1),this.updateTransform(this.points[d]),f=!0;return this},updateParametricCurve:function(a,b){var c,d,e,h,i,j,k,l,m,n,o,p,w,f=!1,g=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board),q=[],r=[],s=[],t=[],u=!1,v=0,x=function(a,b,c){var i,j,d=c[1]-a[1],e=c[2]-a[2],f=b[0]-a[1],g=b[1]-a[2],h=f*f+g*g;return h>=JXG.Math.eps&&(i=(d*f+e*g)/h,i>0&&(1>=i?(d-=i*f,e-=i*g):(d-=f,e-=g))),j=d*d+e*e,Math.sqrt(j)};for(this.board.updateQuality==this.board.BOARD_QUALITY_LOW?(n=15,o=10,p=10):(n=21,o=.7,p=.7),t[0]=b-a,c=1;n>c;c++)t[c]=.5*t[c-1];c=1,q[0]=1,r[0]=0,d=a,g.setCoordinates(JXG.COORDS_BY_USER,[this.X(d,f),this.Y(d,f)],!1),f=!0,j=g.scrCoords[1],k=g.scrCoords[2],e=d,d=b,g.setCoordinates(JXG.COORDS_BY_USER,[this.X(d,f),this.Y(d,f)],!1),h=g.scrCoords[1],i=g.scrCoords[2],s[0]=[h,i],l=1,m=0,this.points=[],this.points[v++]=new JXG.Coords(JXG.COORDS_BY_SCREEN,[j,k],this.board);do{for(u=this.isDistOK(h-j,i-k,o,p)||this.isSegmentOutside(j,k,h,i);n>m&&(!u||3>m)&&(7>=m||this.isSegmentDefined(j,k,h,i));)q[l]=c,r[l]=m,s[l]=[h,i],l++,c=2*c-1,m++,d=a+c*t[m],g.setCoordinates(JXG.COORDS_BY_USER,[this.X(d,f),this.Y(d,f)],!1),h=g.scrCoords[1],i=g.scrCoords[2],u=this.isDistOK(h-j,i-k,o,p)||this.isSegmentOutside(j,k,h,i);v>1&&(w=x(this.points[v-2].scrCoords,[h,i],this.points[v-1].scrCoords),.015>w&&v--),this.points[v]=new JXG.Coords(JXG.COORDS_BY_SCREEN,[h,i],this.board),this.updateTransform(this.points[v]),v++,j=h,k=i,e=d,l--,h=s[l][0],i=s[l][1],m=r[l]+1,c=2*q[l]}while(l>0&&5e5>v);return this.numberPoints=this.points.length,this},isSegmentOutside:function(a,b,c,d){return 0>b&&0>d||b>this.board.canvasHeight&&d>this.board.canvasHeight||0>a&&0>c||a>this.board.canvasWidth&&c>this.board.canvasWidth},isDistOK:function(a,b,c,d){return Math.abs(a)<c&&Math.abs(b)<d&&!isNaN(a+b)},isSegmentDefined:function(a,b,c,d){return!(isNaN(a+b)&&isNaN(c+d))},updateTransform:function(a){var b,c,d,e=this.transformations.length;for(d=0;e>d;d++)b=this.transformations[d],b.update(),c=JXG.Math.matVecMult(b.matrix,a.usrCoords),a.setCoordinates(JXG.COORDS_BY_USER,[c[1],c[2]]);return a},addTransform:function(a){var b,c=JXG.isArray(a)?a:[a],d=c.length;for(b=0;d>b;b++)this.transformations.push(c[b]);return this},setPosition:function(a,b){var c;return b=new JXG.Coords(a,b,this.board),c=this.board.create("transform",b.usrCoords.slice(1),{type:"translate"}),this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(c):this.addTransform(c),this},generateTerm:function(a,b,c,d,e){var f,g;JXG.isArray(b)?(this.dataX=b,this.X=function(a){var c,d,b=parseInt(Math.floor(a));return 0>a?b=0:a>this.dataX.length-2&&(b=this.dataX.length-2),b==a?this.dataX[b]:(c=this.dataX[b],d=this.dataX[b+1],c+(d-c)*(a-b))},this.visProp.curvetype="plot",this.numberPoints=this.dataX.length):(this.X=JXG.createFunction(b,this.board,a),JXG.isString(b)?this.visProp.curvetype="functiongraph":(JXG.isFunction(b)||JXG.isNumber(b))&&(this.visProp.curvetype="parameter")),JXG.isArray(c)?(this.dataY=c,this.Y=function(a){var c,d,b=parseInt(Math.floor(a));
return 0>a?b=0:a>this.dataY.length-2&&(b=this.dataY.length-2),b==a?JXG.isFunction(this.dataY[b])?this.dataY[b]():this.dataY[b]:(c=JXG.isFunction(this.dataY[b])?this.dataY[b]():this.dataY[b],d=JXG.isFunction(this.dataY[b+1])?this.dataY[b+1]():this.dataY[b+1],c+(d-c)*(a-b))}):this.Y=JXG.createFunction(c,this.board,a),JXG.isFunction(b)&&JXG.isArray(c)&&(f=JXG.createFunction(c[0],this.board,""),g=JXG.createFunction(c[1],this.board,""),this.X=function(a){return b(a)*Math.cos(a)+f()},this.Y=function(a){return b(a)*Math.sin(a)+g()},this.visProp.curvetype="polar"),null!=d&&(this.minX=JXG.createFunction(d,this.board,"")),null!=e&&(this.maxX=JXG.createFunction(e,this.board,""))},notifyParents:function(a){JXG.GeonextParser.findDependencies(this,a,this.board)},getLabelAnchor:function(){var a,b,c,d=.05*this.board.canvasWidth,e=.05*this.board.canvasHeight,f=.95*this.board.canvasWidth,g=.95*this.board.canvasHeight;switch(this.visProp.label.position){case"ulft":b=d,c=e;break;case"llft":b=d,c=g;break;case"rt":b=f,c=.5*g;break;case"lrt":b=f,c=g;break;case"urt":b=f,c=e;break;case"top":b=.5*f,c=e;break;case"bot":b=.5*f,c=g;break;case"lft":default:b=d,c=.5*g}return a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[b,c],this.board),JXG.Math.Geometry.projectCoordsToCurve(a.usrCoords[1],a.usrCoords[2],0,this,this.board)[0]},cloneToBackground:function(){var b,a={};return a.id=this.id+"T"+this.numTraces,a.elementClass=JXG.OBJECT_CLASS_CURVE,this.numTraces++,a.points=this.points.slice(0),a.numberPoints=this.numberPoints,a.board=this.board,a.visProp=JXG.deepCopy(this.visProp,this.visProp.traceattributes,!0),a.visProp.layer=this.board.options.layer.trace,a.visProp.curvetype=this.visProp.curvetype,JXG.clearVisPropOld(a),b=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawCurve(a),this.board.renderer.enhancedRendering=b,this.traces[a.id]=a.rendNode,this},bounds:function(){var f,a=1/0,b=-1/0,c=1/0,d=-1/0,e=this.points.length;for(f=0;e>f;f++)a>this.points[f].usrCoords[1]&&(a=this.points[f].usrCoords[1]),b<this.points[f].usrCoords[1]&&(b=this.points[f].usrCoords[1]),c>this.points[f].usrCoords[2]&&(c=this.points[f].usrCoords[2]),d<this.points[f].usrCoords[2]&&(d=this.points[f].usrCoords[2]);return[a,d,b,c]}}),JXG.createCurve=function(a,b,c){var d=JXG.copyAttributes(c,a.options,"curve");return new JXG.Curve(a,["x"].concat(b),d)},JXG.JSXGraph.registerElement("curve",JXG.createCurve),JXG.createFunctiongraph=function(a,b,c){var d,e=["x","x"].concat(b);return d=JXG.copyAttributes(c,a.options,"curve"),d.curvetype="functiongraph",new JXG.Curve(a,e,d)},JXG.JSXGraph.registerElement("functiongraph",JXG.createFunctiongraph),JXG.JSXGraph.registerElement("plot",JXG.createFunctiongraph),JXG.createSpline=function(a,b,c){var d;return d=function(){var a,c=[],d=[],e=function(e,f){var g;if(!f){if(c=[],d=[],2==b.length&&JXG.isArray(b[0])&&JXG.isArray(b[1])&&b[0].length==b[1].length)for(g=0;g<b[0].length;g++)"function"==typeof b[0][g]?c.push(b[0][g]()):c.push(b[0][g]),"function"==typeof b[1][g]?d.push(b[1][g]()):d.push(b[1][g]);else for(g=0;g<b.length;g++)if(JXG.isPoint(b[g]))c.push(b[g].X()),d.push(b[g].Y());else if(JXG.isArray(b[g])&&2==b[g].length)for(g=0;g<b.length;g++)"function"==typeof b[g][0]?c.push(b[g][0]()):c.push(b[g][0]),"function"==typeof b[g][1]?d.push(b[g][1]()):d.push(b[g][1]);a=JXG.Math.Numerics.splineDef(c,d)}return JXG.Math.Numerics.splineEval(e,c,d,a)};return e},a.create("curve",["x",d()],c)},JXG.JSXGraph.registerElement("spline",JXG.createSpline),JXG.createRiemannsum=function(a,b,c){var d,e,f,g,h,i;if(i=JXG.copyAttributes(c,a.options,"riemannsum"),i.curvetype="plot",f=b[0],d=JXG.createFunction(b[1],a,""),null==d)throw new Error("JSXGraph: JXG.createRiemannsum: argument '2' n has to be number or function.\nPossible parent types: [function,n:number|function,type,start:number|function,end:number|function]");if(e=JXG.createFunction(b[2],a,"",!1),null==e)throw new Error("JSXGraph: JXG.createRiemannsum: argument 3 'type' has to be string or function.\nPossible parent types: [function,n:number|function,type,start:number|function,end:number|function]");return g=[[0],[0]].concat(b.slice(3)),h=a.create("curve",g,i),h.updateDataArray=function(){var a=JXG.Math.Numerics.riemann(f,d(),e(),this.minX(),this.maxX());this.dataX=a[0],this.dataY=a[1]},h},JXG.JSXGraph.registerElement("riemannsum",JXG.createRiemannsum),JXG.createTracecurve=function(a,b,c){var d,e,f,g;if(2!=b.length)throw new Error("JSXGraph: Can't create trace curve with given parent'\nPossible parent types: [glider, point]");if(e=JXG.getRef(this.board,b[0]),f=JXG.getRef(this.board,b[1]),e.type!=JXG.OBJECT_TYPE_GLIDER||!JXG.isPoint(f))throw new Error("JSXGraph: Can't create trace curve with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [glider, point]");return g=JXG.copyAttributes(c,a.options,"tracecurve"),g.curvetype="plot",d=a.create("curve",[[0],[0]],g),d.updateDataArray=function(){var a,b,c,d,h,i,j,m,r,l=g.numberpoints,n=e.position,o=e.slideObject,p=o.minX(),q=o.maxX();for(b=(q-p)/l,this.dataX=[],this.dataY=[],o.elementClass!=JXG.OBJECT_CLASS_CURVE&&l++,a=0;l>a;a++){c=p+a*b,i=o.X(c)/o.Z(c),j=o.Y(c)/o.Z(c),e.setPositionDirectly(JXG.COORDS_BY_USER,[i,j]),m=!1;for(d in this.board.objects)if(h=this.board.objects[d],h==e&&(m=!0),m&&h.needsRegularUpdate&&(r=h.visProp.trace,h.visProp.trace=!1,h.needsUpdate=!0,h.update(!0),h.visProp.trace=r,h==f))break;this.dataX[a]=f.X(),this.dataY[a]=f.Y()}e.position=n,m=!1;for(d in this.board.objects)if(h=this.board.objects[d],h==e&&(m=!0),m&&h.needsRegularUpdate&&(r=h.visProp.trace,h.visProp.trace=!1,h.needsUpdate=!0,h.update(!0),h.visProp.trace=r,h==f))break},d},JXG.JSXGraph.registerElement("tracecurve",JXG.createTracecurve),JXG.createArc=function(a,b,c){var d,e,f;if(!(b=JXG.checkParents("arc",b,[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT],[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]])))throw new Error("JSXGraph: Can't create Arc with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"' and '"+typeof b[2]+"'.\nPossible parent types: [point,point,point]");for(e=JXG.copyAttributes(c,a.options,"arc"),d=a.create("curve",[[0],[0]],e),d.elType="arc",d.parents=[],f=0;f<b.length;f++)b[f].id&&d.parents.push(b[f].id);return d.type=JXG.OBJECT_TYPE_ARC,d.center=JXG.getReference(a,b[0]),d.radiuspoint=JXG.getReference(a,b[1]),d.point2=d.radiuspoint,d.anglepoint=JXG.getReference(a,b[2]),d.point3=d.anglepoint,d.center.addChild(d),d.radiuspoint.addChild(d),d.anglepoint.addChild(d),d.useDirection=e.usedirection,d.updateDataArray=function(){var e,f,g,h,i,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,a=this.radiuspoint,c=this.center,d=this.anglepoint,k=c.X(),l=c.Y(),m=c.Z(),D=1,E=.5*Math.PI;for(i=JXG.Math.Geometry.rad(a,c,d),("minor"==this.visProp.type&&i>Math.PI||"major"==this.visProp.type&&i<Math.PI)&&(i=2*Math.PI-i,D=-1),this.useDirection&&(p=b[1].coords.usrCoords,q=b[3].coords.usrCoords,r=b[2].coords.usrCoords,o=(p[1]-r[1])*(p[2]-q[2])-(p[2]-r[2])*(p[1]-q[1]),0>o?(this.radiuspoint=b[1],this.anglepoint=b[2]):(this.radiuspoint=b[2],this.anglepoint=b[1])),s=[a.Z(),a.X(),a.Y()],v=s.slice(0),C=c.Dist(a),k/=m,l/=m,this.dataX=[s[1]/s[0]],this.dataY=[s[2]/s[0]];i>JXG.Math.eps;)i>=E?(e=E,i-=E):(e=i,i=0),f=Math.cos(D*e),g=Math.sin(D*e),h=[[1,0,0],[k*(1-f)+l*g,f,-g],[l*(1-f)-k*g,g,f]],n=JXG.Math.matVecMult(h,s),v=[n[0]/n[0],n[1]/n[0],n[2]/n[0]],x=s[1]-k,y=s[2]-l,z=v[1]-k,A=v[2]-l,B=Math.sqrt((x+z)*(x+z)+(y+A)*(y+A)),w=Math.abs(A-y)>JXG.Math.eps?8*((x+z)*(C/B-.5)/(A-y))/3:8*((y+A)*(C/B-.5)/(x-z))/3,t=[1,s[1]-w*y,s[2]+w*x],u=[1,v[1]+w*A,v[2]-w*z],this.dataX=this.dataX.concat([t[1],u[1],v[1]]),this.dataY=this.dataY.concat([t[2],u[2],v[2]]),s=v.slice(0);this.bezierDegree=3,this.updateStdform(),this.updateQuadraticform()},d.Radius=function(){return this.radiuspoint.Dist(this.center)},d.getRadius=function(){return this.Radius()},d.hasPoint=function(a,b){var h,i,j,c=this.board.options.precision.hasPoint/this.board.unitX,d=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,b],this.board),e=this.Radius(),f=this.center.coords.distance(JXG.COORDS_BY_USER,d),g=Math.abs(f-e)<c;return g&&(h=JXG.Math.Geometry.rad(this.radiuspoint,this.center,d.usrCoords.slice(1)),i=0,j=JXG.Math.Geometry.rad(this.radiuspoint,this.center,this.anglepoint),("minor"==this.visProp.type&&j>Math.PI||"major"==this.visProp.type&&j<Math.PI)&&(i=j,j=2*Math.PI),(i>h||h>j)&&(g=!1)),g},d.hasPointSector=function(a,b){var g,h,i,c=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,b],this.board),d=this.Radius(),e=this.center.coords.distance(JXG.COORDS_BY_USER,c),f=d>e;return f&&(g=JXG.Math.Geometry.rad(this.radiuspoint,this.center,c.usrCoords.slice(1)),h=0,i=JXG.Math.Geometry.rad(this.radiuspoint,this.center,this.anglepoint),("minor"==this.visProp.type&&i>Math.PI||"major"==this.visProp.type&&i<Math.PI)&&(h=i,i=2*Math.PI),(h>g||g>i)&&(f=!1)),f},d.getTextAnchor=function(){return this.center.coords},d.getLabelAnchor=function(){var a,h,i,j,k,b=10/this.board.unitX,c=10/this.board.unitY,d=this.point2.coords.usrCoords,e=this.center.coords.usrCoords,f=d[1]-e[1],g=d[2]-e[2];return null!=this.label.content&&(this.label.content.relativeCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this.board)),a=JXG.Math.Geometry.rad(this.radiuspoint,this.center,this.anglepoint),("minor"==this.visProp.type&&a>Math.PI||"major"==this.visProp.type&&a<Math.PI)&&(a=-(2*Math.PI-a)),h=new JXG.Coords(JXG.COORDS_BY_USER,[e[1]+Math.cos(.5*a)*f-Math.sin(.5*a)*g,e[2]+Math.sin(.5*a)*f+Math.cos(.5*a)*g],this.board),i=h.usrCoords[1]-e[1],j=h.usrCoords[2]-e[2],k=Math.sqrt(i*i+j*j),i=i*(k+b)/k,j=j*(k+c)/k,new JXG.Coords(JXG.COORDS_BY_USER,[e[1]+i,e[2]+j],this.board)},d.updateQuadraticform=function(){var a=this.center,b=a.X(),c=a.Y(),d=this.Radius();this.quadraticform=[[b*b+c*c-d*d,-b,-c],[-b,1,0],[-c,0,1]]},d.updateStdform=function(){this.stdform[3]=.5,this.stdform[4]=this.Radius(),this.stdform[1]=-this.center.coords.usrCoords[1],this.stdform[2]=-this.center.coords.usrCoords[2],this.normalize()},d.prepareUpdate().update(),d},JXG.JSXGraph.registerElement("arc",JXG.createArc),JXG.createSemicircle=function(a,b,c){var d,e,f;if(!JXG.isPoint(b[0])||!JXG.isPoint(b[1]))throw new Error("JSXGraph: Can't create Semicircle with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point]");return f=JXG.copyAttributes(c,a.options,"semicircle","midpoint"),e=a.create("midpoint",[b[0],b[1]],f),e.dump=!1,f=JXG.copyAttributes(c,a.options,"semicircle"),d=a.create("arc",[e,b[1],b[0]],f),d.elType="semicircle",d.parents=[b[0].id,b[1].id],d.subs={midpoint:e},d.midpoint=e,d},JXG.JSXGraph.registerElement("semicircle",JXG.createSemicircle),JXG.createCircumcircleArc=function(a,b,c){var d,e,f;if(!(JXG.isPoint(b[0])&&JXG.isPoint(b[1])&&JXG.isPoint(b[2])))throw new Error("JSXGraph: create Circumcircle Arc with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"' and '"+typeof b[2]+"'.\nPossible parent types: [point,point,point]");return f=JXG.copyAttributes(c,a.options,"circumcirclearc","center"),e=a.create("circumcenter",[b[0],b[1],b[2]],f),e.dump=!1,f=JXG.copyAttributes(c,a.options,"circumcirclearc"),f.usedirection=!0,d=a.create("arc",[e,b[0],b[2],b[1]],f),d.elType="circumcirclearc",d.parents=[b[0].id,b[1].id,b[2].id],d.subs={center:e},d.center=e,d},JXG.JSXGraph.registerElement("circumcirclearc",JXG.createCircumcircleArc),JXG.createMinorArc=function(a,b,c){return c.type="minor",JXG.createArc(a,b,c)},JXG.JSXGraph.registerElement("minorarc",JXG.createMinorArc),JXG.createMajorArc=function(a,b,c){return c.type="major",JXG.createArc(a,b,c)},JXG.JSXGraph.registerElement("majorarc",JXG.createMajorArc),JXG.createSector=function(a,b,c){var d,e;if(!(JXG.isPoint(b[0])&&JXG.isPoint(b[1])&&JXG.isPoint(b[2])))throw new Error("JSXGraph: Can't create Sector with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"' and '"+typeof b[2]+"'.");return e=JXG.copyAttributes(c,a.options,"sector"),d=a.create("curve",[[0],[0]],e),d.type=JXG.OBJECT_TYPE_SECTOR,d.elType="sector",d.parents=[b[0].id,b[1].id,b[2].id],d.point1=JXG.getReference(a,b[0]),d.center=d.point1,d.point2=JXG.getReference(a,b[1]),d.radiuspoint=d.point2,d.point3=JXG.getReference(a,b[2]),d.anglepoint=d.point3,d.point1.addChild(d),d.point2.addChild(d),d.point3.addChild(d),d.useDirection=c.usedirection,d.updateDataArray=function(){var e,f,g,h,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,a=this.point2,c=this.point1,d=this.point3,i=JXG.Math.Geometry.rad(a,c,d),k=c.X(),l=c.Y(),m=c.Z(),D=.5*Math.PI;for(this.useDirection&&(p=b[1].coords.usrCoords,q=b[3].coords.usrCoords,r=b[2].coords.usrCoords,o=(p[1]-r[1])*(p[2]-q[2])-(p[2]-r[2])*(p[1]-q[1]),0>o?(this.point2=b[1],this.point3=b[2]):(this.point2=b[2],this.point3=b[1])),C=c.Dist(a),s=[a.Z(),a.X(),a.Y()],s[1]/=s[0],s[2]/=s[0],s[0]/=s[0],v=s.slice(0),k/=m,l/=m,this.dataX=[k,k+.333*(s[1]-k),k+.666*(s[1]-k),s[1]],this.dataY=[l,l+.333*(s[2]-l),l+.666*(s[2]-l),s[2]];i>JXG.Math.eps;)i>=D?(e=D,i-=D):(e=i,i=0),f=Math.cos(e),g=Math.sin(e),h=[[1,0,0],[k*(1-f)+l*g,f,-g],[l*(1-f)-k*g,g,f]],n=JXG.Math.matVecMult(h,s),v=[n[0]/n[0],n[1]/n[0],n[2]/n[0]],x=s[1]-k,y=s[2]-l,z=v[1]-k,A=v[2]-l,B=Math.sqrt((x+z)*(x+z)+(y+A)*(y+A)),w=Math.abs(A-y)>JXG.Math.eps?8*((x+z)*(C/B-.5)/(A-y))/3:8*((y+A)*(C/B-.5)/(x-z))/3,t=[1,s[1]-w*y,s[2]+w*x],u=[1,v[1]+w*A,v[2]-w*z],this.dataX=this.dataX.concat([t[1],u[1],v[1]]),this.dataY=this.dataY.concat([t[2],u[2],v[2]]),s=v.slice(0);this.dataX=this.dataX.concat([v[1]+.333*(k-v[1]),v[1]+.666*(k-v[1]),k]),this.dataY=this.dataY.concat([v[2]+.333*(l-v[2]),v[2]+.666*(l-v[2]),l]),this.bezierDegree=3},d.Radius=function(){return this.point2.Dist(this.point1)},d.getRadius=function(){return this.Radius()},d.hasPoint=function(a,b){var h,i,j,c=this.board.options.precision.hasPoint/this.board.unitX,d=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,b],this.board),e=this.Radius(),f=this.center.coords.distance(JXG.COORDS_BY_USER,d),g=Math.abs(f-e)<c;return g&&(h=JXG.Math.Geometry.rad(this.point2,this.center,d.usrCoords.slice(1)),i=0,j=JXG.Math.Geometry.rad(this.point2,this.center,this.point3),(i>h||h>j)&&(g=!1)),g},d.hasPointSector=function(a,b){var g,c=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,b],this.board),d=this.Radius(),e=this.point1.coords.distance(JXG.COORDS_BY_USER,c),f=d>e;return f&&(g=JXG.Math.Geometry.rad(this.point2,this.point1,c.usrCoords.slice(1)),g>JXG.Math.Geometry.rad(this.point2,this.point1,this.point3)&&(f=!1)),f},d.getTextAnchor=function(){return this.point1.coords},d.getLabelAnchor=function(){var h,i,j,k,a=JXG.Math.Geometry.rad(this.point2,this.point1,this.point3),b=13/this.board.unitX,c=13/this.board.unitY,d=this.point2.coords.usrCoords,e=this.point1.coords.usrCoords,f=d[1]-e[1],g=d[2]-e[2];return null!=this.label.content&&(this.label.content.relativeCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this.board)),h=new JXG.Coords(JXG.COORDS_BY_USER,[e[1]+Math.cos(.5*a)*f-Math.sin(.5*a)*g,e[2]+Math.sin(.5*a)*f+Math.cos(.5*a)*g],this.board),i=h.usrCoords[1]-e[1],j=h.usrCoords[2]-e[2],k=Math.sqrt(i*i+j*j),i=i*(k+b)/k,j=j*(k+c)/k,new JXG.Coords(JXG.COORDS_BY_USER,[e[1]+i,e[2]+j],this.board)},d.prepareUpdate().update(),d},JXG.JSXGraph.registerElement("sector",JXG.createSector),JXG.createCircumcircleSector=function(a,b,c){var d,e,f;if(!(JXG.isPoint(b[0])&&JXG.isPoint(b[1])&&JXG.isPoint(b[2])))throw new Error("JSXGraph: Can't create circumcircle sector with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"' and '"+typeof b[2]+"'.");return f=JXG.copyAttributes(c,a.options,"circumcirclesector","center"),e=a.create("circumcenter",[b[0],b[1],b[2]],f),e.dump=!1,f=JXG.copyAttributes(c,a.options,"circumcirclesector"),d=a.create("sector",[e,b[0],b[2],b[1]],f),d.elType="circumcirclesector",d.parents=[b[0].id,b[1].id,b[2].id],d.center=e,d.subs={center:e},d},JXG.JSXGraph.registerElement("circumcirclesector",JXG.createCircumcircleSector),JXG.createAngle=function(a,b,c){var d,e,f,g,h,i,j,k;if(!(JXG.isPoint(b[0])&&JXG.isPoint(b[1])&&JXG.isPoint(b[2])))throw new Error("JSXGraph: Can't create angle with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"' and '"+typeof b[2]+"'.");for(h=JXG.copyAttributes(c,a.options,"angle"),g=h.name,("undefined"==typeof g||""==g)&&(g=a.generateName({type:JXG.OBJECT_TYPE_ANGLE}),h.name=g),i=JXG.copyAttributes(c,a.options,"angle","radiuspoint"),e=a.create("point",[0,1,0],i),e.dump=!1,i=JXG.copyAttributes(c,a.options,"angle","pointsquare"),f=a.create("point",[0,1,1],i),f.dump=!1,d=a.create("sector",[b[1],e,b[2]],h),d.elType="angle",d.parents=[b[0].id,b[1].id,b[2].id],d.subs={point:e,pointsquare:f},d.updateDataArraySquare=function(){var c,d,g,h,a=b[1];c=JXG.Math.crossProduct(f.coords.usrCoords,a.coords.usrCoords),d=[-e.X()*c[1]-e.Y()*c[2],e.Z()*c[1],e.Z()*c[2]],c=JXG.Math.crossProduct(e.coords.usrCoords,a.coords.usrCoords),g=[-f.X()*c[1]-f.Y()*c[2],f.Z()*c[1],f.Z()*c[2]],h=JXG.Math.crossProduct(d,g),h[1]/=h[0],h[2]/=h[0],this.dataX=[a.X(),e.X(),h[1],f.X(),a.X()],this.dataY=[a.Y(),e.Y(),h[2],f.Y(),a.Y()],this.bezierDegree=1},d.updateDataArrayNone=function(){this.dataX=[0/0],this.dataY=[0/0],this.bezierDegree=1},d.updateDataArraySector=d.updateDataArray,d.updateDataArray=function(){var a=this.visProp.type,c=JXG.Math.Geometry.trueAngle(b[0],b[1],b[2]);Math.abs(c-90)<this.visProp.orthosensitivity&&(a=this.visProp.orthotype),"none"==a?this.updateDataArrayNone():"square"===a?this.updateDataArraySquare():"sector"===a?this.updateDataArraySector():"sectordot"===a&&(this.updateDataArraySector(),this.dot.visProp.visible===!1&&this.dot.setProperty({visible:!0}))},e.addConstraint([function(){var a=b[0],c=b[1],e=JXG.evaluate(d.visProp.radius),f=c.Dist(a);return[c.X()+(a.X()-c.X())*e/f,c.Y()+(a.Y()-c.Y())*e/f]}]),f.addConstraint([function(){var a=b[2],c=b[1],e=JXG.evaluate(d.visProp.radius),f=c.Dist(a);return[c.X()+(a.X()-c.X())*e/f,c.Y()+(a.Y()-c.Y())*e/f]}]),d.radiuspoint=e,d.point=e,d.pointsquare=f,k=JXG.copyAttributes(c,a.options,"angle","dot"),d.dot=a.create("point",[function(){if(JXG.exists(d.dot)&&d.dot.visProp.visible===!1)return[0,0];var a=e.coords.usrCoords,c=.5*JXG.Math.Geometry.rad(b[0],b[1],b[2]),f=b[1].X(),g=b[1].Y(),h=[[1,0,0],[f-.5*f*Math.cos(c)+.5*g*Math.sin(c),.5*Math.cos(c),.5*-Math.sin(c)],[g-.5*f*Math.sin(c)-.5*g*Math.cos(c),.5*Math.sin(c),.5*Math.cos(c)]];return JXG.Math.matVecMult(h,a)}],k),d.dot.dump=!1,d.subs.dot=d.dot,j=0;3>j;j++)JXG.getRef(a,b[j]).addChild(e),JXG.getRef(a,b[j]).addChild(d.dot);return d.type=JXG.OBJECT_TYPE_ANGLE,JXG.getRef(a,b[0]).addChild(d),d.rot=a.create("transform",[function(){return.5*JXG.Math.Geometry.rad(d.point2,d.point1,d.point3)},d.point1],{type:"rotate"}),d.getLabelAnchor=function(){var d,e,f,g,a=12,b=12,c=this.point1.coords.usrCoords;return null!=this.label.content&&(this.label.content.relativeCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this.board)),JXG.exists(this.visProp.label.fontSize)&&(a=this.visProp.label.fontSize,b=this.visProp.label.fontSize),a/=this.board.unitX,b/=this.board.unitY,this.rot.update(),g=JXG.Math.matVecMult(this.rot.matrix,this.point2.coords.usrCoords),d=g[1]-c[1],e=g[2]-c[2],f=Math.sqrt(d*d+e*e),d=d*(f+a)/f,e=e*(f+b)/f,new JXG.Coords(JXG.COORDS_BY_USER,[c[1]+d,c[2]+e],this.board)},d.Value=function(){return JXG.Math.Geometry.rad(this.point2,this.point1,this.point3)},d.methodMap=JXG.deepCopy(d.methodMap,{Value:"Value"}),d},JXG.JSXGraph.registerElement("angle",JXG.createAngle),JXG.Composition=function(a){var e,b=["setProperty","prepareUpdate","updateRenderer","update","highlight","noHighlight"],c=function(a){return function(){var b;for(b in d.elements)JXG.exists(d.elements[b][a])&&d.elements[b][a].apply(d.elements[b],arguments);return d}},d=this;for(e=0;e<b.length;e++)this[b[e]]=c(b[e]);this.elements={};for(e in a)a.hasOwnProperty(e)&&this.add(e,a[e]);this.dump=!0,this.subs={}},JXG.extend(JXG.Composition.prototype,{add:function(a,b){return!JXG.exists(this[a])&&JXG.exists(b)?(JXG.exists(b.id)?this.elements[b.id]=b:this.elements[a]=b,this[a]=b,!0):!1},remove:function(a){var c,b=!1;for(c in this.elements)if(this.elements[c].id===this[a].id){b=!0;break}return b&&(delete this.elements[this[a].id],delete this[a]),b},getParents:function(){return this.parents},getType:function(){return this.elType},getAttributes:function(){var b,a={};for(b in this.subs)a[b]=this.subs[b].visProp;return this.attr}}),JXG.createOrthogonalProjection=function(a,b,c){var d,e,f;if(JXG.isPoint(b[0])&&b[1].elementClass==JXG.OBJECT_CLASS_LINE)e=b[0],d=b[1];else{if(!JXG.isPoint(b[1])||b[0].elementClass!=JXG.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,line]");e=b[1],d=b[0]}return attr=JXG.copyAttributes(c,a.options,"orthogonalprojection"),f=a.create("point",[function(){return JXG.Math.Geometry.projectPointToLine(e,d,a)}],c),e.addChild(f),d.addChild(f),f.elType="orthogonalprojection",f.parents=[e.id,f.id],f.update(),f.generatePolynomial=function(){var a=d.point1.symbolic.x,b=d.point1.symbolic.y,c=d.point2.symbolic.x,g=d.point2.symbolic.y,h=e.symbolic.x,i=e.symbolic.y,j=f.symbolic.x,k=f.symbolic.y,l="("+b+")*("+j+")-("+b+")*("+c+")+("+k+")*("+c+")-("+a+")*("+k+")+("+a+")*("+g+")-("+j+")*("+g+")",m="("+i+")*("+b+")-("+i+")*("+g+")-("+k+")*("+b+")+("+k+")*("+g+")+("+h+")*("+a+")-("+h+")*("+c+")-("+j+")*("+a+")+("+j+")*("+c+")";return[l,m]},f},JXG.createPerpendicular=function(a,b,c){var d,e,f,g;if(b[0]=JXG.getReference(a,b[0]),b[1]=JXG.getReference(a,b[1]),JXG.isPoint(b[0])&&b[1].elementClass==JXG.OBJECT_CLASS_LINE)e=b[1],d=b[0];else{if(!JXG.isPoint(b[1])||b[0].elementClass!=JXG.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [line,point]");e=b[0],d=b[1]}return g=JXG.copyAttributes(c,a.options,"perpendicular"),f=JXG.createLine(a,[function(){return e.stdform[2]*d.X()-e.stdform[1]*d.Y()},function(){return-e.stdform[2]*d.Z()},function(){return e.stdform[1]*d.Z()}],g),f.elType="perpendicular",f.parents=[e.id,d.id],f},JXG.createPerpendicularPoint=function(a,b,c){var d,e,f;if(JXG.isPoint(b[0])&&b[1].elementClass==JXG.OBJECT_CLASS_LINE)e=b[0],d=b[1];else{if(!JXG.isPoint(b[1])||b[0].elementClass!=JXG.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,line]");e=b[1],d=b[0]}return f=a.create("point",[function(){return JXG.Math.Geometry.perpendicular(d,e,a)[0]}],c),e.addChild(f),d.addChild(f),f.elType="perpendicularpoint",f.parents=[e.id,d.id],f.update(),f.generatePolynomial=function(){var a=d.point1.symbolic.x,b=d.point1.symbolic.y,c=d.point2.symbolic.x,g=d.point2.symbolic.y,h=e.symbolic.x,i=e.symbolic.y,j=f.symbolic.x,k=f.symbolic.y,l="("+b+")*("+j+")-("+b+")*("+c+")+("+k+")*("+c+")-("+a+")*("+k+")+("+a+")*("+g+")-("+j+")*("+g+")",m="("+i+")*("+b+")-("+i+")*("+g+")-("+k+")*("+b+")+("+k+")*("+g+")+("+h+")*("+a+")-("+h+")*("+c+")-("+j+")*("+a+")+("+j+")*("+c+")";return[l,m]},f},JXG.createPerpendicularSegment=function(a,b,c){var d,e,f,g,h;if(b[0]=JXG.getReference(a,b[0]),b[1]=JXG.getReference(a,b[1]),JXG.isPoint(b[0])&&b[1].elementClass==JXG.OBJECT_CLASS_LINE)e=b[1],d=b[0];else{if(!JXG.isPoint(b[1])||b[0].elementClass!=JXG.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [line,point]");e=b[0],d=b[1]}return h=JXG.copyAttributes(c,a.options,"perpendicularsegment","point"),g=JXG.createPerpendicularPoint(a,[e,d],h),g.dump=!1,JXG.exists(c.layer)||(c.layer=a.options.layer.line),h=JXG.copyAttributes(c,a.options,"perpendicularsegment"),f=JXG.createLine(a,[function(){return JXG.Math.Geometry.perpendicular(e,d,a)[1]?[g,d]:[d,g]}],h),f.point=g,f.elType="perpendicularsegment",f.parents=[d.id,e.id],f.subs={point:g},f},JXG.createMidpoint=function(a,b,c){var d,e,f;if(2==b.length&&JXG.isPoint(b[0])&&JXG.isPoint(b[1]))d=b[0],e=b[1];else{if(1!=b.length||b[0].elementClass!=JXG.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create midpoint.\nPossible parent types: [point,point], [line]");d=b[0].point1,e=b[0].point2}return f=a.create("point",[function(){var a=d.coords.usrCoords[1]+e.coords.usrCoords[1];return isNaN(a)||Math.abs(d.coords.usrCoords[0])<JXG.Math.eps||Math.abs(e.coords.usrCoords[0])<JXG.Math.eps?0/0:.5*a},function(){var a=d.coords.usrCoords[2]+e.coords.usrCoords[2];return isNaN(a)||Math.abs(d.coords.usrCoords[0])<JXG.Math.eps||Math.abs(e.coords.usrCoords[0])<JXG.Math.eps?0/0:.5*a}],c),d.addChild(f),e.addChild(f),f.elType="midpoint",f.parents=[d.id,e.id],f.prepareUpdate().update(),f.generatePolynomial=function(){var a=d.symbolic.x,b=d.symbolic.y,c=e.symbolic.x,g=e.symbolic.y,h=f.symbolic.x,i=f.symbolic.y,j="("+b+")*("+h+")-("+b+")*("+c+")+("+i+")*("+c+")-("+a+")*("+i+")+("+a+")*("+g+")-("+h+")*("+g+")",k="("+a+")^2 - 2*("+a+")*("+h+")+("+b+")^2-2*("+b+")*("+i+")-("+c+")^2+2*("+c+")*("+h+")-("+g+")^2+2*("+g+")*("+i+")";return[j,k]},f},JXG.createParallelPoint=function(a,b,c){var d,e,f,g;if(3==b.length&&b[0].elementClass==JXG.OBJECT_CLASS_POINT&&b[1].elementClass==JXG.OBJECT_CLASS_POINT&&b[2].elementClass==JXG.OBJECT_CLASS_POINT)d=b[0],e=b[1],f=b[2];else if(b[0].elementClass==JXG.OBJECT_CLASS_POINT&&b[1].elementClass==JXG.OBJECT_CLASS_LINE)f=b[0],d=b[1].point1,e=b[1].point2;else{if(b[1].elementClass!=JXG.OBJECT_CLASS_POINT||b[0].elementClass!=JXG.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create parallel point with parent types '"+typeof b[0]+"', '"+typeof b[1]+"' and '"+typeof b[2]+"'.\nPossible parent types: [line,point], [point,point,point]");f=b[1],d=b[0].point1,e=b[0].point2}return g=a.create("point",[function(){return f.coords.usrCoords[1]+e.coords.usrCoords[1]-d.coords.usrCoords[1]},function(){return f.coords.usrCoords[2]+e.coords.usrCoords[2]-d.coords.usrCoords[2]}],c),d.addChild(g),e.addChild(g),f.addChild(g),g.elType="parallelpoint",g.parents=[d.id,e.id,f.id],g.prepareUpdate().update(),g.generatePolynomial=function(){var a=d.symbolic.x,b=d.symbolic.y,c=e.symbolic.x,h=e.symbolic.y,i=f.symbolic.x,j=f.symbolic.y,k=g.symbolic.x,l=g.symbolic.y,m="("+h+")*("+k+")-("+h+")*("+i+")-("+b+")*("+k+")+("+b+")*("+i+")-("+l+")*("+c+")+("+l+")*("+a+")+("+j+")*("+c+")-("+j+")*("+a+")",n="("+l+")*("+a+")-("+l+")*("+i+")-("+h+")*("+a+")+("+h+")*("+i+")-("+k+")*("+b+")+("+k+")*("+j+")+("+c+")*("+b+")-("+c+")*("+j+")";return[m,n]},g},JXG.createParallel=function(a,b,c){var d,e,f,g,h;return d=null,3==b.length?(d=b[2],g=function(){return JXG.Math.crossProduct(b[0].coords.usrCoords,b[1].coords.usrCoords)}):b[0].elementClass==JXG.OBJECT_CLASS_POINT?(d=b[0],g=function(){return b[1].stdform}):b[1].elementClass==JXG.OBJECT_CLASS_POINT&&(d=b[1],g=function(){return b[0].stdform}),JXG.exists(c.layer)||(c.layer=a.options.layer.line),h=JXG.copyAttributes(c,a.options,"parallel","point"),e=a.create("point",[function(){return JXG.Math.crossProduct([1,0,0],g())}],h),e.isDraggable=!0,h=JXG.copyAttributes(c,a.options,"parallel"),f=a.create("line",[d,e],h),f.elType="parallel",f.parents=[b[0].id,b[1].id],3===b.length&&f.parents.push(b[2].id),f.point=e,f},JXG.createArrowParallel=function(a,b,c){var d;try{return c.firstArrow=!1,c.lastArrow=!0,d=JXG.createParallel(a,b,c).setStraight(!1,!1),d.elType="arrowparallel",d}catch(e){throw new Error("JSXGraph: Can't create arrowparallel with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [line,point], [point,point,point]")}},JXG.createNormal=function(a,b,c){var d,e,f,g,h,i,j;if(1==b.length)d=b[0],e=d.slideObject;else{if(2!=b.length)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,line], [point,circle], [glider]");if(JXG.isPoint(b[0]))d=b[0],e=b[1];else{if(!JXG.isPoint(b[1]))throw new Error("JSXGraph: Can't create normal with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,line], [point,circle], [glider]");e=b[0],d=b[1]}}if(h=JXG.copyAttributes(c,a.options,"normal"),e.elementClass==JXG.OBJECT_CLASS_LINE)j=JXG.copyAttributes(c,a.options,"normal","point"),i=a.create("point",[function(){var a=JXG.Math.crossProduct([1,0,0],e.stdform);return[a[0],-a[2],a[1]]}],j),i.isDraggable=!0,f=a.create("line",[d,i],h),f.point=i;else if(e.elementClass==JXG.OBJECT_CLASS_CIRCLE)f=a.create("line",[e.midpoint,d],h);else if(e.elementClass==JXG.OBJECT_CLASS_CURVE)if("plot"!=e.visProp.curvetype){var k=e.X,l=e.Y;f=a.create("line",[function(){return-d.X()*a.D(k)(d.position)-d.Y()*a.D(l)(d.position)},function(){return a.D(k)(d.position)},function(){return a.D(l)(d.position)}],h)}else f=a.create("line",[function(){var a=Math.floor(d.position),b=d.position-a;return a==e.numberPoints-1&&(a--,b=1),0>a?1:(e.Y(a)+b*(e.Y(a+1)-e.Y(a)))*(e.Y(a)-e.Y(a+1))-(e.X(a)+b*(e.X(a+1)-e.X(a)))*(e.X(a+1)-e.X(a))},function(){var a=Math.floor(d.position);return a==e.numberPoints-1&&a--,0>a?0:e.X(a+1)-e.X(a)},function(){var a=Math.floor(d.position);return a==e.numberPoints-1&&a--,0>a?0:e.Y(a+1)-e.Y(a)}],h);else{if(e.type!=JXG.OBJECT_TYPE_TURTLE)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,line], [point,circle], [glider]");f=a.create("line",[function(){var c,f,a=Math.floor(d.position),b=d.position-a;for(f=0;f<e.objects.length;f++)if(c=e.objects[f],c.type==JXG.OBJECT_TYPE_CURVE){if(a<c.numberPoints)break;a-=c.numberPoints}return a==c.numberPoints-1&&(a--,b=1),0>a?1:(c.Y(a)+b*(c.Y(a+1)-c.Y(a)))*(c.Y(a)-c.Y(a+1))-(c.X(a)+b*(c.X(a+1)-c.X(a)))*(c.X(a+1)-c.X(a))},function(){var b,c,a=Math.floor(d.position);for(c=0;c<e.objects.length;c++)if(b=e.objects[c],b.type==JXG.OBJECT_TYPE_CURVE){if(a<b.numberPoints)break;a-=b.numberPoints}return a==b.numberPoints-1&&a--,0>a?0:b.X(a+1)-b.X(a)},function(){var b,c,a=Math.floor(d.position);for(c=0;c<e.objects.length;c++)if(b=e.objects[c],b.type==JXG.OBJECT_TYPE_CURVE){if(a<b.numberPoints)break;a-=b.numberPoints}return a==b.numberPoints-1&&a--,0>a?0:b.Y(a+1)-b.Y(a)}],h)}for(f.parents=[],g=0;g<b.length;g++)f.parents.push(b[g].id);return f.elType="normal",f},JXG.createBisector=function(a,b,c){var d,e,f,g;if(b[0].elementClass==JXG.OBJECT_CLASS_POINT&&b[1].elementClass==JXG.OBJECT_CLASS_POINT&&b[2].elementClass==JXG.OBJECT_CLASS_POINT){for(g=JXG.copyAttributes(c,a.options,"bisector","point"),d=a.create("point",[function(){return JXG.Math.Geometry.angleBisector(b[0],b[1],b[2],a)}],g),d.dump=!1,f=0;3>f;f++)b[f].addChild(d);return JXG.exists(c.layer)||(c.layer=a.options.layer.line),g=JXG.copyAttributes(c,a.options,"bisector"),e=JXG.createLine(a,[b[1],d],g),e.point=d,e.elType="bisector",e.parents=[b[0].id,b[1].id,b[2].id],e.subs={point:d},e}throw new Error("JSXGraph: Can't create angle bisector with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point,point]")},JXG.createAngularBisectorsOfTwoLines=function(a,b,c){var f,g,h,i,d=JXG.getReference(a,b[0]),e=JXG.getReference(a,b[1]);if(d.elementClass!=JXG.OBJECT_CLASS_LINE||e.elementClass!=JXG.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create angle bisectors of two lines with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [line,line]");return JXG.exists(c.layer)||(c.layer=a.options.layer.line),h=JXG.copyAttributes(c,a.options,"bisectorlines","line1"),f=a.create("line",[function(){var a=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]),b=Math.sqrt(e.stdform[1]*e.stdform[1]+e.stdform[2]*e.stdform[2]);return d.stdform[0]/a-e.stdform[0]/b},function(){var a=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]),b=Math.sqrt(e.stdform[1]*e.stdform[1]+e.stdform[2]*e.stdform[2]);return d.stdform[1]/a-e.stdform[1]/b},function(){var a=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]),b=Math.sqrt(e.stdform[1]*e.stdform[1]+e.stdform[2]*e.stdform[2]);return d.stdform[2]/a-e.stdform[2]/b}],h),JXG.exists(c.layer)||(c.layer=a.options.layer.line),h=JXG.copyAttributes(c,a.options,"bisectorlines","line2"),g=a.create("line",[function(){var a=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]),b=Math.sqrt(e.stdform[1]*e.stdform[1]+e.stdform[2]*e.stdform[2]);
return d.stdform[0]/a+e.stdform[0]/b},function(){var a=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]),b=Math.sqrt(e.stdform[1]*e.stdform[1]+e.stdform[2]*e.stdform[2]);return d.stdform[1]/a+e.stdform[1]/b},function(){var a=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]),b=Math.sqrt(e.stdform[1]*e.stdform[1]+e.stdform[2]*e.stdform[2]);return d.stdform[2]/a+e.stdform[2]/b}],h),i=new JXG.Composition({line1:f,line2:g}),f.dump=!1,g.dump=!1,i.elType="bisectorlines",i.parents=[d.id,e.id],i.subs={line1:f,line2:g},i},JXG.createCircumcircleMidpoint=function(d,e,f){var g,h;if(e[0].elementClass==JXG.OBJECT_CLASS_POINT&&e[1].elementClass==JXG.OBJECT_CLASS_POINT&&e[2].elementClass==JXG.OBJECT_CLASS_POINT){for(g=JXG.createPoint(d,[function(){return JXG.Math.Geometry.circumcenterMidpoint(e[0],e[1],e[2],d)}],f),h=0;3>h;h++)e[h].addChild(g);return g.elType="circumcenter",g.parents=[e[0].id,e[1].id,e[2].id],g.generatePolynomial=function(){var d=a.symbolic.x,e=a.symbolic.y,f=b.symbolic.x,h=b.symbolic.y,i=c.symbolic.x,j=c.symbolic.y,k=g.symbolic.x,l=g.symbolic.y,m=["((",k,")-(",d,"))^2+((",l,")-(",e,"))^2-((",k,")-(",f,"))^2-((",l,")-(",h,"))^2"].join(""),n=["((",k,")-(",d,"))^2+((",l,")-(",e,"))^2-((",k,")-(",i,"))^2-((",l,")-(",j,"))^2"].join("");return[m,n]},g}throw new Error("JSXGraph: Can't create circumcircle midpoint with parent types '"+typeof e[0]+"', '"+typeof e[1]+"' and '"+typeof e[2]+"'.\nPossible parent types: [point,point,point]")},JXG.createIncenter=function(a,b,c){var d,f,g,h;if(!(b.length>=3&&JXG.isPoint(b[0])&&JXG.isPoint(b[1])&&JXG.isPoint(b[2])))throw new Error("JSXGraph: Can't create incenter with parent types '"+typeof b[0]+"', '"+typeof b[1]+"' and '"+typeof b[2]+"'.\nPossible parent types: [point,point,point]");return f=b[0],g=b[1],h=b[2],d=a.create("point",[function(){var b,c,d;return b=Math.sqrt((g.X()-h.X())*(g.X()-h.X())+(g.Y()-h.Y())*(g.Y()-h.Y())),c=Math.sqrt((f.X()-h.X())*(f.X()-h.X())+(f.Y()-h.Y())*(f.Y()-h.Y())),d=Math.sqrt((g.X()-f.X())*(g.X()-f.X())+(g.Y()-f.Y())*(g.Y()-f.Y())),new JXG.Coords(JXG.COORDS_BY_USER,[(b*f.X()+c*g.X()+d*h.X())/(b+c+d),(b*f.Y()+c*g.Y()+d*h.Y())/(b+c+d)],a)}],c),d.elType="incenter",d.parents=[b[0].id,b[1].id,b[2].id],d},JXG.createCircumcircle=function(a,b,c){var d,e,f;try{f=JXG.copyAttributes(c,a.options,"circumcircle","center"),d=JXG.createCircumcircleMidpoint(a,b,f),d.dump=!1,JXG.exists(c.layer)||(c.layer=a.options.layer.circle),f=JXG.copyAttributes(c,a.options,"circumcircle"),e=JXG.createCircle(a,[d,b[0]],f),e.elType="circumcircle",e.parents=[b[0].id,b[1].id,b[2].id],e.subs={center:d}}catch(g){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof b[0]+"', '"+typeof b[1]+"' and '"+typeof b[2]+"'.\nPossible parent types: [point,point,point]")}return e},JXG.createIncircle=function(a,b,c){var d,e,f;try{f=JXG.copyAttributes(c,a.options,"incircle","center"),d=JXG.createIncenter(a,b,f),d.dump=!1,JXG.exists(c.layer)||(c.layer=a.options.layer.circle),f=JXG.copyAttributes(c,a.options,"incircle"),e=JXG.createCircle(a,[d,function(){var a=Math.sqrt((b[1].X()-b[2].X())*(b[1].X()-b[2].X())+(b[1].Y()-b[2].Y())*(b[1].Y()-b[2].Y())),c=Math.sqrt((b[0].X()-b[2].X())*(b[0].X()-b[2].X())+(b[0].Y()-b[2].Y())*(b[0].Y()-b[2].Y())),d=Math.sqrt((b[1].X()-b[0].X())*(b[1].X()-b[0].X())+(b[1].Y()-b[0].Y())*(b[1].Y()-b[0].Y())),e=(a+c+d)/2;return Math.sqrt((e-a)*(e-c)*(e-d)/e)}],f),e.elType="incircle",e.parents=[b[0].id,b[1].id,b[2].id],e.center=d,e.subs={center:d}}catch(h){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof b[0]+"', '"+typeof b[1]+"' and '"+typeof b[2]+"'.\nPossible parent types: [point,point,point]")}return e},JXG.createReflection=function(a,b,c){var d,e,f,g;if(b[0].elementClass==JXG.OBJECT_CLASS_POINT&&b[1].elementClass==JXG.OBJECT_CLASS_LINE)e=b[0],d=b[1];else{if(b[1].elementClass!=JXG.OBJECT_CLASS_POINT||b[0].elementClass!=JXG.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create reflection point with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [line,point]");e=b[1],d=b[0]}return g=JXG.createTransform(a,[d],{type:"reflect"}),f=JXG.createPoint(a,[e,g],c),e.addChild(f),d.addChild(f),f.elType="reflection",f.parents=[b[0].id,b[1].id],f.prepareUpdate().update(),f.generatePolynomial=function(){var a=d.point1.symbolic.x,b=d.point1.symbolic.y,c=d.point2.symbolic.x,g=d.point2.symbolic.y,h=e.symbolic.x,i=e.symbolic.y,j=f.symbolic.x,k=f.symbolic.y,l=["((",k,")-(",i,"))*((",b,")-(",g,"))+((",a,")-(",c,"))*((",j,")-(",h,"))"].join(""),m=["((",j,")-(",a,"))^2+((",k,")-(",b,"))^2-((",h,")-(",a,"))^2-((",i,")-(",b,"))^2"].join("");return[l,m]},f},JXG.createMirrorPoint=function(a,b,c){var d,e;if(!JXG.isPoint(b[0])||!JXG.isPoint(b[1]))throw new Error("JSXGraph: Can't create mirror point with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point]");for(d=JXG.createPoint(a,[function(){return JXG.Math.Geometry.rotation(b[0],b[1],Math.PI,a)}],c),e=0;2>e;e++)b[e].addChild(d);return d.elType="mirrorpoint",d.parents=[b[0].id,b[1].id],d.prepareUpdate().update(),d},JXG.createIntegral=function(a,b,c){var d,e,f,i,j,k,l,n,o,p,q,s,t,g=0,h=0,m=1;if(JXG.isArray(b[0])&&b[1].elementClass==JXG.OBJECT_CLASS_CURVE)d=b[0],e=b[1];else{if(!JXG.isArray(b[1])||b[0].elementClass!=JXG.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create integral with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [[number|function,number|function],curve]");d=b[1],e=b[0]}return g=d[0],h=d[1],JXG.isFunction(g)?(i=g,j=function(){return e.Y(i())},g=i()):(i=g,j=e.Y(g)),JXG.isFunction(g)?(k=h,l=function(){return e.Y(k())},h=k()):(k=h,l=e.Y(h)),g>h&&(m=-1),f=JXG.copyAttributes(c,a.options,"integral","curveLeft"),n=a.create("glider",[i,j,e],f),JXG.isFunction(i)&&n.hideElement(),f=JXG.copyAttributes(c,a.options,"integral","baseLeft"),o=a.create("point",[function(){return n.X()},0],f),f=JXG.copyAttributes(c,a.options,"integral","curveRight"),p=a.create("glider",[k,l,e],f),JXG.isFunction(k)&&p.hideElement(),f=JXG.copyAttributes(c,a.options,"integral","baseRight"),q=a.create("point",[function(){return p.X()},0],f),f=JXG.copyAttributes(c,a.options,"integral"),f.withLabel!==!1&&(f=JXG.copyAttributes(c,a.options,"integral","label"),s=a.create("text",[function(){return p.X()+.2},function(){return p.Y()-.8},function(){var a=JXG.Math.Numerics.I([o.X(),q.X()],e.Y);return"&int; = "+a.toFixed(4)}],f),s.dump=!1,n.addChild(s),p.addChild(s)),f=JXG.copyAttributes(c,a.options,"integral"),t=a.create("curve",[[0],[0]],f),n.dump=!1,o.dump=!1,p.dump=!1,q.dump=!1,t.elType="integral",t.parents=[e.id,d],t.subs={curveLeft:n,baseLeft:o,curveRight:p,baseRight:q},f.withLabel&&(t.subs.label=s),t.updateDataArray=function(){var a,b,c,d,f;for(o.X()<q.X()?(d=o.X(),f=q.X()):(d=q.X(),f=o.X()),a=[d,d],b=[0,e.Y(d)],c=0;c<e.numberPoints;c++)d<=e.points[c].usrCoords[1]&&e.points[c].usrCoords[1]<=f&&(a.push(e.points[c].usrCoords[1]),b.push(e.points[c].usrCoords[2]));a.push(f),b.push(e.Y(f)),a.push(f),b.push(0),a.push(d),b.push(0),this.dataX=a,this.dataY=b},n.addChild(t),p.addChild(t),t.baseLeft=o,t.baseRight=q,t.curveLeft=n,t.curveRight=p,t.label={content:s},t},JXG.createLocus=function(a,b,c){var d,e;if(!JXG.isArray(b)||1!=b.length||b[0].elementClass!=JXG.OBJECT_CLASS_POINT)throw new Error("JSXGraph: Can't create locus with parent of type other than point.\nPossible parent types: [point]");return e=b[0],d=a.create("curve",[[null],[null]],c),d.dontCallServer=!1,d.elType="locus",d.parents=[e.id],d.updateDataArray=function(){if(!(d.board.mode>0)){var b=JXG.Math.Symbolic.generatePolynomials(a,e,!0).join("|");if(b!==d.spe){d.spe=b;var c=function(a,b,c,e){d.dataX=a,d.dataY=b,d.eq=c,d.ctime=e,d.generatePolynomial=function(a){return function(b){var f,c="("+b.symbolic.x+")",d="("+b.symbolic.y+")",e=[];for(f=0;f<a.length;f++)e[f]=a[f].replace(/\*\*/g,"^").replace(/x/g,c).replace(/y/g,d);return e}}(c)},f=JXG.Math.Symbolic.geometricLocusByGroebnerBase(a,e,c);c(f.datax,f.datay,f.polynomial,f.exectime)}}},d},JXG.createGrid=function(a,b,c){var d,e;return e=JXG.copyAttributes(c,a.options,"grid"),d=a.create("curve",[[null],[null]],e),d.elType="grid",d.parents=[],d.type=JXG.OBJECT_TYPE_GRID,d.updateDataArray=function(){var g,b=this.visProp.gridx,c=this.visProp.gridy,e=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],a),f=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a.canvasWidth,a.canvasHeight],a);for(a.options.grid.hasGrid=!0,e.setCoordinates(JXG.COORDS_BY_USER,[Math.floor(e.usrCoords[1]/b)*b,Math.ceil(e.usrCoords[2]/c)*c]),f.setCoordinates(JXG.COORDS_BY_USER,[Math.ceil(f.usrCoords[1]/b)*b,Math.floor(f.usrCoords[2]/c)*c]),d.dataX=[],d.dataY=[],g=e.usrCoords[2];g>f.usrCoords[2]-c;g-=c)d.dataX.push(e.usrCoords[1],f.usrCoords[1],0/0),d.dataY.push(g,g,0/0);for(g=e.usrCoords[1];g<f.usrCoords[1]+b;g+=b)d.dataX.push(g,g,0/0),d.dataY.push(e.usrCoords[2],f.usrCoords[2],0/0)},d.hasPoint=function(){return!1},a.grids.push(d),d},JXG.JSXGraph.registerElement("arrowparallel",JXG.createArrowParallel),JXG.JSXGraph.registerElement("bisector",JXG.createBisector),JXG.JSXGraph.registerElement("bisectorlines",JXG.createAngularBisectorsOfTwoLines),JXG.JSXGraph.registerElement("circumcircle",JXG.createCircumcircle),JXG.JSXGraph.registerElement("circumcirclemidpoint",JXG.createCircumcircleMidpoint),JXG.JSXGraph.registerElement("circumcenter",JXG.createCircumcircleMidpoint),JXG.JSXGraph.registerElement("incenter",JXG.createIncenter),JXG.JSXGraph.registerElement("incircle",JXG.createIncircle),JXG.JSXGraph.registerElement("integral",JXG.createIntegral),JXG.JSXGraph.registerElement("midpoint",JXG.createMidpoint),JXG.JSXGraph.registerElement("mirrorpoint",JXG.createMirrorPoint),JXG.JSXGraph.registerElement("normal",JXG.createNormal),JXG.JSXGraph.registerElement("orthogonalprojection",JXG.createOrthogonalProjection),JXG.JSXGraph.registerElement("parallel",JXG.createParallel),JXG.JSXGraph.registerElement("parallelpoint",JXG.createParallelPoint),JXG.JSXGraph.registerElement("perpendicular",JXG.createPerpendicular),JXG.JSXGraph.registerElement("perpendicularpoint",JXG.createPerpendicularPoint),JXG.JSXGraph.registerElement("perpendicularsegment",JXG.createPerpendicularSegment),JXG.JSXGraph.registerElement("reflection",JXG.createReflection),JXG.JSXGraph.registerElement("locus",JXG.createLocus),JXG.JSXGraph.registerElement("grid",JXG.createGrid),JXG.Text=function(a,b,c,d){if(this.constructor(a,d,JXG.OBJECT_TYPE_TEXT,JXG.OBJECT_CLASS_OTHER),this.content=b,this.plaintext="",this.isDraggable=!1,this.needsSizeUpdate=!1,this.element=JXG.getRef(this.board,d.anchor))this.relativeCoords=this.visProp.islabel?new JXG.Coords(JXG.COORDS_BY_SCREEN,[parseFloat(c[0]),parseFloat(c[1])],this.board):new JXG.Coords(JXG.COORDS_BY_USER,[parseFloat(c[0]),parseFloat(c[1])],this.board),this.element.addChild(this),this.coords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this.board),this.isDraggable=!0;else{JXG.isNumber(c[0])&&JXG.isNumber(c[1])&&(this.isDraggable=!0),this.X=JXG.createFunction(c[0],this.board,null,!0),this.Y=JXG.createFunction(c[1],this.board,null,!0),this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.X(),this.Y()],this.board);var g="this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.X(),this.Y()]);";this.updateCoords=new Function("",g)}return"function"==typeof this.content?(this.updateText=function(){this.plaintext=this.content()},this.needsSizeUpdate=!0):(JXG.isNumber(this.content)?this.content=this.content.toFixed(this.visProp.digits):this.visProp.useasciimathml?(this.content="'`"+this.content+"`'",this.needsSizeUpdate=!0):this.content=this.generateTerm(this.content),this.updateText=new Function("this.plaintext = "+this.content+";")),this.size=[1,1],this.updateText(),this.id=this.board.setId(this,"T"),this.board.renderer.drawText(this),this.updateSize(),this.visProp.visible||this.board.renderer.hide(this),"string"==typeof this.content&&this.notifyParents(this.content),this.elType="text",this.methodMap=JXG.deepCopy(this.methodMap,{setText:"setTextJessieCode",free:"free",move:"setCoords"}),this},JXG.Text.prototype=new JXG.GeometryElement,JXG.extend(JXG.Text.prototype,{hasPoint:function(a,b){var c,d,e,f,g=this.board.options.precision.hasPoint;return c="right"===this.visProp.anchorx?this.coords.scrCoords[1]-this.size[0]:"middle"===this.visProp.anchorx?this.coords.scrCoords[1]-.5*this.size[0]:this.coords.scrCoords[1],d=c+this.size[0],f="top"===this.visProp.anchory?this.coords.scrCoords[2]+this.size[1]:"middle"===this.visProp.anchorx?this.coords.scrCoords[2]+.5*this.size[1]:this.coords.scrCoords[2],e=f-this.size[1],b>=e-g&&f+g>=b&&(a>=c-g&&c+2*g>=a||a>=d-2*g&&d+g>=a)},setTextJessieCode:function(a){var b;return this.visProp.castext=a,b="function"==typeof a?function(){return a().replace(/</g,"&lt;").replace(/>/g,"&gt;")}:JXG.isNumber(a)?a:a.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.setText(b)},setText:function(a){return"function"==typeof a?this.updateText=function(){this.plaintext=a()}:(this.content=JXG.isNumber(a)?a.toFixed(this.visProp.digits):this.visProp.useasciimathml?"'`"+a+"`'":this.generateTerm(a),this.updateText=new Function("this.plaintext = "+this.content+"; ")),this.updateText(),this.prepareUpdate().update().updateRenderer(),this},updateSize:function(){var a;if("undefined"==typeof document)return this;if("html"==this.visProp.display&&"vml"!=this.board.renderer.type)this.size=[this.rendNode.offsetWidth,this.rendNode.offsetHeight];else if("internal"==this.visProp.display&&"svg"==this.board.renderer.type)try{a=this.rendNode.getBBox(),this.size=[a.width,a.height]}catch(b){}else("vml"==this.board.renderer.type||"internal"==this.visProp.display&&"canvas"==this.board.renderer.type)&&(this.size=[.45*parseFloat(this.visProp.fontsize)*this.plaintext.length,.9*parseFloat(this.visProp.fontsize)]);return this},getSize:function(){return this.size},setCoords:function(a,b){return JXG.isArray(a)&&a.length>1&&(b=a[1],a=a[0]),this.X=function(){return a},this.Y=function(){return b},this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[a,b],this.board),this.prepareUpdate().update().updateRenderer(),this},free:function(){this.X=JXG.createFunction(this.X(),this.board,""),this.Y=JXG.createFunction(this.Y(),this.board,""),this.isDraggable=!0},update:function(){var a,b,c;return this.needsUpdate&&(this.relativeCoords?this.visProp.islabel?(b=parseFloat(this.visProp.offset[0]),c=-parseFloat(this.visProp.offset[1]),a=this.element.getLabelAnchor(),this.coords.setCoordinates(JXG.COORDS_BY_SCREEN,[b+this.relativeCoords.scrCoords[1]+a.scrCoords[1],c+this.relativeCoords.scrCoords[2]+a.scrCoords[2]])):(a=this.element.getTextAnchor(),this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.relativeCoords.usrCoords[1]+a.usrCoords[1],this.relativeCoords.usrCoords[2]+a.usrCoords[2]])):this.updateCoords(),this.updateText(),this.needsSizeUpdate&&this.updateSize(),this.updateTransform()),this},updateRenderer:function(){return this.needsUpdate&&(this.board.renderer.updateText(this),this.needsUpdate=!1),this},updateTransform:function(){var a;if(0!=this.transformations.length){for(a=0;a<this.transformations.length;a++)this.transformations[a].update();return this}},generateTerm:function(a){var b,d,c='""';a=a||"",a=a.replace(/\r/g,""),a=a.replace(/\n/g,""),a=a.replace(/\"/g,'\\"'),a=a.replace(/\'/g,"\\'"),a=a.replace(/&amp;arc;/g,"&ang;"),a=a.replace(/<arc\s*\/>/g,"&ang;"),a=a.replace(/<sqrt\s*\/>/g,"&radic;");var e;e=a.indexOf("<value>");var f=a.indexOf("</value>");if(e>=0)for(this.needsSizeUpdate=!0;e>=0;)c+=' + "'+JXG.GeonextParser.replaceSub(JXG.GeonextParser.replaceSup(a.slice(0,e)))+'"',d=a.slice(e+7,f),b=JXG.GeonextParser.geonext2JS(d,this.board),b=b.replace(/\\"/g,'"'),b=b.replace(/\\'/g,"'"),c+=b.indexOf("toFixed")<0?JXG.isNumber(JXG.bind(new Function("return "+b+";"),this)())?"+("+b+").toFixed("+this.visProp.digits+")":"+("+b+")":"+("+b+")",a=a.slice(f+8),e=a.indexOf("<value>"),f=a.indexOf("</value>");return c+=' + "'+JXG.GeonextParser.replaceSub(JXG.GeonextParser.replaceSup(a))+'"',c=c.replace(/<overline>/g,"<span style=text-decoration:overline>"),c=c.replace(/<\/overline>/g,"</span>"),c=c.replace(/<arrow>/g,"<span style=text-decoration:overline>"),c=c.replace(/<\/arrow>/g,"</span>"),c=c.replace(/&amp;/g,"&")},notifyParents:function(a){var b=null;do{var c=/<value>([\w\s\*\/\^\-\+\(\)\[\],<>=!]+)<\/value>/;b=c.exec(a),null!=b&&(JXG.GeonextParser.findDependencies(this,b[1],this.board),a=a.substr(b.index),a=a.replace(c,""))}while(null!=b);return this},bounds:function(){var a=this.coords.usrCoords;return this.visProp.islabel?[0,0,0,0]:[a[1],a[2]+this.size[1],a[1]+this.size[0],a[2]]},setPositionDirectly:function(a,b,c){var d,e,f,g;return this.relativeCoords?this.visProp.islabel?(g=new JXG.Coords(a,c,this.board),f=new JXG.Coords(a,b,this.board),d=f.scrCoords[1]-g.scrCoords[1],e=f.scrCoords[2]-g.scrCoords[2],this.relativeCoords.scrCoords[1]+=d,this.relativeCoords.scrCoords[2]+=e):(g=new JXG.Coords(a,c,this.board),f=new JXG.Coords(a,b,this.board),d=f.usrCoords[1]-g.usrCoords[1],e=f.usrCoords[2]-g.usrCoords[2],this.relativeCoords.usrCoords[1]+=d,this.relativeCoords.usrCoords[2]+=e):(f=new JXG.Coords(a,b,this.board),this.X=JXG.createFunction(f.usrCoords[1],this.board,""),this.Y=JXG.createFunction(f.usrCoords[2],this.board,"")),this}}),JXG.createText=function(a,b,c){var d,e,d=JXG.copyAttributes(c,a.options,"text");return d.anchor=d.parent||d.anchor,e=new JXG.Text(a,b[b.length-1],b,d),"function"!=typeof b[b.length-1]&&(e.parents=b),0!=JXG.evaluate(d.rotate)&&"internal"==d.display&&e.addRotation(JXG.evaluate(d.rotate)),e},JXG.JSXGraph.registerElement("text",JXG.createText),JXG.Image=function(a,b,c,d,e){this.constructor(a,e,JXG.OBJECT_TYPE_IMAGE,JXG.OBJECT_CLASS_OTHER),this.initialCoords=new JXG.Coords(JXG.COORDS_BY_USER,c,this.board),JXG.isFunction(c[0])||JXG.isFunction(c[1])||(this.isDraggable=!0),this.X=JXG.createFunction(c[0],this.board,""),this.Y=JXG.createFunction(c[1],this.board,""),this.W=JXG.createFunction(d[0],this.board,""),this.H=JXG.createFunction(d[1],this.board,""),this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.X(),this.Y()],this.board),this.updateCoords=new Function("","this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.X(),this.Y()]);"),this.updateSize=new Function("","this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.W(),this.H()]);"),this.usrSize=[this.W(),this.H()],this.size=[this.usrSize[0]*a.unitX,this.usrSize[1]*a.unitY],this.url=b,this.parent=JXG.getRef(e.anchor),this.id=this.board.setId(this,"Im"),this.board.renderer.drawImage(this),this.visProp.visible||this.board.renderer.hide(this)},JXG.Image.prototype=new JXG.GeometryElement,JXG.extend(JXG.Image.prototype,{hasPoint:function(a,b){var c=a-this.coords.scrCoords[1],d=this.coords.scrCoords[2]-b,e=this.board.options.precision.hasPoint;return c>=-e&&2*e>=c&&d>=-e&&e>=d?!0:!1},update:function(){return this.needsUpdate&&(this.updateCoords(),this.usrSize=[this.W(),this.H()],this.size=[this.usrSize[0]*this.board.unitX,this.usrSize[1]*this.board.unitY],this.updateTransform()),this},updateRenderer:function(){return this.needsUpdate&&(this.board.renderer.updateImage(this),this.needsUpdate=!1),this},updateTransform:function(){if(0!=this.transformations.length)for(var a=0;a<this.transformations.length;a++)this.transformations[a].update()},addTransform:function(a){if(JXG.isArray(a))for(var b=0;b<a.length;b++)this.transformations.push(a[b]);else this.transformations.push(a)},setPositionDirectly:function(a,b){var b=new JXG.Coords(a,b,this.board);return this.X=JXG.createFunction(b.usrCoords[1],this.board,""),this.Y=JXG.createFunction(b.usrCoords[2],this.board,""),this}}),JXG.createImage=function(a,b,c){var e,f;return e=JXG.copyAttributes(c,a.options,"image"),f=new JXG.Image(a,b[0],b[1],b[2],e),0!=JXG.evaluate(e.rotate)&&f.addRotation(JXG.evaluate(e.rotate)),f},JXG.JSXGraph.registerElement("image",JXG.createImage),JXG.createSlider=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;return d=b[0],e=b[1],f=b[2][0],g=b[2][1],h=b[2][2],i=h-f,x=JXG.copyAttributes(c,a.options,"slider"),v=x.withticks,u=x.withlabel,w=x.snapwidth,y=x.precision,x=JXG.copyAttributes(c,a.options,"slider","point1"),j=a.create("point",d,x),x=JXG.copyAttributes(c,a.options,"slider","point2"),k=a.create("point",e,x),a.create("group",[j,k]),x=JXG.copyAttributes(c,a.options,"slider","baseline"),l=a.create("segment",[j,k],x),l.updateStdform(),v&&(x=JXG.copyAttributes(c,a.options,"slider","ticks"),m=2,n=a.create("ticks",[l,k.Dist(j)/m],x)),o=d[0]+(e[0]-d[0])*(g-f)/(h-f),p=d[1]+(e[1]-d[1])*(g-f)/(h-f),x=JXG.copyAttributes(c,a.options,"slider"),x.withLabel=!1,q=a.create("glider",[o,p,l],x),q.setProperty({snapwidth:w}),x=JXG.copyAttributes(c,a.options,"slider","highline"),r=a.create("segment",[j,q],x),q.Value=function(){return-1===q.visProp.snapwidth?this.position*i+f:Math.round((this.position*i+f)/this.visProp.snapwidth)*this.visProp.snapwidth},q.methodMap=JXG.deepCopy(q.methodMap,{Value:"Value"}),q._smax=h,q._smin=f,u&&(s=c.name&&""!=c.name?c.name+" = ":"",x=JXG.copyAttributes(c,a.options,"slider","label"),t=a.create("text",[function(){return.05*(k.X()-j.X())+k.X()},function(){return.05*(k.Y()-j.Y())+k.Y()},function(){return s+q.Value().toFixed(y)}],x),q.label.content=t),q.point1=j,q.point2=k,q.baseline=l,q.highline=r,v&&(q.ticks=n),q.remove=function(){u&&a.removeObject(t),a.removeObject(r),v&&l.removeTicks(n),a.removeObject(l),a.removeObject(k),a.removeObject(j),JXG.Point.prototype.remove.call(q)},j.dump=!1,k.dump=!1,l.dump=!1,r.dump=!1,q.elType="slider",q.parents=b,q.subs={point1:j,point2:k,baseLine:l,highLine:r},v&&(n.dump=!1,q.subs.ticks=n),q},JXG.JSXGraph.registerElement("slider",JXG.createSlider),JXG.Chart=function(a,b,c){this.constructor(a,c);var d,e,f,g,h,i;if(!JXG.isArray(b)||0===b.length)throw new Error("JSXGraph: Can't create a chart without data");if(this.elements=[],JXG.isNumber(b[0]))for(e=b,d=[],f=0;f<e.length;f++)d[f]=f+1;else if(1===b.length&&JXG.isArray(b[0]))for(e=b[0],d=[],i=JXG.evaluate(e).length,f=0;i>f;f++)d[f]=f+1;else 2===b.length&&(i=Math.min(b[0].length,b[1].length),d=b[0].slice(0,i),e=b[1].slice(0,i));if(JXG.isArray(e)&&0===e.length)throw new Error("JSXGraph: Can't create charts without data.");for(h=c.chartstyle.replace(/ /g,"").split(","),f=0;f<h.length;f++){switch(h[f]){case"bar":g=this.drawBar(a,d,e,c);break;case"line":g=this.drawLine(a,d,e,c);break;case"fit":g=this.drawFit(a,d,e,c);break;case"spline":g=this.drawSpline(a,d,e,c);break;case"pie":g=this.drawPie(a,e,c);break;case"point":g=this.drawPoints(a,d,e,c);break;case"radar":g=this.drawRadar(a,b,c)}this.elements.push(g)}return this.id=this.board.setId(this,"Chart"),this.elements},JXG.Chart.prototype=new JXG.GeometryElement,JXG.extend(JXG.Chart.prototype,{drawLine:function(a,b,c,d){return d.fillcolor="none",d.highlightfillcolor="none",a.create("curve",[b,c],d)},drawSpline:function(a,b,c,d){return d.fillColor="none",d.highlightfillcolor="none",a.create("spline",[b,c],d)},drawFit:function(a,b,c,d){var e=d.degree;return e=!JXG.exists(e)||0/0==parseInt(e)||parseInt(e)<1?1:parseInt(e),d.fillcolor="none",d.highlightfillcolor="none",a.create("functiongraph",[JXG.Math.Numerics.regressionPolynomial(e,b,c)],d)},drawBar:function(a,b,c,d){var e,g,h,i,j,k,l,m,n,o,p,f=[],q=[],r={fixed:!0,withLabel:!1,visible:!1,name:""};if(JXG.exists(d.fillopacity)||(d.fillopacity=.6),d&&d.width)k=d.width;else{if(b.length<=1)k=1;else for(k=b[1]-b[0],e=1;e<b.length-1;e++)k=b[e+1]-b[e]<k?b[e+1]-b[e]:k;k*=.8}for(h=d.fillcolor,i=parseFloat(a.options.text.fontSize),e=0;e<b.length;e++)isNaN(JXG.evaluate(b[e]))||isNaN(c[e]),JXG.isFunction(b[e])?(l=function(){return b[e]()-.5*k},m=function(){return b[e]()},n=function(){return b[e]()+.5*k}):(l=b[e]-.5*k,m=b[e],n=b[e]+.5*k),o=c[e],"horizontal"==d.dir?(q[0]=a.create("point",[0,l],r),q[1]=a.create("point",[o,l],r),q[2]=a.create("point",[o,n],r),q[3]=a.create("point",[0,n],r),JXG.exists(d.labels)&&JXG.exists(d.labels[e])&&(g=d.labels[e].toString().length,g=2*g*i/a.unitX,o>=0?o+=.5*i/a.unitX:o-=i*g/a.unitX,m-=.2*i/a.unitY,j=a.create("text",[o,m,d.labels[e]],d))):(q[0]=a.create("point",[l,0],r),q[1]=a.create("point",[l,o],r),q[2]=a.create("point",[n,o],r),q[3]=a.create("point",[n,0],r),JXG.exists(d.labels)&&JXG.exists(d.labels[e])&&(g=d.labels[e].toString().length,g=.6*g*i/a.unitX,o>=0?o+=.5*i/a.unitY:o-=1*i/a.unitY,j=a.create("text",[m-.5*g,o,d.labels[e]],d))),d.withlines=!1,JXG.exists(d.colors)&&JXG.isArray(d.colors)&&(p=d.colors,d.fillcolor=p[e%p.length]),f[e]=a.create("polygon",q,d),JXG.exists(d.labels)&&JXG.exists(d.labels[e])&&(f[e].text=j);return f},drawPoints:function(a,b,c,d){var e,f=[],g=d.infoboxarray;for(d.fixed=!0,d.name="",e=0;e<b.length;e++)d.infoboxtext=g?g[e%g.length]:!1,f[e]=a.create("point",[b[e],c[e]],d);return f},drawPie:function(a,b,c){var d,p,e=[],f=[],h=(JXG.Math.Statistics.sum(b),c.colors),i=c.highlightcolors,j=c.labels,k=c.radius||4,l=k,m=c.center||[0,0],n=m[0],o=m[1],q={fixed:!0,withLabel:!1,visible:!1,name:""};if(!JXG.isArray(j))for(j=[],d=0;d<b.length;d++)j[d]="";for(JXG.isFunction(k)||(l=function(){return k}),c.highlightonsector=c.highlightonsector||!1,c.straightfirst=!1,c.straightlast=!1,p=a.create("point",[n,o],q),e[0]=a.create("point",[function(){return l()+n},function(){return o}],q),d=0;d<b.length;d++)e[d+1]=a.create("point",[function(a){return function(){var c,e,f,d=0;for(e=0;a>=e;e++)d+=parseFloat(JXG.evaluate(b[e]));for(c=d,e=a+1;e<b.length;e++)c+=parseFloat(JXG.evaluate(b[e]));return f=0!=c?2*Math.PI*d/c:0,l()*Math.cos(f)+n}}(d),function(a){return function(){var c,e,f,d=0;for(e=0;a>=e;e++)d+=parseFloat(JXG.evaluate(b[e]));for(c=d,e=a+1;e<b.length;e++)c+=parseFloat(JXG.evaluate(b[e]));return f=0!=c?2*Math.PI*d/c:0,l()*Math.sin(f)+o}}(d)],q),c.name=j[d],c.withlabel=""!=c.name,c.fillcolor=h&&h[d%h.length],c.labelcolor=h&&h[d%h.length],c.highlightfillcolor=i&&i[d%i.length],f[d]=a.create("sector",[p,e[d],e[d+1]],c),c.highlightonsector&&(f[d].hasPoint=f[d].hasPointSector),c.highlightbysize&&(f[d].highlight=function(){if(!this.highlighted){this.highlighted=!0,this.board.renderer.highlight(this);var a=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],b=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];null!=this.label.content&&(this.label.content.rendNode.style.fontSize=2*this.label.content.visProp.fontsize+"px",this.label.content.prepareUpdate().update().updateRenderer()),this.point2.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+1.1*a,this.point1.coords.usrCoords[2]+1.1*b],this.board),this.prepareUpdate().update().updateRenderer()}},f[d].noHighlight=function(){if(this.highlighted){this.highlighted=!1,this.board.renderer.noHighlight(this);var a=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],b=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];null!=this.label.content&&(this.label.content.rendNode.style.fontSize=2*this.label.content.visProp.fontsize+"px",this.label.content.prepareUpdate().update().updateRenderer()),this.point2.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+a/1.1,this.point1.coords.usrCoords[2]+b/1.1],this.board),this.prepareUpdate().update().updateRenderer()}});return{sectors:f,points:e,midpoint:p}},drawRadar:function(a,b,c){var d,e,f,g,h,i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,j=b.length;if(0>=j)return JXG.debug("No data"),void 0;if(f=c.paramarray,!JXG.exists(f))return JXG.debug("Need paramArray attribute"),void 0;if(g=f.length,1>=g)return JXG.debug("Need more than 1 param"),void 0;for(d=0;j>d;d++)if(g!=b[d].length)return JXG.debug("Use data length equal to number of params ("+b[d].length+" != "+g+")"),void 0;for(h=new Array(g),i=new Array(g),e=0;g>e;e++)h[e]=b[0][e],i[e]=h[e];for(d=1;j>d;d++)for(e=0;g>e;e++)b[d][e]>h[e]&&(h[e]=b[d][e]),b[d][e]<i[e]&&(i[e]=b[d][e]);for(k=new Array(j),l=new Array(j),d=0;j>d;d++)k[d]="",l[d]=[];for(m=new Array(g),n=new Array(g),o=c.startshiftratio||0,p=c.endshiftratio||0,d=0;g>d;d++)m[d]=(h[d]-i[d])*o,n[d]=(h[d]-i[d])*p;if(q=c.startshiftarray||m,r=c.endshiftarray||n,s=c.startarray||i,JXG.exists(c.start))for(d=0;g>d;d++)s[d]=c.start;if(t=c.endarray||h,JXG.exists(c.end))for(d=0;g>d;d++)t[d]=c.end;if(q.length!=g)return JXG.debug("Start shifts length is not equal to number of parameters"),void 0;if(r.length!=g)return JXG.debug("End shifts length is not equal to number of parameters"),void 0;if(s.length!=g)return JXG.debug("Starts length is not equal to number of parameters"),void 0;if(t.length!=g)return JXG.debug("Ends length is not equal to number of parameters"),void 0;u=c.labelarray||k,v=c.colors,w=c.highlightcolors,x=c.radius||10,y={},JXG.exists(c.highlightonsector)||(c.highlightonsector=!1),y.name=c.name,y.id=c.id,y.strokewidth=c.strokewidth||1,y.polystrokewidth=c.polystrokewidth||2*y.strokewidth,y.strokecolor=c.strokecolor||"black",y.straightfirst=!1,y.straightlast=!1,y.fillcolor=c.fillColor||"#FFFF88",y.fillopacity=c.fillOpacity||.4,y.highlightfillcolor=c.highlightFillColor||"#FF7400",y.highlightstrokecolor=c.highlightStrokeColor||"black",y.gradient=c.gradient||"none",z=c.center||[0,0],A=z[0],B=z[1],C=a.create("point",[A,B],{name:"",fixed:!0,withlabel:!1,visible:!1}),D=Math.PI/2-Math.PI/g,(c.startangle||0===c.startangle)&&(D=c.startangle),E=D,F=[],G=[];var T=function(){var a,b,c,d,e=this.visProp.label.offset.slice(0);return a=this.point1.X(),b=this.point2.X(),c=this.point1.Y(),d=this.point2.Y(),a>b&&(e[0]=-e[0]),c>d&&(e[1]=-e[1]),this.setLabelRelativeCoords(e),new JXG.Coords(JXG.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)},U=function(b,c){var d,e,f;return d=a.create("transform",[-(s[c]-q[c]),0],{type:"translate"}),e=a.create("transform",[x/(t[c]+r[c]-(s[c]-q[c])),1],{type:"scale"}),d.melt(e),f=a.create("transform",[b],{type:"rotate"}),d.melt(f),d};for(d=0;g>d;d++)for(E+=2*Math.PI/g,I=x*Math.cos(E)+A,J=x*Math.sin(E)+B,F[d]=a.create("point",[I,J],{name:"",fixed:!0,withlabel:!1,visible:!1}),G[d]=a.create("line",[C,F[d]],{name:f[d],strokeColor:y.strokecolor,strokeWidth:y.strokewidth,strokeOpacity:1,straightFirst:!1,straightLast:!1,withLabel:!0,highlightStrokeColor:y.highlightstrokecolor}),G[d].getLabelAnchor=T,H=U(E,d),e=0;e<b.length;e++){var V=b[e][d];l[e][d]=a.create("point",[V,0],{name:"",fixed:!0,withlabel:!1,visible:!1}),l[e][d].addTransform(l[e][d],H)}for(K=new Array(j),d=0;j>d;d++)for(y.labelcolor=v&&v[d%v.length],y.strokecolor=v&&v[d%v.length],y.fillcolor=v&&v[d%v.length],K[d]=a.create("polygon",l[d],{withLines:!0,withLabel:!1,fillColor:y.fillcolor,fillOpacity:y.fillopacity,highlightFillColor:y.highlightfillcolor}),e=0;g>e;e++)K[d].borders[e].setProperty("strokecolor:"+v[d%v.length]),K[d].borders[e].setProperty("strokewidth:"+y.polystrokewidth);switch(L=c.legendposition||"none"){case"right":var W=c.legendleftoffset||2,X=c.legendtopoffset||1;this.legend=a.create("legend",[A+x+W,B+x-X],{labelArray:u,colorArray:v});break;case"none":break;default:JXG.debug("Unknown legend position")}if(M=[],0!=c.showcircles){for(N=[],d=0;6>d;d++)N[d]=20*d;if(N[0]="0",O=c.circlelabelarray||N,P=O.length,2>P)return alert("Too less circles"),void 0;for(Q=[],R=D+Math.PI/g,H=U(R,0),y.fillcolor="none",y.highlightfillcolor="none",y.strokecolor=c.strokecolor||"black",y.strokewidth=c.circlestrokewidth||.5,y.layer=0,S=(t[0]-s[0])/(P-1),d=0;P>d;d++)Q[d]=a.create("point",[s[0]+d*S,0],{name:O[d],size:0,fixed:!0,withLabel:!0,visible:!0}),Q[d].addTransform(Q[d],H),M[d]=a.create("circle",[C,Q[d]],y)}return this.rendNode=K[0].rendNode,{circles:M,lines:G,points:l,midpoint:C,polygons:K}},updateRenderer:function(){return this},update:function(){return this.needsUpdate&&this.updateDataArray(),this},updateDataArray:function(){}}),JXG.createChart=function(a,b,c){if(1==b.length&&"string"==typeof b[0]){var e,f,g,h,i,k,l,m,n,o,p,q,r,s,t,u,d=document.getElementById(b[0]),j=[];if(JXG.exists(d)){if(u=JXG.copyAttributes(c,a.options,"chart"),d=(new JXG.DataSource).loadFromTable(b[0],u.withheaders,u.withheaders),e=d.data,i=d.columnHeaders,f=d.rowHeaders,n=u.width,o=u.name,p=u.strokecolor,q=u.fillcolor,r=u.highlightstrokecolor,s=u.highlightfillcolor,a.suspendUpdate(),t=e.length,m=[],u.rows&&JXG.isArray(u.rows)){for(g=0;t>g;g++)for(h=0;h<u.rows.length;h++)if(u.rows[h]==g||u.withheaders&&u.rows[h]==f[g]){m.push(e[g]);
break}}else m=e;for(t=m.length,g=0;t>g;g++){if(l=[],u.chartstyle&&-1!=u.chartstyle.indexOf("bar")){for(k=n?n:.8,l.push(1-k/2+(g+.5)*k/(1*t)),h=1;h<m[g].length;h++)l.push(l[h-1]+1);u.width=k/(1*t)}o&&o.length==t?u.name=o[g]:u.withheaders&&(u.name=i[g]),u.strokecolor=p&&p.length==t?p[g]:JXG.hsv2rgb(360*((g+1)/(1*t)),.9,.6),u.fillcolor=q&&q.length==t?q[g]:JXG.hsv2rgb(360*((g+1)/(1*t)),.9,1),u.highlightstrokecolor=r&&r.length==t?r[g]:JXG.hsv2rgb(360*((g+1)/(1*t)),.9,1),u.highlightfillcolor=s&&s.length==t?s[g]:JXG.hsv2rgb(360*((g+1)/(1*t)),.9,.6),u.chartstyle&&-1!=u.chartstyle.indexOf("bar")?j.push(new JXG.Chart(a,[l,m[g]],u)):j.push(new JXG.Chart(a,[m[g]],u))}a.unsuspendUpdate()}return j}return u=JXG.copyAttributes(c,a.options,"chart"),new JXG.Chart(a,b,u)},JXG.JSXGraph.registerElement("chart",JXG.createChart),JXG.Legend=function(a,b,c){var d;switch(this.constructor(),d=JXG.copyAttributes(c,a.options,"legend"),this.board=a,this.coords=new JXG.Coords(JXG.COORDS_BY_USER,b,this.board),this.myAtts={},this.label_array=d.labelarray||d.labels,this.color_array=d.colorarray||d.colors,this.lines=[],this.myAtts.strokewidth=d.strokewidth||5,this.myAtts.straightfirst=!1,this.myAtts.straightlast=!1,this.myAtts.withlabel=!0,this.myAtts.fixed=!0,this.style=d.legendstyle||d.style,this.style){case"vertical":this.drawVerticalLegend(a,d);break;default:throw new Error("JSXGraph: Unknown legend style: "+this.style)}},JXG.Legend.prototype=new JXG.GeometryElement,JXG.Legend.prototype.drawVerticalLegend=function(a,b){var e,c=b.linelength||1,d=(b.rowheight||20)/this.board.unitY;for(e=0;e<this.label_array.length;e++)this.myAtts.strokecolor=this.color_array[e],this.myAtts.highlightstrokecolor=this.color_array[e],this.myAtts.name=this.label_array[e],this.myAtts.label={offset:[40,0],strokeColor:this.color_array[e],strokeWidth:this.myAtts.strokewidth},this.lines[e]=a.create("line",[[this.coords.usrCoords[1],this.coords.usrCoords[2]-e*d],[this.coords.usrCoords[1]+c,this.coords.usrCoords[2]-e*d]],this.myAtts),this.lines[e].getLabelAnchor=function(){return this.setLabelRelativeCoords(this.visProp.label.offset),new JXG.Coords(JXG.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)}},JXG.createLegend=function(a,b,c){var d=[0,0];return JXG.exists(b)&&2==b.length&&(d=b),new JXG.Legend(a,d,c)},JXG.JSXGraph.registerElement("legend",JXG.createLegend),JXG.Transformation=function(a,b,c){this.elementClass=JXG.OBJECT_CLASS_OTHER,this.matrix=[[1,0,0],[0,1,0],[0,0,1]],this.board=a,this.isNumericMatrix=!1,this.setMatrix(a,b,c)},JXG.Transformation.prototype={},JXG.extend(JXG.Transformation.prototype,{update:function(){return this},setMatrix:function(a,b,c){var d;for(this.isNumericMatrix=!0,d=0;d<c.length;d++)if("number"!=typeof c[d]){this.isNumericMatrix=!1;break}"translate"==b?(this.evalParam=JXG.createEvalFunction(a,c,2),this.update=function(){this.matrix[1][0]=this.evalParam(0),this.matrix[2][0]=this.evalParam(1)}):"scale"==b?(this.evalParam=JXG.createEvalFunction(a,c,2),this.update=function(){this.matrix[1][1]=this.evalParam(0),this.matrix[2][2]=this.evalParam(1)}):"reflect"==b?(c.length<4&&(c[0]=JXG.getReference(a,c[0])),2==c.length&&(c[1]=JXG.getReference(a,c[1])),4==c.length&&(this.evalParam=JXG.createEvalFunction(a,c,4)),this.update=function(){var a,b,d,e,f,g,h,i;1==c.length?h=c[0].stdform:2==c.length?h=JXG.Math.crossProduct(c[1].coords.usrCoords,c[0].coords.usrCoords):4==c.length&&(h=JXG.Math.crossProduct([1,this.evalParam(2),this.evalParam(3)],[1,this.evalParam(0),this.evalParam(1)])),a=h[1],b=h[2],d=h[0],i=[-d*a,-d*b,a*a+b*b],g=i[2],e=i[0]/i[2],f=i[1]/i[2],a=-h[2],b=h[1],this.matrix[1][1]=(a*a-b*b)/g,this.matrix[1][2]=2*a*b/g,this.matrix[2][1]=this.matrix[1][2],this.matrix[2][2]=-this.matrix[1][1],this.matrix[1][0]=e*(1-this.matrix[1][1])-f*this.matrix[1][2],this.matrix[2][0]=f*(1-this.matrix[2][2])-e*this.matrix[2][1]}):"rotate"==b?(3==c.length?this.evalParam=JXG.createEvalFunction(a,c,3):c.length<=2&&(this.evalParam=JXG.createEvalFunction(a,c,1),2==c.length&&(c[1]=JXG.getReference(a,c[1]))),this.update=function(){var b,d,a=this.evalParam(0),e=Math.cos(a),f=Math.sin(a);this.matrix[1][1]=e,this.matrix[1][2]=-f,this.matrix[2][1]=f,this.matrix[2][2]=e,c.length>1&&(3==c.length?(b=this.evalParam(1),d=this.evalParam(2)):(b=c[1].X(),d=c[1].Y()),this.matrix[1][0]=b*(1-e)+d*f,this.matrix[2][0]=d*(1-e)-b*f)}):"shear"==b?(this.evalParam=JXG.createEvalFunction(a,c,1),this.update=function(){var a=this.evalParam(0);this.matrix[1][1]=Math.tan(a)}):"generic"==b&&(this.evalParam=JXG.createEvalFunction(a,c,9),this.update=function(){this.matrix[0][0]=this.evalParam(0),this.matrix[0][1]=this.evalParam(1),this.matrix[0][2]=this.evalParam(2),this.matrix[1][0]=this.evalParam(3),this.matrix[1][1]=this.evalParam(4),this.matrix[1][2]=this.evalParam(5),this.matrix[2][0]=this.evalParam(6),this.matrix[2][1]=this.evalParam(7),this.matrix[2][2]=this.evalParam(8)})},apply:function(a){return this.update(),null!=arguments[1]?JXG.Math.matVecMult(this.matrix,a.initialCoords.usrCoords):JXG.Math.matVecMult(this.matrix,a.coords.usrCoords)},applyOnce:function(a){var b,c,d;if(JXG.isArray(a))for(c=a.length,d=0;c>d;d++)this.update(),b=JXG.Math.matVecMult(this.matrix,a[d].coords.usrCoords),a[d].coords.setCoordinates(JXG.COORDS_BY_USER,b);else this.update(),b=JXG.Math.matVecMult(this.matrix,a.coords.usrCoords),a.coords.setCoordinates(JXG.COORDS_BY_USER,b)},bindTo:function(a){var b,c;if(JXG.isArray(a))for(c=a.length,b=0;c>b;b++)a[b].transformations.push(this);else a.transformations.push(this)},setProperty:function(){},melt:function(a){var c,d,e,f,g,h,b=[];for(d=a.matrix.length,e=this.matrix[0].length,c=0;d>c;c++)b[c]=[];for(this.update(),a.update(),c=0;d>c;c++)for(h=0;e>h;h++){for(g=0,f=0;d>f;f++)g+=a.matrix[c][f]*this.matrix[f][h];b[c][h]=g}return this.update=function(){var a=this.matrix.length,d=this.matrix[0].length;for(c=0;a>c;c++)for(h=0;d>h;h++)this.matrix[c][h]=b[c][h]},this}}),JXG.createTransform=function(a,b,c){return new JXG.Transformation(a,c.type,b)},JXG.JSXGraph.registerElement("transform",JXG.createTransform),JXG.Turtle=function(a,b,c){this.constructor(a,c,JXG.OBJECT_TYPE_TURTLE,JXG.OBJECT_CLASS_OTHER);var d,e,f;return this.turtleIsHidden=!1,this.board=a,this.visProp.curveType="plot",this._attributes=JXG.copyAttributes(this.visProp,a.options,"turtle"),delete this._attributes.id,d=0,e=0,f=90,0!=b.length&&(3==b.length?(d=b[0],e=b[1],f=b[2]):2==b.length?JXG.isArray(b[0])?(d=b[0][0],e=b[0][1],f=b[1]):(d=b[0],e=b[1]):(d=b[0][0],e=b[0][1])),this.init(d,e,f),this},JXG.Turtle.prototype=new JXG.GeometryElement,JXG.extend(JXG.Turtle.prototype,{init:function(a,b,c){this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY),this.pos=[a,b],this.isPenDown=!0,this.dir=90,this.stack=[],this.objects=[],this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.turtle=this.board.create("point",this.pos,{fixed:!0,name:" ",visible:!1,withLabel:!1}),this.objects.push(this.turtle),this.turtle2=this.board.create("point",[this.pos[0],this.pos[1]+this.arrowLen],{fixed:!0,name:" ",visible:!1,withLabel:!1}),this.objects.push(this.turtle2),this.visProp.arrow.lastArrow=!0,this.visProp.arrow.straightFirst=!1,this.visProp.arrow.straightLast=!1,this.arrow=this.board.create("line",[this.turtle,this.turtle2],this.visProp.arrow),this.objects.push(this.arrow),this.right(90-c),this.board.update()},forward:function(a){if(0===a)return this;var b=a*Math.cos(this.dir*Math.PI/180),c=a*Math.sin(this.dir*Math.PI/180);if(!this.turtleIsHidden){var d=this.board.create("transform",[b,c],{type:"translate"});d.applyOnce(this.turtle),d.applyOnce(this.turtle2)}return this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]+=b,this.pos[1]+=c,this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update(),this},back:function(a){return this.forward(-a)},right:function(a){if(this.dir-=a,this.dir%=360,!this.turtleIsHidden){var b=this.board.create("transform",[-a*Math.PI/180,this.turtle],{type:"rotate"});b.applyOnce(this.turtle2)}return this.board.update(),this},left:function(a){return this.right(-a)},penUp:function(){return this.isPenDown=!1,this},penDown:function(){return this.isPenDown=!0,this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this},clean:function(){for(var a=0;a<this.objects.length;a++){var b=this.objects[a];b.type==JXG.OBJECT_TYPE_CURVE&&(this.board.removeObject(b.id),this.objects.splice(a,1))}return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},clearScreen:function(){for(var a=0;a<this.objects.length;a++){var b=this.objects[a];this.board.removeObject(b.id)}return this.init(0,0,90),this},setPos:function(a,b){if(this.pos=JXG.isArray(a)?a:[a,b],!this.turtleIsHidden){this.turtle.setPositionDirectly(JXG.COORDS_BY_USER,[a,b]),this.turtle2.setPositionDirectly(JXG.COORDS_BY_USER,[a,b+this.arrowLen]);var c=this.board.create("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"});c.applyOnce(this.turtle2)}return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},setPenSize:function(a){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeWidth",a)),this.objects.push(this.curve),this},setPenColor:function(a){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeColor",a)),this.objects.push(this.curve),this},setHighlightPenColor:function(a){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("highlightStrokeColor",a)),this.objects.push(this.curve),this},setProperty:function(a){var b,c,e,d=this.objects.length;for(b=0;d>b;b++)c=this.objects[b],c.type==JXG.OBJECT_TYPE_CURVE&&c.setProperty(a);return e=this.visProp.id,this.visProp=JXG.deepCopy(this.curve.visProp),this.visProp.id=e,this._attributes=JXG.deepCopy(this.visProp),delete this._attributes.id,this},copyAttr:function(a,b){return this._attributes[a.toLowerCase()]=b,this._attributes},showTurtle:function(){return this.turtleIsHidden=!1,this.arrow.setProperty("visible:true"),this.setPos(this.pos[0],this.pos[1]),this.board.update(),this},hideTurtle:function(){return this.turtleIsHidden=!0,this.arrow.setProperty("visible:false"),this.setPos(this.pos[0],this.pos[1]),this.board.update(),this},home:function(){return this.pos=[0,0],this.setPos(this.pos[0],this.pos[1]),this},pushTurtle:function(){return this.stack.push([this.pos[0],this.pos[1],this.dir]),this},popTurtle:function(){var a=this.stack.pop();return this.pos[0]=a[0],this.pos[1]=a[1],this.dir=a[2],this.setPos(this.pos[0],this.pos[1]),this},lookTo:function(a){if(JXG.isArray(a)){var f,b=this.pos[0],c=this.pos[1],d=a[0],e=a[1];f=Math.atan2(e-c,d-b),this.right(this.dir-180*f/Math.PI)}else JXG.isNumber(a)&&this.right(this.dir-a);return this},moveTo:function(a){if(JXG.isArray(a)){var b=a[0]-this.pos[0],c=a[1]-this.pos[1];if(!this.turtleIsHidden){var d=this.board.create("transform",[b,c],{type:"translate"});d.applyOnce(this.turtle),d.applyOnce(this.turtle2)}this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]=a[0],this.pos[1]=a[1],this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update()}return this},fd:function(a){return this.forward(a)},bk:function(a){return this.back(a)},lt:function(a){return this.left(a)},rt:function(a){return this.right(a)},pu:function(){return this.penUp()},pd:function(){return this.penDown()},ht:function(){return this.hideTurtle()},st:function(){return this.showTurtle()},cs:function(){return this.clearScreen()},push:function(){return this.pushTurtle()},pop:function(){return this.popTurtle()},evalAt:function(a,b){var c,d,e,f,g=this.objects.length;for(c=0,d=0;g>c;c++)if(e=this.objects[c],e.elementClass==JXG.OBJECT_CLASS_CURVE){if(a>=d&&a<d+e.numberPoints)return f=a-d,e[b](f);d+=e.numberPoints}return this[b]()},X:function(a){return"undefined"==typeof a?this.pos[0]:this.evalAt(a,"X")},Y:function(a){return"undefined"==typeof a?this.pos[1]:this.evalAt(a,"Y")},Z:function(){return 1},minX:function(){return 0},maxX:function(){var b,d,a=0,c=this.objects.length;for(b=0;c>b;b++)d=this.objects[b],d.elementClass==JXG.OBJECT_CLASS_CURVE&&(a+=this.objects[b].numberPoints);return a},hasPoint:function(a,b){var c,d;for(c=0;c<this.objects.length;c++)if(d=this.objects[c],d.type==JXG.OBJECT_TYPE_CURVE&&d.hasPoint(a,b))return!0;return!1}}),JXG.createTurtle=function(a,b,c){var d;return b=b||[],d=JXG.copyAttributes(c,a.options,"turtle"),new JXG.Turtle(a,b,d)},JXG.JSXGraph.registerElement("turtle",JXG.createTurtle),JXG.rgbParser=function(){var a,c,d,e,f,b=!1;if(0===arguments.length)return[];if(arguments.length>=3&&(arguments[0]=[arguments[0],arguments[1],arguments[2]],arguments.length=1),a=arguments[0],JXG.isArray(a)){for(c=0;3>c;c++)b|=/\./.test(arguments[0][c].toString());for(c=0;3>c;c++)b&=arguments[0][c]>=0&arguments[0][c]<=1;return b?[Math.ceil(255*arguments[0][0]),Math.ceil(255*arguments[0][1]),Math.ceil(255*arguments[0][2])]:(arguments[0].length=3,arguments[0])}"string"==typeof arguments[0]&&(a=arguments[0]),"#"==a.charAt(0)&&(a=a.substr(1,6)),a=a.replace(/ /g,"").toLowerCase();var g={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};a=g[a]||a;var h=[{re:/^\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]{1,3})\s*\)\s*$/,example:["rgba(123, 234, 45, 0.5)","rgba(255,234,245,1.0)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}];for(c=0;c<h.length;c++){var l,i=h[c].re,j=h[c].process,k=i.exec(a);k&&(l=j(k),d=l[0],e=l[1],f=l[2])}return isNaN(d)||isNaN(e)||isNaN(f)?[]:(d=0>d||isNaN(d)?0:d>255?255:d,e=0>e||isNaN(e)?0:e>255?255:e,f=0>f||isNaN(f)?0:f>255?255:f,[d,e,f])},JXG.rgb2css=function(){var a,b,c;return a=JXG.rgbParser.apply(JXG.rgbParser,arguments),b=a[1],c=a[2],a=a[0],"rgb("+a+", "+b+", "+c+")"},JXG.rgb2hex=function(){var a,b,c;return a=JXG.rgbParser.apply(JXG.rgbParser,arguments),b=a[1],c=a[2],a=a[0],a=a.toString(16),b=b.toString(16),c=c.toString(16),1==a.length&&(a="0"+a),1==b.length&&(b="0"+b),1==c.length&&(c="0"+c),"#"+a+b+c},JXG.hex2rgb=function(a){var b,c,d;return"#"==a.charAt(0)&&(a=a.slice(1)),b=parseInt(a.substr(0,2),16),c=parseInt(a.substr(2,2),16),d=parseInt(a.substr(4,2),16),"rgb("+b+", "+c+", "+d+")"},JXG.hsv2rgb=function(a,b,c){var d,e,f,g,h,i,j,k,l;if(a=(a%360+360)%360,0==b){if(!(isNaN(a)||a<JXG.Math.eps))return"#ffffff";d=c,e=c,f=c}else switch(i=a>=360?0:a,i/=60,h=Math.floor(i),g=i-h,j=c*(1-b),k=c*(1-b*g),l=c*(1-b*(1-g)),h){case 0:d=c,e=l,f=j;break;case 1:d=k,e=c,f=j;break;case 2:d=j,e=c,f=l;break;case 3:d=j,e=k,f=c;break;case 4:d=l,e=j,f=c;break;case 5:d=c,e=j,f=k}return d=Math.round(255*d).toString(16),d=2==d.length?d:1==d.length?"0"+d:"00",e=Math.round(255*e).toString(16),e=2==e.length?e:1==e.length?"0"+e:"00",f=Math.round(255*f).toString(16),f=2==f.length?f:1==f.length?"0"+f:"00",["#",d,e,f].join("")},JXG.rgb2hsv=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n;return a=JXG.rgbParser.apply(JXG.rgbParser,arguments),b=a[1],c=a[2],a=a[0],n=JXG.Math.Statistics,d=a/255,e=b/255,f=c/255,l=n.max([a,b,c]),m=n.min([a,b,c]),g=l/255,h=m/255,k=g,j=0,k>0&&(j=(k-h)/(1*k)),i=1/(g-h),j>0&&(i=l==a?(e-f)*i:l==b?2+(f-d)*i:4+(d-e)*i),i*=60,0>i&&(i+=360),l==m&&(i=0),[i,j,k]},JXG.rgb2LMS=function(){var a,b,c,d,e,f,g,h=[[.05059983,.08585369,.0095242],[.01893033,.08925308,.01370054],[.00292202,.00975732,.07145979]];return a=JXG.rgbParser.apply(JXG.rgbParser,arguments),b=a[1],c=a[2],a=a[0],a=Math.pow(a,.476190476),b=Math.pow(b,.476190476),c=Math.pow(c,.476190476),d=a*h[0][0]+b*h[0][1]+c*h[0][2],e=a*h[1][0]+b*h[1][1]+c*h[1][2],f=a*h[2][0]+b*h[2][1]+c*h[2][2],g=[d,e,f],g.l=d,g.m=e,g.s=f,g},JXG.LMS2rgb=function(a,b,c){var d,e,f,g,h=[[30.830854,-29.832659,1.610474],[-6.481468,17.715578,-2.532642],[-.37569,-1.199062,14.273846]];d=a*h[0][0]+b*h[0][1]+c*h[0][2],e=a*h[1][0]+b*h[1][1]+c*h[1][2],f=a*h[2][0]+b*h[2][1]+c*h[2][2];var i=function(a){for(var b=127,c=64;c>0;){if(Math.pow(b,.476190476)>a)b-=c;else{if(Math.pow(b+1,.476190476)>a)return b;b+=c}c/=2}return 254==b&&a>13.994955247?255:b};return d=i(d),e=i(e),f=i(f),g=[d,e,f],g.r=d,g.g=e,g.b=f,g},JXG.rgba2rgbo=function(a){var b;return 9==a.length&&"#"==a.charAt(0)?(b=parseInt(a.substr(7,2).toUpperCase(),16)/255,a=a.substr(0,7)):b=1,[a,b]},JXG.rgbo2rgba=function(a,b){var c;return"none"==a?a:(c=Math.round(255*b).toString(16),1==c.length&&(c="0"+c),a+c)},JXG.rgb2bw=function(a){if("none"==a)return a;var b,d,e,c="0123456789ABCDEF";return e=JXG.rgbParser(a),b=.3*e[0]+.59*e[1]+.11*e[2],d=c.charAt(15&b>>4)+c.charAt(15&b),a="#"+d+d+d},JXG.rgb2cb=function(a,b){if("none"==a)return a;var c,d,e,f,g,h,i,j,k,l,m,n,o;switch(g=JXG.rgb2LMS(a),d=g.l,e=g.m,f=g.s,b=b.toLowerCase()){case"protanopia":i=-.06150039994295001,j=.08277001656812001,k=-.013200141220000003,l=.05858939668799999,m=-.07934519995360001,n=.013289415272000003,o=.6903216543277437,h=f/e,d=o>h?-(j*e+k*f)/i:-(m*e+n*f)/l;break;case"tritanopia":i=-.00058973116217,j=.007690316482,k=-.01011703519052,l=.025495080838999994,m=-.0422740347,n=.017005316784,o=.8349489908460004,h=e/d,f=o>h?-(i*d+j*e)/k:-(l*d+m*e)/n;break;default:i=-.06150039994295001,j=.08277001656812001,k=-.013200141220000003,l=.05858939668799999,m=-.07934519995360001,n=.013289415272000003,o=.5763833686400911,h=f/d,e=o>h?-(i*d+k*f)/j:-(l*d+n*f)/m}c=JXG.LMS2rgb(d,e,f);var p="0123456789ABCDEF";return h=p.charAt(15&c.r>>4)+p.charAt(15&c.r),a="#"+h,h=p.charAt(15&c.g>>4)+p.charAt(15&c.g),a+=h,h=p.charAt(15&c.b>>4)+p.charAt(15&c.b),a+=h},JXG.extend(JXG.Board.prototype,{angle:function(a,b,c){return JXG.Math.Geometry.angle(a,b,c)},rad:function(a,b,c){return JXG.Math.Geometry.rad(a,b,c)},distance:function(a,b){return JXG.Math.Geometry.distance(a,b)},pow:function(a,b){return JXG.Math.pow(a,b)},round:function(a,b){return a.toFixed(b)},cosh:function(a){return JXG.Math.cosh(a)},sinh:function(a){return JXG.Math.sinh(a)},sgn:function(a){return 0==a?0:a/Math.abs(a)},D:function(a,b){return JXG.Math.Numerics.D(a,b)},I:function(a,b){return JXG.Math.Numerics.I(a,b)},root:function(a,b,c){return JXG.Math.Numerics.root(a,b,c)},lagrangePolynomial:function(a){return JXG.Math.Numerics.lagrangePolynomial(a)},neville:function(a){return JXG.Math.Numerics.Neville(a)},riemannsum:function(a,b,c,d,e){return JXG.Math.Numerics.riemannsum(a,b,c,d,e)},abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,random:Math.random,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,trunc:Math.ceil,factorial:function(a){return JXG.Math.factorial(a)},binomial:function(a,b){return JXG.Math.binomial(a,b)},getElement:function(a){return JXG.getReference(this,a)},intersectionOptions:["point",[[JXG.OBJECT_CLASS_LINE,JXG.OBJECT_CLASS_LINE],[JXG.OBJECT_CLASS_LINE,JXG.OBJECT_CLASS_CIRCLE],[JXG.OBJECT_CLASS_CIRCLE,JXG.OBJECT_CLASS_CIRCLE]]],intersection:function(a,b,c,d){return a=JXG.getReference(this,a),b=JXG.getReference(this,b),a.elementClass==JXG.OBJECT_CLASS_CURVE&&b.elementClass==JXG.OBJECT_CLASS_CURVE?function(){return JXG.Math.Geometry.meetCurveCurve(a,b,c,d,a.board)}:a.type==JXG.OBJECT_TYPE_ARC&&b.elementClass==JXG.OBJECT_CLASS_LINE||b.type==JXG.OBJECT_TYPE_ARC&&a.elementClass==JXG.OBJECT_CLASS_LINE?function(){return JXG.Math.Geometry.meet(a.stdform,b.stdform,c,a.board)}:a.elementClass==JXG.OBJECT_CLASS_CURVE&&b.elementClass==JXG.OBJECT_CLASS_LINE||b.elementClass==JXG.OBJECT_CLASS_CURVE&&a.elementClass==JXG.OBJECT_CLASS_LINE?function(){return JXG.Math.Geometry.meetCurveLine(a,b,c,a.board)}:function(){return JXG.Math.Geometry.meet(a.stdform,b.stdform,c,a.board)}},intersectionFunc:function(a,b,c,d){return this.intersection(a,b,c,d)},otherIntersection:function(a,b,c){return a=JXG.getReference(this,a),b=JXG.getReference(this,b),function(){var d=JXG.Math.Geometry.meet(a.stdform,b.stdform,0,a.board);return Math.abs(c.X()-d.usrCoords[1])>JXG.Math.eps||Math.abs(c.Y()-d.usrCoords[2])>JXG.Math.eps||Math.abs(c.Z()-d.usrCoords[0])>JXG.Math.eps?d:JXG.Math.Geometry.meet(a.stdform,b.stdform,1,a.board)}},pointFunc:function(){return[null]},pointOptions:["point",[[JXG.OBJECT_CLASS_POINT]]],lineFunc:function(){return arguments},lineOptions:["line",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],linesegmentFunc:function(){return arguments},linesegmentOptions:["line",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],linesegmentAtts:{straightFirst:!1,straightLast:!1},arrowFunc:function(){return arguments},arrowOptions:["arrow",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],circleFunc:function(){return arguments},circleOptions:["circle",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT],[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE],[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_CIRCLE]]],arrowparallelOptions:["arrowparallel",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]],arrowparallelFunc:function(){return arguments},bisectorOptions:["bisector",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],bisectorFunc:function(){return arguments},circumcircleOptions:["circumcircle",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],circumcircleFunc:function(){return arguments},circumcirclemidpointOptions:["circumcirclemidpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],circumcirclemidpointFunc:function(){return arguments},integralOptions:["integral",[[]]],integralFunc:function(){return arguments},midpointOptions:["midpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT],[JXG.OBJECT_CLASS_LINE]]],midpointFunc:function(){return arguments},mirrorpointOptions:["mirrorpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],mirrorpointFunc:function(){return arguments},normalOptions:["normal",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]],normalFunc:function(){return arguments},parallelOptions:["parallel",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]],parallelFunc:function(){return arguments},parallelpointOptions:["parallelpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],parallelpointFunc:function(){return arguments},perpendicularOptions:["perpendicular",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]],perpendicularFunc:function(){return arguments},perpendicularpointOptions:["perpendicularpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]],perpendicularpointFunc:function(){return arguments},reflectionOptions:["reflection",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]],reflectionFunc:function(){return arguments}}),JXG.Point.prototype.setPositionX=function(a,b){var c=a==JXG.COORDS_BY_USER?this.coords.usrCoords[2]:this.coords.scrCoords[2];this.setPosition(a,[b,c])},JXG.Point.prototype.setPositionY=function(a,b){var c=a==JXG.COORDS_BY_USER?this.coords.usrCoords[1]:this.coords.scrCoords[1];this.setPosition(a,[c,b])},JXG.Ticks=function(a,b,c){if(this.constructor(a.board,c,JXG.OBJECT_TYPE_TICKS,JXG.OBJECT_CLASS_OTHER),this.line=a,this.board=this.line.board,this.ticksFunction=null,this.fixedTicks=null,this.equidistant=!1,JXG.isFunction(b))throw this.ticksFunction=b,new Error("Function arguments are no longer supported.");JXG.isArray(b)?this.fixedTicks=b:(Math.abs(b)<JXG.Math.eps&&(b=c.defaultdistance),this.ticksFunction=function(){return b},this.equidistant=!0),this.minTicksDistance=c.minticksdistance,this.maxTicksDistance=c.maxticksdistance,this.labels=[],this.id=this.line.addTicks(this),this.board.setId(this,"Ti")},JXG.Ticks.prototype=new JXG.GeometryElement,JXG.extend(JXG.Ticks.prototype,{hasPoint:function(){return!1},calculateTicksCoordinates:function(){var h,i,k,l,m,n,o,p,q,u,x,y,z,A,C,D,E,H,I,J,K,a=this.line.point1,b=this.line.point2,c=a.Dist(b),d=(b.coords.usrCoords[1]-a.coords.usrCoords[1])/c,e=(b.coords.usrCoords[2]-a.coords.usrCoords[2])/c,f=a.coords.distance(JXG.COORDS_BY_SCREEN,new JXG.Coords(JXG.COORDS_BY_USER,[a.coords.usrCoords[1]+d,a.coords.usrCoords[2]+e],this.board)),g=this.equidistant?this.ticksFunction(1):1,j=5,s=0,t=0,v=2,w=-1,B=JXG.Math.eps,F=.5*this.visProp.majorheight,G=.5*this.visProp.minorheight;if(0!==this.board.canvasWidth&&0!==this.board.canvasHeight)if(this.minStyle=this.visProp.minorheight<0?"infinite":"finite",this.majStyle=this.visProp.majorheight<0?"infinite":"finite",D=this.line.visProp.straightfirst?Number.NEGATIVE_INFINITY:0+B,E=this.line.visProp.straightlast?Number.POSITIVE_INFINITY:c-B,H=this.line.stdform[1],I=this.line.stdform[2],J=H,K=I,y=Math.sqrt(H*H*this.board.unitX*this.board.unitX+I*I*this.board.unitY*this.board.unitY),H*=F/y*this.board.unitX,I*=F/y*this.board.unitY,J*=G/y*this.board.unitX,K*=G/y*this.board.unitY,this.removeTickLabels(),this.ticks=[],this.labels=[],this.equidistant){h=g,g*=this.visProp.scale,this.visProp.insertticks&&this.minTicksDistance>JXG.Math.eps&&(i=this._adjustTickDistance(g,f,j,a.coords,d,e),g*=i,h*=i),this.visProp.insertticks||(g/=this.visProp.minorticks+1,h/=this.visProp.minorticks+1),this.ticksDelta=g,this.symbTicksDelta=h,z=this.board.getBoundingBox(),s=.5*(z[0]+z[2]),t=.5*(z[1]+z[3]),A=[s*this.line.stdform[2]-t*this.line.stdform[1],-this.line.stdform[2],this.line.stdform[1]],x=JXG.Math.crossProduct(this.line.stdform,A),x[1]/=x[0],x[2]/=x[0],x[0]=1,k=new JXG.Coords(JXG.COORDS_BY_USER,x.slice(1),this.board),y=a.coords.distance(JXG.COORDS_BY_USER,k),((b.X()-a.X())*(x[1]-a.X())<0||(b.Y()-a.Y())*(x[2]-a.Y())<0)&&(y*=-1),p=Math.round(y/g)*g,Math.abs(p)>JXG.Math.eps&&(w=Math.abs(p)/p),x[1]=a.coords.usrCoords[1]+d*p,x[2]=a.coords.usrCoords[2]+e*p,l=p,p=0,q=0,m=l/this.visProp.scale,s=x[1],t=x[2],n=0,o=0;do k=new JXG.Coords(JXG.COORDS_BY_USER,[s,t],this.board),k.major=0===Math.round((w*p+l)/g)%(this.visProp.minorticks+1),u=this._tickEndings(k,H,I,J,K,k.major),2==u.length?(C=w*q+m,(Math.abs(C)<=B&&this.visProp.drawzero||C>D&&E>C)&&(this.ticks.push(u),k.major?this.labels.push(this._makeLabel(C,k,this.board,this.visProp.drawlabels,this.id,n)):this.labels.push(null),n++),2==v&&(w*=-1),(0===o%2||1===v)&&(p+=g,q+=h)):(w*=-1,v--),o++,s=x[1]+w*d*p,t=x[2]+w*e*p;while(v>0);this.needsUpdate=!0,this.updateRenderer()}else for(n=0;n<this.fixedTicks.length;n++)s=a.coords.usrCoords[1]+this.fixedTicks[n]*d,t=a.coords.usrCoords[2]+this.fixedTicks[n]*e,k=new JXG.Coords(JXG.COORDS_BY_USER,[s,t],this.board),u=this._tickEndings(k,H,I,J,K,!0),2==u.length&&this.fixedTicks[n]>=D&&this.fixedTicks[n]<E&&this.ticks.push(u),this.labels.push(this._makeLabel(this.visProp.labels[n]||this.fixedTicks[n],k,this.board,this.visProp.drawlabels,this.id,n))},_adjustTickDistance:function(a,b,c,d,e,f){for(var g,h,i=1;b>4*this.minTicksDistance;)i/=10,g=d.usrCoords[1]+e*a*i,h=d.usrCoords[2]+f*a*i,b=d.distance(JXG.COORDS_BY_SCREEN,new JXG.Coords(JXG.COORDS_BY_USER,[g,h],this.board));for(;b<this.minTicksDistance;)i*=c,c=5==c?2:5,g=d.usrCoords[1]+e*a*i,h=d.usrCoords[2]+f*a*i,b=d.distance(JXG.COORDS_BY_SCREEN,new JXG.Coords(JXG.COORDS_BY_USER,[g,h],this.board));return i},_tickEndings:function(a,b,c,d,e,f){var h,m,n,o,p,q,r,i=this.board.canvasWidth,j=this.board.canvasHeight,k=[-1e3*i,-1e3*j],l=[-1e3*i,-1e3*j],s=0,t=!1;return h=a.scrCoords,f?(m=b,n=c,r=this.majStyle):(m=d,n=e,r=this.minStyle),o=m*this.board.unitX,p=n*this.board.unitY,Math.abs(m)<JXG.Math.eps?(k[0]=h[1],k[1]=h[1],l[0]=0,l[1]=j):Math.abs(n)<JXG.Math.eps?(k[0]=0,k[1]=i,l[0]=h[2],l[1]=h[2]):(s=0,q=JXG.Math.crossProduct([0,0,1],[-p*h[1]-o*h[2],p,o]),q[1]/=q[0],q[1]>=0&&q[1]<=i&&(k[s]=q[1],l[s]=0,s++),q=JXG.Math.crossProduct([0,1,0],[-p*h[1]-o*h[2],p,o]),q[2]/=q[0],q[2]>=0&&q[2]<=j&&(k[s]=0,l[s]=q[2],s++),2>s&&(q=JXG.Math.crossProduct([j*j,0,-j],[-p*h[1]-o*h[2],p,o]),q[1]/=q[0],q[1]>=0&&q[1]<=i&&(k[s]=q[1],l[s]=j,s++)),2>s&&(q=JXG.Math.crossProduct([i*i,-i,0],[-p*h[1]-o*h[2],p,o]),q[2]/=q[0],q[2]>=0&&q[2]<=j&&(k[s]=i,l[s]=q[2]))),t=k[0]>=0&&k[0]<=i&&l[0]>=0&&l[0]<=j||k[1]>=0&&k[1]<=i&&l[1]>=0&&l[1]<=j?!0:!1,"finite"==r&&(k[0]=h[1]+m,l[0]=h[2]-n,k[1]=h[1]-m,l[1]=h[2]+n),t?[k,l]:[]},_makeLabel:function(a,b,c,d,e,f){var g,h,i,j="number"==typeof a;return d?(g=a.toString(),Math.abs(a)<JXG.Math.eps&&(g="0"),j&&(g.length>5||-1!=g.indexOf("e"))&&(g=a.toPrecision(3).toString()),j&&g.indexOf(".")>-1&&(g=g.replace(/0+$/,""),g=g.replace(/\.$/,"")),this.visProp.scalesymbol.length>0&&"1"===g?g=this.visProp.scalesymbol:this.visProp.scalesymbol.length>0&&"0"===g?g="0":g+=this.visProp.scalesymbol,i={id:e+f+"Label",isLabel:!0,layer:c.options.layer.line,highlightStrokeColor:c.options.text.strokeColor,highlightStrokeWidth:c.options.text.strokeWidth,highlightStrokeOpacity:c.options.text.strokeOpacity,visible:this.visProp.visible,priv:this.visProp.priv},i=JXG.deepCopy(i,this.visProp.label),h=JXG.createText(c,[b.usrCoords[1],b.usrCoords[2],g],i),h.isDraggable=!1,h.dump=!1,h.distanceX=this.visProp.label.offset[0],h.distanceY=this.visProp.label.offset[1],h.setCoords(b.usrCoords[1]+h.distanceX/c.unitX,b.usrCoords[2]+h.distanceY/c.unitY),h.visProp.visible=d,h):null
},removeTickLabels:function(){var a;if(null!=this.labels&&(this.board.needsFullUpdate||this.needsRegularUpdate)&&("canvas"!=this.board.options.renderer||"internal"!=this.board.options.text.display))for(a=0;a<this.labels.length;a++)null!=this.labels[a]&&this.board.removeObject(this.labels[a])},update:function(){return this.needsUpdate&&this.calculateTicksCoordinates(),this},updateRenderer:function(){return this.needsUpdate&&(this.ticks&&this.board.renderer.updateTicks(this,this.dxMaj,this.dyMaj,this.dxMin,this.dyMin,this.minStyle,this.majStyle),this.needsUpdate=!1),this},hideElement:function(){var a;for(this.visProp.visible=!1,this.board.renderer.hide(this),a=0;a<this.labels.length;a++)JXG.exists(this.labels[a])&&this.labels[a].hideElement();return this},showElement:function(){var a;for(this.visProp.visible=!0,this.board.renderer.show(this),a=0;a<this.labels.length;a++)JXG.exists(this.labels[a])&&this.labels[a].showElement();return this}}),JXG.createTicks=function(a,b,c){var d,e,f=JXG.copyAttributes(c,a.options,"ticks");if(e=b.length<2?c.ticksDistance:b[1],b[0].elementClass!=JXG.OBJECT_CLASS_LINE||!(JXG.isFunction(b[1])||JXG.isArray(b[1])||JXG.isNumber(b[1])))throw new Error("JSXGraph: Can't create Ticks with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.");return d=new JXG.Ticks(b[0],e,f)},JXG.JSXGraph.registerElement("ticks",JXG.createTicks),JXG.Util={},JXG.Util.Unzip=function(a){function B(){return x+=8,u<t.length?t[u++]:-1}function C(){w=1}function D(){var a;return x++,a=1&w,w>>=1,0==w&&(w=B(),a=1&w,w=128|w>>1),a}function E(a){for(var b=0,c=a;c--;)b=b<<1|D();return a&&(b=n[b]>>8-a),b}function F(){j=0}function G(a){m++,i[j++]=a,b.push(String.fromCharCode(a)),32768==j&&(j=0)}function H(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1}function U(){for(;;){if(R[Q]>=T)return-1;if(S[R[Q]]==Q)return R[Q]++;R[Q]++}}function V(){var b,a=M[L];if(d&&document.write("<br>len:"+Q+" treepos:"+L),17==Q)return-1;if(L++,Q++,b=U(),d&&document.write("<br>IsPat "+b),b>=0)a.b0=b,d&&document.write("<br>b0 "+a.b0);else if(a.b0=32768,d&&document.write("<br>b0 "+a.b0),V())return-1;if(b=U(),b>=0)a.b1=b,d&&document.write("<br>b1 "+a.b1),a.jump=null;else if(a.b1=32768,d&&document.write("<br>b1 "+a.b1),a.jump=M[L],a.jumppos=L,V())return-1;return Q--,0}function W(a,b,c,e){var f;for(d&&document.write("currentTree "+a+" numval "+b+" lengths "+c+" show "+e),M=a,L=0,S=c,T=b,f=0;17>f;f++)R[f]=0;if(Q=0,V())return d&&alert("invalid huffman tree\n"),-1;if(d){document.write("<br>Tree: "+M.length);for(var g=0;32>g;g++)document.write("Places["+g+"].b0="+M[g].b0+"<br>"),document.write("Places["+g+"].b1="+M[g].b1+"<br>")}return 0}function X(a){for(var b,c,g,e=0,f=a[e];;)if(g=D(),d&&document.write("b="+g),g){if(!(32768&f.b1))return d&&document.write("ret1"),f.b1;for(f=f.jump,b=a.length,c=0;b>c;c++)if(a[c]===f){e=c;break}}else{if(!(32768&f.b0))return d&&document.write("ret2"),f.b0;e++,f=a[e]}return d&&document.write("ret3"),-1}function Y(){var a,b,c,e,f;do{switch(a=D(),c=E(2)){case 0:d&&alert("Stored\n");break;case 1:d&&alert("Fixed Huffman codes\n");break;case 2:d&&alert("Dynamic Huffman codes\n");break;case 3:d&&alert("Reserved block type!!\n");break;default:d&&alert("Unexpected value %d!\n",c)}if(0==c){var g,h;for(C(),g=B(),g|=B()<<8,h=B(),h|=B()<<8,65535&(g^~h)&&document.write("BlockLen checksum mismatch\n");g--;)b=B(),G(b)}else if(1==c)for(var k;;)if(k=n[E(7)]>>1,k>23?(k=k<<1|D(),k>199?(k-=128,k=k<<1|D()):(k-=48,k>143&&(k+=136))):k+=256,256>k)G(k);else{if(256==k)break;var f,l;for(k-=257,f=E(p[k])+o[k],k=n[E(5)]>>3,r[k]>8?(l=E(8),l|=E(r[k]-8)<<8):l=E(r[k]),l+=q[k],k=0;f>k;k++){var b=i[32767&j-l];G(b)}}else if(2==c){var k,m,t,u,v,w=new Array(320);for(t=257+E(5),u=1+E(5),v=4+E(4),k=0;19>k;k++)w[k]=0;for(k=0;v>k;k++)w[s[k]]=E(3);for(f=K.length,e=0;f>e;e++)K[e]=new H;if(W(K,19,w,0))return F(),1;if(d){document.write("<br>distanceTree");for(var y=0;y<K.length;y++)document.write("<br>"+K[y].b0+" "+K[y].b1+" "+K[y].jump+" "+K[y].jumppos)}m=t+u,e=0;var z=-1;for(d&&document.write("<br>n="+m+" bits: "+x+"<br>");m>e;)if(z++,k=X(K),d&&document.write("<br>"+z+" i:"+e+" decode: "+k+"    bits "+x+"<br>"),16>k)w[e++]=k;else if(16==k){var A;if(k=3+E(2),e+k>m)return F(),1;for(A=e?w[e-1]:0;k--;)w[e++]=A}else{if(k=17==k?3+E(3):11+E(7),e+k>m)return F(),1;for(;k--;)w[e++]=0}for(f=J.length,e=0;f>e;e++)J[e]=new H;if(W(J,t,w,0))return F(),1;for(f=J.length,e=0;f>e;e++)K[e]=new H;var I=new Array;for(e=t;e<w.length;e++)I[e-t]=w[e];if(W(K,u,I,0))return F(),1;for(d&&document.write("<br>literalTree");;)if(k=X(J),k>=256){var f,l;if(k-=256,0==k)break;for(k--,f=E(p[k])+o[k],k=X(K),r[k]>8?(l=E(8),l|=E(r[k]-8)<<8):l=E(r[k]),l+=q[k];f--;){var b=i[32767&j-l];G(b)}}else G(k)}}while(!a);return F(),C(),0}function Z(){d&&alert("NEXTFILE"),b=[];var a=[];if(k=!1,a[0]=B(),a[1]=B(),d&&alert("type: "+a[0]+" "+a[1]),a[0]==parseInt("78",16)&&a[1]==parseInt("da",16)&&(d&&alert("GEONExT-GZIP"),Y(),d&&alert(b.join("")),g[f]=new Array(2),g[f][0]=b.join(""),g[f][1]="geonext.gxt",f++),a[0]==parseInt("1f",16)&&a[1]==parseInt("8b",16)&&(d&&alert("GZIP"),$(),d&&alert(b.join("")),g[f]=new Array(2),g[f][0]=b.join(""),g[f][1]="file",f++),a[0]==parseInt("50",16)&&a[1]==parseInt("4b",16)&&(k=!0,a[2]=B(),a[3]=B(),a[2]==parseInt("3",16)&&a[3]==parseInt("4",16))){a[0]=B(),a[1]=B(),d&&alert("ZIP-Version: "+a[1]+" "+a[0]/10+"."+a[0]%10),e=B(),e|=B()<<8,d&&alert("gpflags: "+e);var c=B();c|=B()<<8,d&&alert("method: "+c),B(),B(),B(),B();var h=B();h|=B()<<8,h|=B()<<16,h|=B()<<24;var i=B();i|=B()<<8,i|=B()<<16,i|=B()<<24;var j=B();j|=B()<<8,j|=B()<<16,j|=B()<<24,d&&alert("local CRC: "+h+"\nlocal Size: "+j+"\nlocal CompSize: "+i);var n=B();n|=B()<<8;var o=B();for(o|=B()<<8,d&&alert("filelen "+n),q=0,z=[];n--;){var p=B();"/"==p|":"==p?q=0:y-1>q&&(z[q++]=String.fromCharCode(p))}d&&alert("nameBuf: "+z),A||(A=z);for(var q=0;o>q;)p=B(),q++;l=4294967295,m=0,(j=0)&&d&&alert("skipdir"),8==c&&(Y(),d&&alert(b.join("")),g[f]=new Array(2),g[f][0]=b.join(""),g[f][1]=z.join(""),f++),$()}}function $(){var a,c,f,g,h,i,b=[];if(8&e&&(b[0]=B(),b[1]=B(),b[2]=B(),b[3]=B(),b[0]==parseInt("50",16)&&b[1]==parseInt("4b",16)&&b[2]==parseInt("07",16)&&b[3]==parseInt("08",16)?(a=B(),a|=B()<<8,a|=B()<<16,a|=B()<<24):a=b[0]|b[1]<<8|b[2]<<16|b[3]<<24,c=B(),c|=B()<<8,c|=B()<<16,c|=B()<<24,f=B(),f|=B()<<8,f|=B()<<16,f|=B()<<24,d&&alert("CRC:")),k&&Z(),b[0]=B(),8!=b[0])return d&&alert("Unknown compression method!"),0;if(e=B(),d&&e&~parseInt("1f",16)&&alert("Unknown flags set!"),B(),B(),B(),B(),B(),g=B(),4&e)for(b[0]=B(),b[2]=B(),Q=b[0]+256*b[1],d&&alert("Extra field size: "+Q),h=0;Q>h;h++)B();if(8&e){for(h=0,z=[];i=B();)("7"==i||":"==i)&&(h=0),y-1>h&&(z[h++]=i);d&&alert("original file name: "+z)}if(16&e)for(;i=B(););2&e&&(B(),B()),Y(),a=B(),a|=B()<<8,a|=B()<<16,a|=B()<<24,f=B(),f|=B()<<8,f|=B()<<16,f|=B()<<24,k&&Z()}var e,l,m,A,b=[],d=!1,f=0,g=[],i=new Array(32768),j=0,k=!1,n=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],r=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],s=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],t=a,u=0,w=1,x=0,y=256,z=[],I=288,J=new Array(I),K=new Array(32),L=0,M=null;new Array(64),new Array(64);var Q=0,R=new Array(17);R[0]=0;var S,T;JXG.Util.Unzip.prototype.unzipFile=function(a){var b;for(this.unzip(),b=0;b<g.length;b++)if(g[b][1]==a)return g[b][0]},JXG.Util.Unzip.prototype.unzip=function(){return d&&alert(t),Z(),g}},JXG.Util.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var c,d,e,f,g,h,i,b=[],j=0;for(a=JXG.Util.Base64._utf8_encode(a);j<a.length;)c=a.charCodeAt(j++),d=a.charCodeAt(j++),e=a.charCodeAt(j++),f=c>>2,g=(3&c)<<4|d>>4,h=(15&d)<<2|e>>6,i=63&e,isNaN(d)?h=i=64:isNaN(e)&&(i=64),b.push([this._keyStr.charAt(f),this._keyStr.charAt(g),this._keyStr.charAt(h),this._keyStr.charAt(i)].join(""));return b.join("")},decode:function(a,b){var d,e,f,g,h,i,j,c=[],k=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");k<a.length;)g=this._keyStr.indexOf(a.charAt(k++)),h=this._keyStr.indexOf(a.charAt(k++)),i=this._keyStr.indexOf(a.charAt(k++)),j=this._keyStr.indexOf(a.charAt(k++)),d=g<<2|h>>4,e=(15&h)<<4|i>>2,f=(3&i)<<6|j,c.push(String.fromCharCode(d)),64!=i&&c.push(String.fromCharCode(e)),64!=j&&c.push(String.fromCharCode(f));return c=c.join(""),b&&(c=JXG.Util.Base64._utf8_decode(c)),c},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(192|d>>6),b+=String.fromCharCode(128|63&d)):(b+=String.fromCharCode(224|d>>12),b+=String.fromCharCode(128|63&d>>6),b+=String.fromCharCode(128|63&d))}return b},_utf8_decode:function(a){for(var b=[],c=0,d=0,e=0,f=0;c<a.length;)d=a.charCodeAt(c),128>d?(b.push(String.fromCharCode(d)),c++):d>191&&224>d?(e=a.charCodeAt(c+1),b.push(String.fromCharCode((31&d)<<6|63&e)),c+=2):(e=a.charCodeAt(c+1),f=a.charCodeAt(c+2),b.push(String.fromCharCode((15&d)<<12|(63&e)<<6|63&f)),c+=3);return b.join("")},_destrip:function(a,b){var d,e,c=[],f=[];for(null==b&&(b=76),a.replace(/ /g,""),d=a.length/b,e=0;d>e;e++)c[e]=a.substr(e*b,b);for(d!=a.length/b&&(c[c.length]=a.substr(d*b,a.length-d*b)),e=0;e<c.length;e++)f.push(c[e]);return f.join("\n")},decodeAsArray:function(a){var d,b=this.decode(a),c=[];for(d=0;d<b.length;d++)c[d]=b.charCodeAt(d);return c},decodeGEONExT:function(a){return decodeAsArray(destrip(a),!1)}},JXG.Util.asciiCharCodeAt=function(a,b){var c=a.charCodeAt(b);if(c>255)switch(c){case 8364:c=128;break;case 8218:c=130;break;case 402:c=131;break;case 8222:c=132;break;case 8230:c=133;break;case 8224:c=134;break;case 8225:c=135;break;case 710:c=136;break;case 8240:c=137;break;case 352:c=138;break;case 8249:c=139;break;case 338:c=140;break;case 381:c=142;break;case 8216:c=145;break;case 8217:c=146;break;case 8220:c=147;break;case 8221:c=148;break;case 8226:c=149;break;case 8211:c=150;break;case 8212:c=151;break;case 732:c=152;break;case 8482:c=153;break;case 353:c=154;break;case 8250:c=155;break;case 339:c=156;break;case 382:c=158;break;case 376:c=159}return c},JXG.Util.utf8Decode=function(a){var g,b=[],c=0,d=0,f=0;if(!JXG.exists(a))return"";for(;c<a.length;)d=a.charCodeAt(c),128>d?(b.push(String.fromCharCode(d)),c++):d>191&&224>d?(f=a.charCodeAt(c+1),b.push(String.fromCharCode((31&d)<<6|63&f)),c+=2):(f=a.charCodeAt(c+1),g=a.charCodeAt(c+2),b.push(String.fromCharCode((15&d)<<12|(63&f)<<6|63&g)),c+=3);return b.join("")},JXG.Util.genUUID=function(){for(var d,a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=new Array(36),c=0,e=0;36>e;e++)8==e||13==e||18==e||23==e?b[e]="-":14==e?b[e]="4":(2>=c&&(c=0|33554432+16777216*Math.random()),d=15&c,c>>=4,b[e]=a[19==e?8|3&d:d]);return b.join("")},JXG.PsTricks={convert:function(a){var d,e,b=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],a),c=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a.canvasWidth,a.canvasHeight],a),f=[];f.push("\\begin{pspicture*}("+b.usrCoords[1]+","+c.usrCoords[2]+")("+c.usrCoords[1]+","+b.usrCoords[2]+")\n");for(d in a.objects)if(e=a.objects[d],e.visProp.visible)switch(e.elementClass){case JXG.OBJECT_CLASS_CIRCLE:f.push(this.addCircle(e));break;case JXG.OBJECT_CLASS_LINE:f.push(this.addLine(e));break;case JXG.OBJECT_CLASS_POINT:f.push(this.addPoint(e));break;default:switch(e.type){case JXG.OBJECT_TYPE_ARC:f.push(this.addArc(e));break;case JXG.OBJECT_TYPE_SECTOR:f.push(this.addArc(e)),f.push(this.addSector(e));break;case JXG.OBJECT_TYPE_POLYGON:f.push(this.addPolygon(e));break;case JXG.OBJECT_TYPE_ANGLE:f.push(this.addAngle(e))}}return f.push("\\end{pspicture*}"),f.join("\n")},setArrows:function(a){var b="";return a.visProp.firstarrow&&a.visProp.lastarrow?b="{<->}":a.visProp.firstarrow?b="{<-}":a.visProp.lastarrow&&(b="{->}"),b},drawWedge:function(a,b,c,d,e,f){var g="";return"none"!=a&&b>0&&(g+="\\pswedge[linestyle=none, fillstyle=solid, fillcolor="+this.parseColor(a)+", opacity="+b.toFixed(5)+"]",g+="("+c.join(",")+"){"+d+"}{"+e+"}{"+f+"}\n"),g},addPoint:function(a){var b="\\psdot[linecolor="+this.parseColor(a.visProp.strokecolor)+",dotstyle=",c=a.normalizeFace(a.visProp.face)||"o",d=a.visProp.size>4?4:a.visProp.size,e=[0,0,"2pt 2","5pt 2","5pt 3"];return"x"==c?b+="x, dotsize="+e[d]:"o"==c?(b+="*, dotsize=",1==d?b+="2pt 2":2==d?b+="4pt 2":3==d?b+="6pt 2":4==d&&(b+="6pt 3")):"[]"==c?b+="square*, dotsize="+e[d]:"+"==c&&(b+="+, dotsize="+e[d]),b+="]("+a.coords.usrCoords.slice(1).join(",")+")\n",b+="\\rput("+(a.coords.usrCoords[1]+15/a.board.unitY)+","+(a.coords.usrCoords[2]+15/a.board.unitY)+"){\\small $"+a.name+"$}\n"},addLine:function(a){var b=new JXG.Coords(JXG.COORDS_BY_USER,a.point1.coords.usrCoords,a.board),c=new JXG.Coords(JXG.COORDS_BY_USER,a.point2.coords.usrCoords,a.board),d="\\psline[linecolor="+this.parseColor(a.visProp.strokecolor)+", linewidth="+a.visProp.strokewidth+"px]";return(a.visProp.straightfirst||a.visProp.straightlast)&&JXG.Math.Geometry.calcStraight(a,b,c),d+=this.setArrows(a),d+="("+b.usrCoords.slice(1).join(",")+")("+c.usrCoords.slice(2).join(",")+")\n"},addCircle:function(a){var b=a.Radius(),c="\\pscircle[linecolor="+this.parseColor(a.visProp.strokecolor)+", linewidth="+a.visProp.strokewidth+"px";return"none"!=a.visProp.fillcolor&&0!=a.visProp.fillopacity&&(c+=", fillstyle=solid, fillcolor="+this.parseColor(a.visProp.fillcolor)+", opacity="+a.visProp.fillopacity.toFixed(5)),c+="]("+a.center.coords.usrCoords.slice(1).join("1")+"){"+b+"}\n"},addPolygon:function(a){var c,b="\\pspolygon[linestyle=none, fillstyle=solid, fillcolor="+this.parseColor(a.visProp.fillcolor)+", opacity="+a.visProp.fillopacity.toFixed(5)+"]";for(c=0;c<a.vertices.length;c++)b+="("+a.vertices[c].coords.usrCoords.slice(1).join(",")+")";return b+="\n"},addArc:function(a){var b=a.Radius(),c={coords:new JXG.Coords(JXG.COORDS_BY_USER,[a.board.canvasWidth/a.board.unitY,a.center.coords.usrCoords[2]],a.board)},d=JXG.Math.Geometry.trueAngle(c,a.center,a.point2).toFixed(4),e=JXG.Math.Geometry.trueAngle(c,a.center,a.point3).toFixed(4),f="\\psarc[linecolor="+this.parseColor(a.visProp.strokecolor)+", linewidth="+a.visProp.strokewidth+"px]";return f+=this.setArrows(a),f+="("+a.center.coords.usrCoords.slice(1).join(",")+"){"+b+"}{"+d+"}{"+e+"}\n"},addSector:function(a){var b=a.Radius(),c={coords:new JXG.Coords(JXG.COORDS_BY_USER,[a.board.canvasWidth/a.board.unitY,a.point1.coords.usrCoords[2]],a.board)},d=JXG.Math.Geometry.trueAngle(c,a.point1,a.point2).toFixed(4),e=JXG.Math.Geometry.trueAngle(c,a.point1,a.point3).toFixed(4);return this.drawWedge(a.visProp.fillcolor,a.visProp.fillopacity,a.point1.coords.usrCoords.slice(1),b,d,e)},addAngle:function(a){var f,b=a.radius,c={coords:new JXG.Coords(JXG.COORDS_BY_USER,[a.board.canvasWidth/a.board.unitY,a.point2.coords.usrCoords[2]],a.board)},d=JXG.Math.Geometry.trueAngle(c,a.point2,a.point1).toFixed(4),e=JXG.Math.Geometry.trueAngle(c,a.point2,a.point3).toFixed(4);return f=this.drawWedge(a.visProp.fillcolor,a.visProp.fillopacity,a.point2.coords.usrCoords.slice(1),b,d,e),f+="\\psarc[linecolor="+this.parseColor(a.visProp.strokecolor)+", linewidth="+a.visProp.strokewidth+"px]",f+="("+a.point2.coords.usrCoords.slice(1).join(",")+"){"+b+"}{"+d+"}{"+e+"}\n"},parseColor:function(a){var b=JXG.rgbParser(a);return"{[rgb]{"+b[0]/255+","+b[1]/255+","+b[2]/255+"}}"}},JXG.Server=function(){},JXG.Server.modules=function(){},JXG.Server.runningCalls={},JXG.Server.handleError=function(a){alert("error occured, server says: "+a.message)},JXG.Server.callServer=function(a,b,c,d){var e,f,g,h,i,j,k;d=d||!1,h="";for(k in c)h+="&"+escape(k)+"="+escape(c[k]);j=JXG.toJSON(c);do i=a+Math.floor(4096*Math.random());while("undefined"!=typeof this.runningCalls[i]);return this.runningCalls[i]={action:a},"undefined"!=typeof c.module&&(this.runningCalls[i].module=c.module),e=JXG.serverBase+"JXGServer.py",f="action="+escape(a)+"&id="+i+"&dataJSON="+escape(JXG.Util.Base64.encode(j)),this.cbp=function(a){var c,d,e,f,g,h,i,j;if(c=new JXG.Util.Unzip(JXG.Util.Base64.decodeAsArray(a)).unzip(),JXG.isArray(c)&&c.length>0&&(c=c[0][0]),"string"==typeof c)if(d=window.JSON&&window.JSON.parse?window.JSON.parse(c):new Function("return "+c)(),"error"==d.type)this.handleError(d);else if("response"==d.type){for(h=d.id,i=0;i<d.fields.length;i++)e=d.fields[i],f=e.namespace+("object"==typeof new Function("return "+e.namespace)()?".":".prototype.")+e.name+" = "+e.value,new Function(f)();for(i=0;i<d.handler.length;i++){for(e=d.handler[i],g=[],j=0;j<e.parameters.length;j++)g[j]='"'+e.parameters[j]+'": '+e.parameters[j];f="if(typeof JXG.Server.modules."+this.runningCalls[h].module+' == "undefined")JXG.Server.modules.'+this.runningCalls[h].module+" = {};",f+="JXG.Server.modules."+this.runningCalls[h].module+"."+e.name+"_cb = "+e.callback+";",f+="JXG.Server.modules."+this.runningCalls[h].module+"."+e.name+" = function ("+e.parameters.join(",")+', __JXGSERVER_CB__, __JXGSERVER_SYNC) {if(typeof __JXGSERVER_CB__ == "undefined") __JXGSERVER_CB__ = JXG.Server.modules.'+this.runningCalls[h].module+"."+e.name+"_cb;var __JXGSERVER_PAR__ = {"+g.join(",")+', "module": "'+this.runningCalls[h].module+'", "handler": "'+e.name+'" };JXG.Server.callServer("exec", __JXGSERVER_CB__, __JXGSERVER_PAR__, __JXGSERVER_SYNC);};',new Function(f)()}delete this.runningCalls[h],b(d.data)}},this.cb=JXG.bind(this.cbp,this),window.XMLHttpRequest?(g=new XMLHttpRequest,g.overrideMimeType("text/plain; charset=iso-8859-1")):g=new ActiveXObject("Microsoft.XMLHTTP"),g?(g.open("POST",e,!d),g.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d||(g.onreadystatechange=function(a){return function(){switch(g.readyState){case 4:200!=g.status||a(g.responseText);break;default:return!1}}}(this.cb)),g.send(f),d&&this.cb(g.responseText),void 0):!1},JXG.Server.loadModule_cb=function(a){var b;for(b=0;b<a.length;b++)alert(a[b].name+": "+a[b].value)},JXG.Server.loadModule=function(a){return JXG.Server.callServer("load",JXG.Server.loadModule_cb,{module:a},!0)},JXG.Server.load=JXG.Server.loadModule,JXG.DataSource=function(){return this.data=[],this.columnHeaders=[],this.rowHeaders=[],this},JXG.extend(JXG.DataSource.prototype,{loadFromArray:function(a,b,c){var d,e,f;if("undefined"==typeof b&&(b=!1),"undefined"==typeof c&&(c=!1),JXG.isArray(b)&&(this.columnHeaders=b,b=!1),JXG.isArray(c)&&(this.rowHeaders=c,c=!1),this.data=[],b&&(this.columnHeaders=[]),c&&(this.rowHeaders=[]),"undefined"!=typeof a){for(this.data=new Array(a.length),d=0;d<a.length;d++)for(this.data[d]=new Array(a[d].length),e=0;e<a[d].length;e++)f=a[d][e],this.data[d][e]=""+parseFloat(f)==f?parseFloat(f):"-"!=f?f:0/0;if(b&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),c)for(this.rowHeaders=new Array,d=0;d<this.data.length;d++)this.rowHeaders.push(this.data[d][0]),this.data[d]=this.data[d].slice(1)}return this},loadFromTable:function(a,b,c){var d,e,f,g,h;if("undefined"==typeof b&&(b=!1),"undefined"==typeof c&&(c=!1),JXG.isArray(b)&&(this.columnHeaders=b,b=!1),JXG.isArray(c)&&(this.rowHeaders=c,c=!1),this.data=[],b&&(this.columnHeaders=[]),c&&(this.rowHeaders=[]),a=document.getElementById(a),"undefined"!=typeof a){for(d=a.getElementsByTagName("tr"),this.data=new Array(d.length),e=0;e<d.length;e++)for(g=d[e].getElementsByTagName("td"),this.data[e]=new Array(g.length),f=0;f<g.length;f++)h=g[f].innerHTML,this.data[e][f]=""+parseFloat(h)==h?parseFloat(h):"-"!=h?h:0/0;if(b&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),c)for(this.rowHeaders=new Array,e=0;e<this.data.length;e++)this.rowHeaders.push(this.data[e][0]),this.data[e]=this.data[e].slice(1)}return this},addColumn:function(){},addRow:function(){},getColumn:function(a){var c,b=new Array(this.data.length);if("string"==typeof a)for(c=0;c<this.columnHeaders.length;c++)if(a==this.columnHeaders[c]){a=c;break}for(c=0;c<this.data.length;c++)this.data[c].length>a&&(b[c]=parseFloat(this.data[c][a]));return b},getRow:function(a){var b,c;if("string"==typeof a)for(c=0;c<this.rowHeaders.length;c++)if(a==this.rowHeaders[c]){a=c;break}for(b=new Array(this.data[a].length),c=0;c<this.data[a].length;c++)b[c]=this.data[a][c];return b}}),JXG.JessieCode=function(a){this.sstack=[{}],this.scope=0,this.pstack=[[]],this.dpstack=[[]],this.pscope=0,this.propstack=[{}],this.propscope=0,this.propobj=0,this.lhs=[],this.isLHS=!1,this.warnLog="jcwarn",this.builtIn=this.defineBuiltIn(),this.board=null,this.lineToElement={},this.countLines=!0,this.parCurLine=1,this.parCurColumn=0,this.line=1,this.col=1,this.maxRuntime=1e4,"string"==typeof a&&this.parse(a)},JXG.extend(JXG.JessieCode.prototype,{node:function(a,b,c){return{type:a,value:b,children:c}},createNode:function(a,b){var e,d=this.node(a,b,[]);for(e=2;e<arguments.length;e++)d.children.push(arguments[e]);return d.line=this.parCurLine,d.col=this.parCurColumn,d},getElementById:function(a){return this.board.objects[a]},creator:function(){var b,a={};return b=function(b){var c;return"function"==typeof a[this.board.id+b]?a[this.board.id+b]:(c=function(a){return function(c,d){var e;return e=JXG.exists(d)?d:{name:0!==a.lhs[a.scope]?a.lhs[a.scope]:""},a.board.create(b,c,e)}}(this),c.creator=!0,a[this.board.id+b]=c,c)},b.clearCache=function(){a={}},b}(),letvar:function(a,b){this.builtIn[a]&&this._warn('"'+a+'" is a predefined value.'),this.sstack[this.scope][a]=b},isLocalVariable:function(a){var b;for(b=this.scope;b>-1;b--)if(JXG.exists(this.sstack[b][a]))return b;return-1},isCreator:function(a){return!!JXG.JSXGraph.elements[a]},isMathMethod:function(a){return"E"!==a&&!!Math[a]},isBuiltIn:function(a){return!!this.builtIn[a]},getvar:function(a,b){var c,d;return b=JXG.def(b,!1),c=this.isLocalVariable(a),c>-1?this.sstack[c][a]:this.isCreator(a)?this.creator(a):this.isMathMethod(a)?Math[a]:this.isBuiltIn(a)?this.builtIn[a]:b||(c=JXG.getRef(this.board,a),c===a)?d:c},getvarJS:function(a,b,c){var d;if(b=JXG.def(b,!1),c=JXG.def(c,!1),JXG.indexOf(this.pstack[this.pscope],a)>-1)return a;if(d=this.isLocalVariable(a),d>-1)return"$jc$.sstack["+d+"]['"+a+"']";if(this.isCreator(a))return"(function () { var a = Array.prototype.slice.call(arguments, 0), props = "+(c?"a.pop()":"{}")+"; return $jc$.board.create.apply($jc$.board, ['"+a+"'].concat([a, props])); })";if(this.isMathMethod(a))return"Math."+a;if(this.isBuiltIn(a))return this.builtIn[a].src||this.builtIn[a];if(!b){if(JXG.isId(this.board,a))return"$jc$.board.objects['"+a+"']";if(JXG.isName(this.board,a))return"$jc$.board.elementsByName['"+a+"']";if(JXG.isGroup(this.board,a))return"$jc$.board.groups['"+a+"']"}return""},setProp:function(a,b,c){var e,f,d={};a.elementClass!==JXG.OBJECT_CLASS_POINT||"X"!==b&&"Y"!==b?a.type!==JXG.OBJECT_TYPE_TEXT||"X"!==b&&"Y"!==b?a.type&&a.elementClass&&a.visProp?(d[b]=c,a.setProperty(d)):a[b]=c:("number"==typeof c?a[b]=function(){return c}:"function"==typeof c?(a.isDraggable=!1,a[b]=c):"string"==typeof c&&(a.isDraggable=!1,a[b]=JXG.createFunction(c,this.board,null,!0),a[b+"jc"]=c),a[b].origin=c,this.board.update()):(b=b.toLowerCase(),a.isDraggable&&"number"==typeof c?(e="x"===b?c:a.X(),f="y"===b?c:a.Y(),a.setPosition(JXG.COORDS_BY_USER,[e,f])):!a.isDraggable||"function"!=typeof c&&"string"!=typeof c?a.isDraggable||(e="x"===b?c:a.XEval.origin,f="y"===b?c:a.YEval.origin,a.addConstraint([e,f])):(e="x"===b?c:a.coords.usrCoords[1],f="y"===b?c:a.coords.usrCoords[2],a.addConstraint([e,f])),this.board.update())},utf8_encode:function(a){var c,d,b=[];for(c=0;c<a.length;c++)d=a.charCodeAt(c),128>d?b.push(String.fromCharCode(d)):b.push("&#x"+d.toString(16)+";");return b.join("")},parse:function(a,b){var i,k,l,c=0,d=[],e=[],h=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc","If","Deg","Rad","Dist"],j=a.replace(/\r\n/g,"\n").split("\n"),m=[];for(JXG.exists(b)||(b=!1),k=0;k<j.length;k++)if("/"!==JXG.trim(j[k])[0]||"/"!==JXG.trim(j[k])[1]){if(b)for(l=0;l<h.length;l++)i=new RegExp(h[l]+"\\(","g"),j[k]=j[k].replace(i,h[l].toLowerCase()+"(");m.push(j[k])}else m.push("");if(a=m.join("\n"),a=this.utf8_encode(a),(c=this._parse(a,d,e))>0)for(k=0;c>k;k++)this.line=d[k].line,this._error("Parse error in line "+d[k].line+" near >"+a.substr(d[k].offset,30)+'<, expecting "'+e[k].join()+'"')},snippet:function(a,b,c,d){var e,f,g,h;return e="jxg__tmp__intern_"+JXG.Util.genUUID().replace(/\-/g,""),JXG.exists(b)||(b=!0),JXG.exists(c)||(c=""),JXG.exists(d)||(d=!1),g=this.sstack[0][e],this.countLines=!1,f=e+" = "+(b?" function ("+c+") { return ":"")+a+(b?"; }":"")+";",this.parse(f,d),h=this.sstack[0][e],JXG.exists(g)?this.sstack[0][e]=g:delete this.sstack[0][e],this.countLines=!0,h},replaceIDs:function(a){var b,c;if(a.replaced&&(c=this.board.objects[a.children[1].children[0].value],JXG.exists(c)&&JXG.exists(c)&&""!==c.name&&(a.type="node_var",a.value=c.name,a.children.length=0,delete a.replaced)),a.children)for(b=a.children.length;b>0;b--)JXG.exists(a.children[b-1])&&(a.children[b-1]=this.replaceIDs(a.children[b-1]));return a},replaceNames:function(a){var b,c;if(c=a.value,"node_op"==a.type&&"op_lhs"==c&&1===a.children.length?this.isLHS=!0:"node_var"==a.type&&(this.isLHS?this.letvar(c,!0):!JXG.exists(this.getvar(c,!0))&&JXG.exists(this.board.elementsByName[c])&&(a=this.createReplacementNode(a))),a.children)for(b=a.children.length;b>0;b--)JXG.exists(a.children[b-1])&&(a.children[b-1]=this.replaceNames(a.children[b-1]));return"node_op"==a.type&&"op_lhs"==a.value&&1===a.children.length&&(this.isLHS=!1),a},createReplacementNode:function(a){var b=a.value,c=this.board.elementsByName[b];return a=this.createNode("node_op","op_execfun",this.createNode("node_var","$"),this.createNode("node_op","op_param",this.createNode("node_str",c.id))),a.replaced=!0,a},collectDependencies:function(a,b){var c,d,e;if(d=a.value,"node_var"==a.type&&(e=this.getvar(d),e&&e.visProp&&e.type&&e.elementClass&&e.id&&(b[e.id]=e)),"node_op"==a.type&&"op_execfun"==a.value&&a.children.length>1&&"$"==a.children[0].value&&a.children[1].children.length>0&&(e=a.children[1].children[0].value,b[e]=this.board.objects[e]),a.children)for(c=a.children.length;c>0;c--)JXG.exists(a.children[c-1])&&this.collectDependencies(a.children[c-1],b)},resolveProperty:function(a,b,c){return c=JXG.def(c,!1),a&&a.methodMap&&("label"===b?(a=a.label,b="content"):JXG.exists(a.subs)&&JXG.exists(a.subs[b])?a=a.subs:JXG.exists(a.methodMap[b])?b=a.methodMap[b]:(a=a.visProp,b=b.toLowerCase())),JXG.exists(a)||this._error(a+" is not an object"),JXG.exists(a[b])||this._error("unknown property "+b),c&&"function"==typeof a[b]?function(){return a[b].apply(a,arguments)}:a[b]},execute:function(node){var ret,v,i,e,parents=[];if(ret=0,this.cancel&&this._error("Max runtime exceeded"),!node)return ret;switch(this.line=node.line,this.col=node.col,node.type){case"node_op":switch(node.value){case"op_none":node.children[0]&&this.execute(node.children[0]),node.children[1]&&(ret=this.execute(node.children[1]));break;case"op_assign":v=this.execute(node.children[0]),this.lhs[this.scope]=v[1],v[0].type&&v[0].elementClass&&v[0].methodMap&&"label"===v[1]&&this._error("Left-hand side of assignment is read-only."),v[0]!==this.sstack[this.scope]||JXG.isArray(v[0])&&"number"==typeof v[1]?this.setProp(v[0],v[1],this.execute(node.children[1])):this.letvar(v[1],this.execute(node.children[1])),this.lhs[this.scope]=0;break;case"op_noassign":ret=this.execute(node.children[0]);break;case"op_if":this.execute(node.children[0])&&(ret=this.execute(node.children[1]));break;case"op_if_else":ret=this.execute(node.children[0])?this.execute(node.children[1]):this.execute(node.children[2]);break;case"op_while":for(;this.execute(node.children[0]);)this.execute(node.children[1]);break;case"op_do":do this.execute(node.children[0]);while(this.execute(node.children[1]));break;case"op_for":for(this.execute(node.children[0]);this.execute(node.children[1]);this.execute(node.children[2]))this.execute(node.children[3]);break;case"op_param":node.children[1]&&this.execute(node.children[1]),ret=node.children[0],this.pstack[this.pscope].push(ret),this.dpstack[this.pscope]&&this.dpstack[this.pscope].push({line:node.children[0].line,col:node.children[0].col});break;case"op_paramdef":node.children[1]&&this.execute(node.children[1]),ret=node.children[0],this.pstack[this.pscope].push(ret);break;case"op_proplst":node.children[0]&&this.execute(node.children[0]),node.children[1]&&this.execute(node.children[1]);break;case"op_proplst_val":this.propstack.push({}),this.propscope++,this.execute(node.children[0]),ret=this.propstack[this.propscope],this.propstack.pop(),this.propscope--;break;case"op_prop":this.propstack[this.propscope][node.children[0]]=this.execute(node.children[1]);break;case"op_array":var l;for(this.pstack.push([]),this.pscope++,this.execute(node.children[0]),ret=[],l=this.pstack[this.pscope].length,i=0;l>i;i++)ret.push(this.execute(this.pstack[this.pscope][i]));this.pstack.pop(),this.pscope--;break;case"op_extvalue":var undef;ret=this.execute(node.children[0]),i=this.execute(node.children[1]),ret="number"==typeof i&&Math.abs(Math.round(i)-i)<JXG.Math.eps?ret[i]:undef;break;case"op_return":if(0!==this.scope)return this.execute(node.children[0]);this._error("Unexpected return.");break;case"op_function":if(this.pstack.push([]),this.pscope++,this.execute(node.children[0]),this.board.options.jc.compile){for(this.sstack.push({}),this.scope++,this.isLHS=!1,i=0;i<this.pstack[this.pscope].length;i++)this.sstack[this.scope][this.pstack[this.pscope][i]]=this.pstack[this.pscope][i];this.replaceNames(node.children[1]),ret=function($jc$){var p=$jc$.pstack[$jc$.pscope].join(", "),str="var f = function ("+p+") {\n$jc$.sstack.push([]);\n$jc$.scope++;\nvar r = (function () {\n"+$jc$.compile(node.children[1],!0)+"})();\n$jc$.sstack.pop();\n$jc$.scope--;\nreturn r;\n}; f;";try{return eval(str)}catch(e){return this._error("catch errors. super simple stuff.",str,e.toString()),function(){}}}(this),this.sstack.pop(),this.scope--}else ret=function(a,b){return function(){var c;for(b.sstack.push({}),b.scope++,c=0;c<a.length;c++)b.sstack[b.scope][a[c]]=arguments[c];return c=b.execute(node.children[1]),b.sstack.pop(),b.scope--,c}}(this.pstack[this.pscope],this);ret.node=node,ret.toJS=ret.toString,ret.toString=function(a){return function(){return a.compile(a.replaceIDs(JXG.deepCopy(node)))}}(this),ret.deps={},this.collectDependencies(node.children[1],ret.deps),this.pstack.pop(),this.pscope--;break;case"op_execfun":var fun,attr,sc;if(this.pstack.push([]),this.dpstack.push([]),this.pscope++,this.execute(node.children[1]),"undefined"!=typeof node.children[2])if(node.children[3]){for(this.pstack.push([]),this.dpstack.push([]),this.pscope++,this.execute(node.children[2]),attr={},i=0;i<this.pstack[this.pscope].length;i++)attr=JXG.deepCopy(attr,this.execute(this.pstack[this.pscope][i]),!0);this.pscope--,this.pstack.pop(),this.dpstack.pop()}else attr=this.execute(node.children[2]);for(fun=this.execute(node.children[0]),sc=fun&&fun.sc?fun.sc:this,i=0;i<this.pstack[this.pscope].length;i++)parents[i]=this.execute(this.pstack[this.pscope][i]);
if("function"!=typeof fun||fun.creator)if("function"==typeof fun&&fun.creator){e=this.line;try{for(ret=fun(parents,attr),ret.jcLineStart=e,ret.jcLineEnd=node.line,i=e;i<=node.line;i++)this.lineToElement[i]=ret;ret.debugParents=this.dpstack[this.pscope]}catch(ex){this._error(ex.toString(),e)}}else this._error("Function '"+fun+"' is undefined.");else ret=fun.apply(sc,parents);this.pstack.pop(),this.dpstack.pop(),this.pscope--;break;case"op_property":e=this.execute(node.children[0]),v=node.children[1],ret=this.resolveProperty(e,v,!1),JXG.exists(ret)&&(ret.sc=e);break;case"op_lhs":v=node.children[0],v.children&&v.type&&v.value&&(v=this.execute(v)),1===node.children.length?e=this.sstack[this.scope]:(e=this.execute(node.children[1]),e.type&&e.elementClass&&v.toLowerCase&&"x"!==v.toLowerCase()&&"y"!==v.toLowerCase()&&(v=v.toLowerCase())),ret=[e,v];break;case"op_use":var found=!1;for(var b in JXG.JSXGraph.boards)JXG.JSXGraph.boards[b].container===node.children[0].toString()&&(this.use(JXG.JSXGraph.boards[b]),found=!0);found||this._error("Board '"+node.children[0].toString()+"' not found!");break;case"op_delete":v=this.getvar(node.children[0]),"object"==typeof v&&JXG.exists(v.type)&&JXG.exists(v.elementClass)&&this.board.removeObject(v);break;case"op_equ":ret=this.execute(node.children[0])==this.execute(node.children[1]);break;case"op_neq":ret=this.execute(node.children[0])!=this.execute(node.children[1]);break;case"op_approx":ret=Math.abs(this.execute(node.children[0])-this.execute(node.children[1]))<JXG.Math.eps;break;case"op_grt":ret=this.execute(node.children[0])>this.execute(node.children[1]);break;case"op_lot":ret=this.execute(node.children[0])<this.execute(node.children[1]);break;case"op_gre":ret=this.execute(node.children[0])>=this.execute(node.children[1]);break;case"op_loe":ret=this.execute(node.children[0])<=this.execute(node.children[1]);break;case"op_or":ret=this.execute(node.children[0])||this.execute(node.children[1]);break;case"op_and":ret=this.execute(node.children[0])&&this.execute(node.children[1]);break;case"op_not":ret=!this.execute(node.children[0]);break;case"op_add":ret=JXG.Math.Statistics.add(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_sub":ret=JXG.Math.Statistics.subtract(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_div":ret=JXG.Math.Statistics.div(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_mod":ret=JXG.Math.Statistics.mod(this.execute(node.children[0]),this.execute(node.children[1]),!0);break;case"op_mul":ret=this.mul(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_exp":ret=Math.pow(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_neg":ret=-1*this.execute(node.children[0])}break;case"node_var":ret=this.getvar(node.value);break;case"node_const":ret=Number(node.value);break;case"node_const_bool":ret="false"!==node.value.toLowerCase();break;case"node_str":ret=node.value}return ret},compile:function(a,b){var c,e;if(c="",JXG.exists(b)||(b=!1),!a)return c;switch(a.type){case"node_op":switch(a.value){case"op_none":a.children[0]&&(c=this.compile(a.children[0],b)),a.children[1]&&(c+=this.compile(a.children[1],b));break;case"op_assign":e=this.compile(a.children[0],b),b?JXG.isArray(e)?c="$jc$.setProp("+e[0]+", '"+e[1]+"', "+this.compile(a.children[1],b)+");\n":(this.isLocalVariable(e)!==this.scope&&(this.sstack[this.scope][e]=!0),c="$jc$.sstack["+this.scope+"]['"+e+"'] = "+this.compile(a.children[1],b)+";\n"):c=e+" = "+this.compile(a.children[1],b)+";\n";break;case"op_noassign":c=this.compile(a.children[0],b)+";\n";break;case"op_if":c=" if ("+this.compile(a.children[0],b)+") "+this.compile(a.children[1],b);break;case"op_if_else":c=" if ("+this.compile(a.children[0],b)+")"+this.compile(a.children[1],b),c+=" else "+this.compile(a.children[2],b);break;case"op_while":c=" while ("+this.compile(a.children[0],b)+") {\n"+this.compile(a.children[1],b)+"}\n";break;case"op_do":c=" do {\n"+this.compile(a.children[0],b)+"} while ("+this.compile(a.children[1],b)+");\n";break;case"op_for":c=" for ("+this.compile(a.children[0],b)+"; "+this.compile(a.children[1],b)+"; "+this.compile(a.children[2],b)+") {\n"+this.compile(a.children[3],b)+"\n}\n";break;case"op_param":a.children[1]&&(c=this.compile(a.children[1],b)+", "),c+=this.compile(a.children[0],b);break;case"op_paramdef":a.children[1]&&(c=this.compile(a.children[1],b)+", "),c+=a.children[0];break;case"op_proplst":a.children[0]&&(c=this.compile(a.children[0],b)+", "),c+=this.compile(a.children[1],b);break;case"op_prop":c=a.children[0]+": "+this.compile(a.children[1],b);break;case"op_proplst_val":c=this.compile(a.children[0],b);break;case"op_array":c="["+this.compile(a.children[0],b)+"]";break;case"op_extvalue":c=this.compile(a.children[0],b)+"["+this.compile(a.children[1],b)+"]";break;case"op_return":c=" return "+this.compile(a.children[0],b)+";\n";break;case"op_function":c=" function ("+this.compile(a.children[0],b)+") {\n"+this.compile(a.children[1],b)+"}";break;case"op_execfun":a.children[2]&&(e=(b?"{":"<<")+this.compile(a.children[2],b)+(b?"}":">>")),a.children[0].withProps=!!a.children[2],c=this.compile(a.children[0],b)+"("+this.compile(a.children[1],b)+(a.children[2]?", "+e:"")+")",b&&"$"===a.children[0].value&&(c="$jc$.board.objects["+this.compile(a.children[1],b)+"]");break;case"op_property":c=b&&"X"!==a.children[1]&&"Y"!==a.children[1]?"$jc$.resolveProperty("+this.compile(a.children[0],b)+", '"+a.children[1]+"', true)":this.compile(a.children[0],b)+"."+a.children[1];break;case"op_lhs":1===a.children.length?c=a.children[0]:"dot"===a.children[2]?c=b?[this.compile(a.children[1],b),a.children[0]]:this.compile(a.children[1],b)+"."+a.children[0]:"bracket"===a.children[2]&&(c=b?[this.compile(a.children[1],b),this.compile(a.children[0],b)]:this.compile(a.children[1],b)+"["+this.compile(a.children[0],b)+"]");break;case"op_use":c=b?"$jc$.use(JXG.JSXGraph.boards['"+a.children[0]+"'])":"use "+a.children[0]+";";break;case"op_delete":c="delete "+a.children[0];break;case"op_equ":c="("+this.compile(a.children[0],b)+" == "+this.compile(a.children[1],b)+")";break;case"op_neq":c="("+this.compile(a.children[0],b)+" != "+this.compile(a.children[1],b)+")";break;case"op_approx":c="("+this.compile(a.children[0],b)+" ~= "+this.compile(a.children[1],b)+")";break;case"op_grt":c="("+this.compile(a.children[0],b)+" > "+this.compile(a.children[1],b)+")";break;case"op_lot":c="("+this.compile(a.children[0],b)+" < "+this.compile(a.children[1],b)+")";break;case"op_gre":c="("+this.compile(a.children[0],b)+" >= "+this.compile(a.children[1],b)+")";break;case"op_loe":c="("+this.compile(a.children[0],b)+" <= "+this.compile(a.children[1],b)+")";break;case"op_or":c="("+this.compile(a.children[0],b)+" || "+this.compile(a.children[1],b)+")";break;case"op_and":c="("+this.compile(a.children[0],b)+" && "+this.compile(a.children[1],b)+")";break;case"op_not":c="!("+this.compile(a.children[0],b)+")";break;case"op_add":c=b?"JXG.Math.Statistics.add("+this.compile(a.children[0],b)+", "+this.compile(a.children[1],b)+")":"("+this.compile(a.children[0],b)+" + "+this.compile(a.children[1],b)+")";break;case"op_sub":c=b?"JXG.Math.Statistics.subtract("+this.compile(a.children[0],b)+", "+this.compile(a.children[1],b)+")":"("+this.compile(a.children[0],b)+" - "+this.compile(a.children[1],b)+")";break;case"op_div":c=b?"JXG.Math.Statistics.div("+this.compile(a.children[0],b)+", "+this.compile(a.children[1],b)+")":"("+this.compile(a.children[0],b)+" / "+this.compile(a.children[1],b)+")";break;case"op_mod":c=b?"JXG.Math.mod("+this.compile(a.children[0],b)+", "+this.compile(a.children[1],b)+", true)":"("+this.compile(a.children[0],b)+" % "+this.compile(a.children[1],b)+")";break;case"op_mul":c=b?"$jc$.mul("+this.compile(a.children[0],b)+", "+this.compile(a.children[1],b)+")":"("+this.compile(a.children[0],b)+" * "+this.compile(a.children[1],b)+")";break;case"op_exp":c=b?"Math.pow("+this.compile(a.children[0],b)+", "+this.compile(a.children[1],b)+")":"("+this.compile(a.children[0],b)+"^"+this.compile(a.children[1],b)+")";break;case"op_neg":c="(-"+this.compile(a.children[0],b)+")"}break;case"node_var":c=b?this.getvarJS(a.value,!1,a.withProps):a.value;break;case"node_const":c=a.value;break;case"node_const_bool":c=a.value;break;case"node_str":c="'"+a.value.replace(/'/g,"\\'")+"'"}return a.needsBrackets&&(c="{\n"+c+"}\n"),c},X:function(a){return a.X()},Y:function(a){return a.Y()},V:function(a){return a.Value()},L:function(a){return a.L()},dist:function(a,b){return JXG.exists(a)&&JXG.exists(a.Dist)||this._error("Error: Can't calculate distance."),a.Dist(b)},mul:function(a,b){return JXG.isArray(a)*JXG.isArray(b)?JXG.Math.innerProduct(a,b,Math.min(a.length,b.length)):JXG.Math.Statistics.multiply(a,b)},use:function(a){this.board=a,this.builtIn.$board=a,this.builtIn.$board.src="$jc$.board"},findSymbol:function(a,b){var c,d;for(b=JXG.def(b,-1),-1===b&&(b=this.scope),c=b;c>=0;c--)for(d in this.sstack[c])if(this.sstack[c][d]===a)return[d,c];return[]},defineBuiltIn:function(){var a=this,b={PI:Math.PI,EULER:Math.E,X:a.X,Y:a.Y,V:a.V,L:a.L,dist:a.dist,rad:JXG.Math.Geometry.rad,deg:JXG.Math.Geometry.trueAngle,factorial:JXG.Math.factorial,trunc:JXG.trunc,$:a.getElementById,$board:a.board};return b.rad.sc=JXG.Math.Geometry,b.deg.sc=JXG.Math.Geometry,b.factorial.sc=JXG.Math,b.PI.src="Math.PI",b.EULER.src="Math.E",b.X.src="$jc$.X",b.Y.src="$jc$.Y",b.V.src="$jc$.V",b.L.src="$jc$.L",b.dist.src="$jc$.dist",b.rad.src="JXG.Math.Geometry.rad",b.deg.src="JXG.Math.Geometry.trueAngle",b.factorial.src="JXG.Math.factorial",b.trunc.src="JXG.trunc",b.$.src="(function (n) { return JXG.getRef($jc$.board, n); })",b.$board&&(b.$board.src="$jc$.board"),b},_debug:function(a){"undefined"!=typeof console?console.log(a):document&&null!==document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=a+"<br />")},_error:function(a){var b=new Error("Error("+this.line+"): "+a);throw b.line=this.line,b},_warn:function(a){"undefined"!=typeof console?console.log("Warning("+this.line+"): "+a):document&&null!==document.getElementById(this.warnLog)&&(document.getElementById(this.warnLog).innerHTML+="Warning("+this.line+"): "+a+"<br />")},_log:function(a){"undefined"==typeof window&&"undefined"!=typeof self&&self.postMessage?self.postMessage({type:"log",msg:"Log: "+a.toString()}):console.log("Log: ",arguments)}}),JXG.extend(JXG.JessieCode.prototype,{_lex:function(a){for(var b,f,g,c=-1,d=0,e=0;;){b=0,c=-1,d=0,e=0,f=a.offset+1+(d-e);do{if(f--,b=0,c=-2,e=f,a.src.length<=e)return 67;do{switch(g=a.src.charCodeAt(f),b){case 0:b=g>=9&&10>=g||13==g||32==g?1:33==g?2:35==g?3:36==g||g>=65&&67>=g||g>=71&&72>=g||g>=74&&81>=g||83==g||86==g||g>=88&&90>=g||95==g||g>=97&&99>=g||g>=103&&104>=g||g>=106&&113>=g||115==g||118==g||g>=120&&122>=g?4:37==g?5:40==g?6:41==g?7:42==g?8:43==g?9:44==g?10:45==g?11:46==g?12:47==g?13:g>=48&&57>=g?14:58==g?15:59==g?16:60==g?17:61==g?18:62==g?19:91==g?20:93==g?21:94==g?22:123==g?23:124==g?24:125==g?25:38==g?48:68==g||100==g?49:39==g?51:73==g||105==g?52:126==g?53:70==g||102==g?64:85==g||117==g?65:69==g||101==g?73:84==g||116==g?74:87==g||119==g?80:82==g||114==g?84:-1;break;case 1:b=-1,c=2,d=f;break;case 2:b=61==g?26:-1,c=31,d=f;break;case 3:b=-1,c=41,d=f;break;case 4:b=g>=48&&57>=g||g>=65&&90>=g||95==g||g>=97&&122>=g?4:-1,c=45,d=f;break;case 5:b=-1,c=35,d=f;break;case 6:b=-1,c=38,d=f;break;case 7:b=-1,c=39,d=f;break;case 8:b=-1,c=36,d=f;break;case 9:b=-1,c=32,d=f;break;case 10:b=-1,c=40,d=f;break;case 11:b=-1,c=33,d=f;break;case 12:b=g>=48&&57>=g?29:-1,c=44,d=f;break;case 13:b=-1,c=34,d=f;break;case 14:b=g>=48&&57>=g?14:46==g?29:-1,c=47,d=f;break;case 15:b=-1,c=42,d=f;break;case 16:b=-1,c=20,d=f;break;case 17:b=60==g?30:61==g?31:-1,c=28,d=f;break;case 18:b=61==g?32:-1,c=21,d=f;break;case 19:b=61==g?33:62==g?34:-1,c=27,d=f;break;case 20:b=-1,c=16,d=f;break;case 21:b=-1,c=17,d=f;break;case 22:b=-1,c=37,d=f;break;case 23:b=-1,c=18,d=f;break;case 24:b=124==g?37:-1,c=43,d=f;break;case 25:b=-1,c=19,d=f;break;case 26:b=-1,c=23,d=f;break;case 27:b=-1,c=30,d=f;break;case 28:b=-1,c=46,d=f;break;case 29:b=g>=48&&57>=g?29:-1,c=48,d=f;break;case 30:b=-1,c=14,d=f;break;case 31:b=-1,c=25,d=f;break;case 32:b=-1,c=22,d=f;break;case 33:b=-1,c=26,d=f;break;case 34:b=-1,c=15,d=f;break;case 35:b=g>=48&&57>=g||g>=65&&90>=g||95==g||g>=97&&122>=g?4:-1,c=6,d=f;break;case 36:b=g>=48&&57>=g||g>=65&&90>=g||95==g||g>=97&&122>=g?4:-1,c=3,d=f;break;case 37:b=-1,c=29,d=f;break;case 38:b=-1,c=24,d=f;break;case 39:b=g>=48&&57>=g||g>=65&&90>=g||95==g||g>=97&&122>=g?4:-1,c=7,d=f;break;case 40:b=g>=48&&57>=g||g>=65&&90>=g||95==g||g>=97&&122>=g?4:-1,c=9,d=f;break;case 41:b=g>=48&&57>=g||g>=65&&90>=g||95==g||g>=97&&122>=g?4:-1,c=4,d=f;break;case 42:b=g>=48&&57>=g||g>=65&&90>=g||95==g||g>=97&&122>=g?4:-1,c=12,d=f;break;case 43:b=g>=48&&57>=g||g>=65&&90>=g||95==g||g>=97&&122>=g?4:-1,c=13,d=f;break;case 44:b=g>=48&&57>=g||g>=65&&90>=g||95==g||g>=97&&122>=g?4:-1,c=5,d=f;break;case 45:b=g>=48&&57>=g||g>=65&&90>=g||95==g||g>=97&&122>=g?4:-1,c=11,d=f;break;case 46:b=g>=48&&57>=g||g>=65&&90>=g||95==g||g>=97&&122>=g?4:-1,c=10,d=f;break;case 47:b=g>=48&&57>=g||g>=65&&90>=g||95==g||g>=97&&122>=g?4:-1,c=8,d=f;break;case 48:b=38==g?27:-1;break;case 49:b=g>=48&&57>=g||g>=65&&68>=g||g>=70&&78>=g||g>=80&&90>=g||95==g||g>=97&&100>=g||g>=102&&110>=g||g>=112&&122>=g?4:79==g||111==g?35:69==g||101==g?81:-1,c=45,d=f;break;case 50:b=39==g?28:g>=0&&38>=g||g>=40&&91>=g||g>=93&&254>=g?51:92==g?55:-1,c=46,d=f;break;case 51:b=39==g?28:g>=0&&38>=g||g>=40&&91>=g||g>=93&&254>=g?51:92==g?55:-1;break;case 52:b=g>=48&&57>=g||g>=65&&69>=g||g>=71&&90>=g||95==g||g>=97&&101>=g||g>=103&&122>=g?4:70==g||102==g?36:-1,c=45,d=f;break;case 53:b=61==g?38:-1;break;case 54:b=g>=48&&57>=g||g>=65&&81>=g||g>=83&&90>=g||95==g||g>=97&&113>=g||g>=115&&122>=g?4:82==g||114==g?39:-1,c=45,d=f;break;case 55:b=39==g?50:g>=0&&38>=g||g>=40&&91>=g||g>=93&&254>=g?51:92==g?55:-1;break;case 56:b=g>=48&&57>=g||g>=65&&68>=g||g>=70&&90>=g||95==g||g>=97&&100>=g||g>=102&&122>=g?4:69==g||101==g?40:-1,c=45,d=f;break;case 57:b=g>=48&&57>=g||g>=65&&68>=g||g>=70&&90>=g||95==g||g>=97&&100>=g||g>=102&&122>=g?4:69==g||101==g?41:-1,c=45,d=f;break;case 58:b=g>=48&&57>=g||g>=65&&68>=g||g>=70&&90>=g||95==g||g>=97&&100>=g||g>=102&&122>=g?4:69==g||101==g?42:-1,c=45,d=f;break;case 59:b=g>=48&&57>=g||g>=65&&68>=g||g>=70&&90>=g||95==g||g>=97&&100>=g||g>=102&&122>=g?4:69==g||101==g?43:-1,c=45,d=f;break;case 60:b=g>=48&&57>=g||g>=65&&68>=g||g>=70&&90>=g||95==g||g>=97&&100>=g||g>=102&&122>=g?4:69==g||101==g?44:-1,c=45,d=f;break;case 61:b=g>=48&&57>=g||g>=65&&68>=g||g>=70&&90>=g||95==g||g>=97&&100>=g||g>=102&&122>=g?4:69==g||101==g?45:-1,c=45,d=f;break;case 62:b=g>=48&&57>=g||g>=65&&77>=g||g>=79&&90>=g||95==g||g>=97&&109>=g||g>=111&&122>=g?4:78==g||110==g?46:-1,c=45,d=f;break;case 63:b=g>=48&&57>=g||g>=65&&77>=g||g>=79&&90>=g||95==g||g>=97&&109>=g||g>=111&&122>=g?4:78==g||110==g?47:-1,c=45,d=f;break;case 64:b=g>=48&&57>=g||g>=66&&78>=g||g>=80&&84>=g||g>=86&&90>=g||95==g||g>=98&&110>=g||g>=112&&116>=g||g>=118&&122>=g?4:79==g||111==g?54:65==g||97==g?75:85==g||117==g?86:-1,c=45,d=f;break;case 65:b=g>=48&&57>=g||g>=65&&82>=g||g>=84&&90>=g||95==g||g>=97&&114>=g||g>=116&&122>=g?4:83==g||115==g?56:-1,c=45,d=f;break;case 66:b=g>=48&&57>=g||g>=65&&82>=g||g>=84&&90>=g||95==g||g>=97&&114>=g||g>=116&&122>=g?4:83==g||115==g?57:-1,c=45,d=f;break;case 67:b=g>=48&&57>=g||g>=65&&84>=g||g>=86&&90>=g||95==g||g>=97&&116>=g||g>=118&&122>=g?4:85==g||117==g?58:-1,c=45,d=f;break;case 68:b=g>=48&&57>=g||g>=65&&82>=g||g>=84&&90>=g||95==g||g>=97&&114>=g||g>=116&&122>=g?4:83==g||115==g?59:-1,c=45,d=f;break;case 69:b=g>=48&&57>=g||g>=65&&75>=g||g>=77&&90>=g||95==g||g>=97&&107>=g||g>=109&&122>=g?4:76==g||108==g?60:-1,c=45,d=f;break;case 70:b=g>=48&&57>=g||g>=65&&83>=g||g>=85&&90>=g||95==g||g>=97&&115>=g||g>=117&&122>=g?4:84==g||116==g?61:-1,c=45,d=f;break;case 71:b=g>=48&&57>=g||g>=65&&81>=g||g>=83&&90>=g||95==g||g>=97&&113>=g||g>=115&&122>=g?4:82==g||114==g?62:-1,c=45,d=f;break;case 72:b=g>=48&&57>=g||g>=65&&78>=g||g>=80&&90>=g||95==g||g>=97&&110>=g||g>=112&&122>=g?4:79==g||111==g?63:-1,c=45,d=f;break;case 73:b=g>=48&&57>=g||g>=65&&75>=g||g>=77&&90>=g||95==g||g>=97&&107>=g||g>=109&&122>=g?4:76==g||108==g?66:-1,c=45,d=f;break;case 74:b=g>=48&&57>=g||g>=65&&81>=g||g>=83&&90>=g||95==g||g>=97&&113>=g||g>=115&&122>=g?4:82==g||114==g?67:-1,c=45,d=f;break;case 75:b=g>=48&&57>=g||g>=65&&75>=g||g>=77&&90>=g||95==g||g>=97&&107>=g||g>=109&&122>=g?4:76==g||108==g?68:-1,c=45,d=f;break;case 76:b=g>=48&&57>=g||g>=65&&72>=g||g>=74&&90>=g||95==g||g>=97&&104>=g||g>=106&&122>=g?4:73==g||105==g?69:-1,c=45,d=f;break;case 77:b=g>=48&&57>=g||g>=65&&68>=g||g>=70&&90>=g||95==g||g>=97&&100>=g||g>=102&&122>=g?4:69==g||101==g?70:-1,c=45,d=f;break;case 78:b=g>=48&&57>=g||g>=65&&84>=g||g>=86&&90>=g||95==g||g>=97&&116>=g||g>=118&&122>=g?4:85==g||117==g?71:-1,c=45,d=f;break;case 79:b=g>=48&&57>=g||g>=65&&72>=g||g>=74&&90>=g||95==g||g>=97&&104>=g||g>=106&&122>=g?4:73==g||105==g?72:-1,c=45,d=f;break;case 80:b=g>=48&&57>=g||g>=65&&71>=g||g>=73&&90>=g||95==g||g>=97&&103>=g||g>=105&&122>=g?4:72==g||104==g?76:-1,c=45,d=f;break;case 81:b=g>=48&&57>=g||g>=65&&75>=g||g>=77&&90>=g||95==g||g>=97&&107>=g||g>=109&&122>=g?4:76==g||108==g?77:-1,c=45,d=f;break;case 82:b=g>=48&&57>=g||g>=65&&83>=g||g>=85&&90>=g||95==g||g>=97&&115>=g||g>=117&&122>=g?4:84==g||116==g?78:-1,c=45,d=f;break;case 83:b=g>=48&&57>=g||g>=65&&83>=g||g>=85&&90>=g||95==g||g>=97&&115>=g||g>=117&&122>=g?4:84==g||116==g?79:-1,c=45,d=f;break;case 84:b=g>=48&&57>=g||g>=65&&68>=g||g>=70&&90>=g||95==g||g>=97&&100>=g||g>=102&&122>=g?4:69==g||101==g?82:-1,c=45,d=f;break;case 85:b=g>=48&&57>=g||g>=65&&66>=g||g>=68&&90>=g||95==g||g>=97&&98>=g||g>=100&&122>=g?4:67==g||99==g?83:-1,c=45,d=f;break;case 86:b=g>=48&&57>=g||g>=65&&77>=g||g>=79&&90>=g||95==g||g>=97&&109>=g||g>=111&&122>=g?4:78==g||110==g?85:-1,c=45,d=f}b>-1&&(10==g&&(a.line++,a.column=0,this.countLines&&(this.parCurLine=a.line)),a.column++,this.countLines&&(this.parCurColumn=a.column)),f++}while(b>-1)}while(2==c);c>-1?(a.att=a.src.substr(e,d-e),a.offset=d,46==c&&(a.att=a.att.substr(1,a.att.length-2),a.att=a.att.replace(/\\\'/g,"'"))):(a.att=new String,c=-1);break}return c},_parse:function(a,b,c){var g,h,i,d=[],e=[],f=0,j={la:0,act:0,offset:0,src:a,att:"",line:1,column:1,error_step:0},k=new Array(new Array(0,1),new Array(49,2),new Array(49,0),new Array(51,2),new Array(51,0),new Array(52,3),new Array(52,1),new Array(52,0),new Array(54,3),new Array(54,1),new Array(54,0),new Array(55,3),new Array(56,3),new Array(56,1),new Array(56,0),new Array(57,3),new Array(57,1),new Array(60,3),new Array(50,3),new Array(50,5),new Array(50,3),new Array(50,5),new Array(50,9),new Array(50,3),new Array(50,2),new Array(50,2),new Array(50,2),new Array(50,2),new Array(50,3),new Array(50,1),new Array(59,3),new Array(59,4),new Array(59,1),new Array(53,3),new Array(53,3),new Array(53,3),new Array(53,3),new Array(53,3),new Array(53,3),new Array(53,3),new Array(53,1),new Array(62,3),new Array(62,3),new Array(62,2),new Array(62,1),new Array(61,3),new Array(61,3),new Array(61,1),new Array(63,3),new Array(63,3),new Array(63,3),new Array(63,1),new Array(65,3),new Array(65,1),new Array(64,2),new Array(64,2),new Array(64,1),new Array(58,4),new Array(58,4),new Array(58,5),new Array(58,3),new Array(58,1),new Array(66,1),new Array(66,1),new Array(66,1),new Array(66,3),new Array(66,1),new Array(66,7),new Array(66,3),new Array(66,3),new Array(66,1),new Array(66,1)),l=new Array(new Array,new Array(3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,45,17,31,18,47,22,48,23,38,24,46,25,8,26,14,27,16,28,12,29,13,30,33,32,32,33),new Array,new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,45,17,31,18,47,22,48,23,38,24,46,25,8,26,14,27,16,28,12,29,13,30,33,32,32,33),new Array(38,40),new Array(45,41),new Array(45,42),new Array(3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,45,17,31,18,47,22,48,23,38,24,46,25,8,26,14,27,16,28,12,29,13,30,33,32,32,33),new Array(20,44),new Array(24,45,23,46,26,47,25,48,27,49,28,50,22,51,20,52),new Array,new Array,new Array(21,54),new Array(30,55,29,56),new Array(44,57,38,58,16,59,37,60),new Array(21,-32),new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(32,62,33,63),new Array,new Array(35,64,34,65,36,66),new Array,new Array,new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array,new Array(38,68),new Array(45,71),new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array,new Array,new Array,new Array(47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array,new Array(24,45,23,46,26,47,25,48,27,49,28,50,22,51,3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,45,17,31,18,47,22,48,23,38,24,46,25,8,26,14,27,16,28,12,29,13,30,33,32,32,33),new Array(44,77,38,58,16,78,37,60),new Array,new Array(24,45,23,46,26,47,25,48,27,49,28,50,22,51,3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,45,17,31,18,47,22,48,23,38,24,46,25,8,26,14,27,16,28,12,29,13,30,33,32,32,33),new Array(5,80),new Array(45,17,47,22,48,23,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(20,83),new Array,new Array,new Array,new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array,new Array(19,91,3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,45,17,31,18,47,22,48,23,38,24,46,25,8,26,14,27,16,28,12,29,13,30,33,32,32,33),new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(45,96),new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(30,55,29,56),new Array(33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(39,105,24,45,23,46,26,47,25,48,27,49,28,50,22,51),new Array(45,107),new Array(15,108,40,109),new Array,new Array(42,110),new Array(17,111,40,112),new Array(24,45,23,46,26,47,25,48,27,49,28,50,22,51),new Array,new Array,new Array(4,113),new Array(45,114),new Array(33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array,new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(20,117),new Array(44,57,38,58,16,59),new Array,new Array(30,55,29,56),new Array(30,55,29,56),new Array(30,55,29,56),new Array(30,55,29,56),new Array(30,55,29,56),new Array(30,55,29,56),new Array(30,55,29,56),new Array,new Array,new Array(24,45,23,46,26,47,25,48,27,49,28,50,22,51),new Array(32,62,33,63),new Array(32,62,33,63),new Array(21,-30),new Array(39,118,40,112),new Array(17,119,32,62,33,63),new Array,new Array(35,64,34,65,36,66),new Array(35,64,34,65,36,66),new Array,new Array,new Array,new Array,new Array(39,120,40,121),new Array,new Array,new Array(45,71),new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array,new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,45,17,31,18,47,22,48,23,38,24,46,25,8,26,14,27,16,28,12,29,13,30,33,32,32,33),new Array,new Array(17,126,32,62,33,63),new Array(24,45,23,46,26,47,25,48,27,49,28,50,22,51,20,127),new Array(31,18,33,32,32,33,47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(21,-31),new Array(18,131),new Array(45,132),new Array,new Array(24,45,23,46,26,47,25,48,27,49,28,50,22,51),new Array(24,45,23,46,26,47,25,48,27,49,28,50,22,51),new Array,new Array,new Array,new Array(24,45,23,46,26,47,25,48,27,49,28,50,22,51,20,133),new Array(40,134),new Array(44,77,38,58,16,78),new Array,new Array,new Array(45,17,47,22,48,23,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(47,22,48,23,45,37,38,24,46,25,8,26,14,27,16,28,12,29,13,30),new Array(19,138,3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,45,17,31,18,47,22,48,23,38,24,46,25,8,26,14,27,16,28,12,29,13,30,33,32,32,33),new Array(39,139),new Array(44,77,38,58,16,78),new Array,new Array(3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,45,17,31,18,47,22,48,23,38,24,46,25,8,26,14,27,16,28,12,29,13,30,33,32,32,33),new Array),m=new Array(new Array(49,1),new Array(50,2,60,10,53,11,59,14,62,15,58,16,61,19,66,20,63,21,64,31,65,34),new Array,new Array(53,35,62,15,61,19,63,21,64,31,65,34,58,36,66,20),new Array(53,38,62,15,61,19,63,21,64,31,65,34,58,36,66,20),new Array(50,39,60,10,53,11,59,14,62,15,58,16,61,19,66,20,63,21,64,31,65,34),new Array,new Array,new Array,new Array(50,43,60,10,53,11,59,14,62,15,58,16,61,19,66,20,63,21,64,31,65,34),new Array,new Array,new Array(51,53),new Array,new Array,new Array,new Array,new Array,new Array(62,61,61,19,63,21,64,31,65,34,58,36,66,20),new Array,new Array,new Array,new Array,new Array,new Array(53,67,62,15,61,19,63,21,64,31,65,34,58,36,66,20),new Array,new Array,new Array(54,69,55,70),new Array(52,72,53,73,62,15,61,19,63,21,64,31,65,34,58,36,66,20),new Array,new Array,new Array,new Array(65,74,58,36,66,20),new Array(65,75,58,36,66,20),new Array,new Array(50,76,60,10,53,11,59,14,62,15,58,16,61,19,66,20,63,21,64,31,65,34),new Array,new Array,new Array(50,79,60,10,53,11,59,14,62,15,58,16,61,19,66,20,63,21,64,31,65,34),new Array,new Array(60,81,59,14,58,82,66,20),new Array,new Array,new Array,new Array,new Array(62,84,61,19,63,21,64,31,65,34,58,36,66,20),new Array(62,85,61,19,63,21,64,31,65,34,58,36,66,20),new Array(62,86,61,19,63,21,64,31,65,34,58,36,66,20),new Array(62,87,61,19,63,21,64,31,65,34,58,36,66,20),new Array(62,88,61,19,63,21,64,31,65,34,58,36,66,20),new Array(62,89,61,19,63,21,64,31,65,34,58,36,66,20),new Array(62,90,61,19,63,21,64,31,65,34,58,36,66,20),new Array,new Array(50,92,60,10,53,11,59,14,62,15,58,16,61,19,66,20,63,21,64,31,65,34),new Array(53,93,62,15,61,19,63,21,64,31,65,34,58,36,66,20),new Array(61,94,63,21,64,31,65,34,58,36,66,20),new Array(61,95,63,21,64,31,65,34,58,36,66,20),new Array,new Array(52,97,53,73,62,15,61,19,63,21,64,31,65,34,58,36,66,20),new Array(61,98,63,21,64,31,65,34,58,36,66,20),new Array(65,99,58,36,66,20),new Array,new Array(63,100,64,31,65,34,58,36,66,20),new Array(63,101,64,31,65,34,58,36,66,20),new Array(64,102,65,34,58,36,66,20),new Array(64,103,65,34,58,36,66,20),new Array(64,104,65,34,58,36,66,20),new Array,new Array(56,106),new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array(61,115,63,21,64,31,65,34,58,36,66,20),new Array,new Array(53,116,62,15,61,19,63,21,64,31,65,34,58,36,66,20),new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array(55,122),new Array(53,123,62,15,61,19,63,21,64,31,65,34,58,36,66,20),new Array,new Array(53,124,62,15,61,19,63,21,64,31,65,34,58,36,66,20),new Array(50,125,60,10,53,11,59,14,62,15,58,16,61,19,66,20,63,21,64,31,65,34),new Array,new Array,new Array,new Array(53,128,62,15,61,19,63,21,64,31,65,34,58,36,66,20),new Array(57,129,58,130,66,20),new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array,new Array(51,135),new Array,new Array(60,136,59,14,58,82,66,20),new Array(58,137,66,20),new Array(50,92,60,10,53,11,59,14,62,15,58,16,61,19,66,20,63,21,64,31,65,34),new Array,new Array,new Array,new Array(50,140,60,10,53,11,59,14,62,15,58,16,61,19,66,20,63,21,64,31,65,34),new Array),n=new Array(2,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,29,-1,40,53,64,-1,44,61,47,62,63,-1,66,-1,10,7,70,71,51,-1,-1,56,-1,53,64,-1,-1,-1,-1,24,25,26,-1,-1,-1,-1,-1,-1,-1,27,-1,-1,-1,-1,-1,7,-1,-1,43,-1,-1,-1,-1,-1,-1,14,-1,9,-1,-1,6,54,55,18,-1,-1,20,-1,-1,-1,23,39,38,37,36,35,34,33,28,3,17,42,41,60,-1,-1,52,46,45,50,49,48,65,-1,13,68,-1,-1,69,-1,-1,60,-1,-1,-1,58,57,-1,-1,8,11,5,19,57,21,-1,59,16,4,12,-1,-1,-1,-1,15,67,-1,22),o=new Array("Program'","ERROR_RESYNC","WHITESPACE","IF","ELSE","WHILE","DO","FOR","FUNCTION","USE","RETURN","DELETE","TRUE","FALSE","<<",">>","[","]","{","}",";","=","==","!=","~=","<=",">=",">","<","||","&&","!","+","-","/","%","*","^","(",")",",","#",":","|",".","Identifier","String","Integer","Float","Program","Stmt","Stmt_List","Param_List","Expression","Prop_List","Prop","Param_Def_List","Attr_List","ExtValue","Lhs","Assign","AddSubExp","LogExp","MulDivExp","NegExp","ExpExp","Value","$");for(b||(b=[]),c||(c=[]),d.push(0),e.push(0),j.la=this._lex(j);;){for(j.act=142,i=0;i<l[d[d.length-1]].length;i+=2)if(l[d[d.length-1]][i]==j.la){j.act=l[d[d.length-1]][i+1];break}if(142==j.act&&((j.act=n[d[d.length-1]])<0?j.act=142:j.act*=-1),142==j.act){if(0==j.error_step)for(f++,b.push({offset:j.offset-j.att.length,line:j.line}),c.push([]),i=0;i<l[d[d.length-1]].length;i+=2)c[c.length-1].push(o[l[d[d.length-1]][i]]);for(;d.length>1&&142==j.act;)for(d.pop(),e.pop(),i=0;i<l[d[d.length-1]].length;i+=2)if(1==l[d[d.length-1]][i]){j.act=l[d[d.length-1]][i+1],d.push(j.act),e.push("");break}if(d.length>1&&142!=j.act){for(;67!=j.la;){for(j.act=142,i=0;i<l[d[d.length-1]].length;i+=2)if(l[d[d.length-1]][i]==j.la){j.act=l[d[d.length-1]][i+1];break}if(142!=j.act)break;for(;(j.la=this._lex(j))<0;)j.offset++}for(;67!=j.la&&142==j.act;);}if(142==j.act||67==j.la)break;j.error_step=3}if(j.act>0)d.push(j.act),e.push(j.att),j.la=this._lex(j),j.error_step>0&&j.error_step--;else{switch(g=-1*j.act,h=void 0,g){case 0:h=e[e.length-1];break;case 1:this.execute(e[e.length-1]);break;case 2:h=e[e.length-0];break;case 3:h=this.createNode("node_op","op_none",e[e.length-2],e[e.length-1]);break;case 4:h=e[e.length-0];break;case 5:h=this.createNode("node_op","op_param",e[e.length-1],e[e.length-3]);break;case 6:h=this.createNode("node_op","op_param",e[e.length-1]);break;case 7:h=e[e.length-0];break;case 8:h=this.createNode("node_op","op_proplst",e[e.length-3],e[e.length-1]);break;case 9:h=e[e.length-1];break;case 10:h=e[e.length-0];break;case 11:h=this.createNode("node_op","op_prop",e[e.length-3],e[e.length-1]);break;case 12:h=this.createNode("node_op","op_paramdef",e[e.length-1],e[e.length-3]);break;case 13:h=this.createNode("node_op","op_paramdef",e[e.length-1]);break;case 14:h=e[e.length-0];break;case 15:h=this.createNode("node_op","op_param",e[e.length-1],e[e.length-3]);break;case 16:h=this.createNode("node_op","op_param",e[e.length-1]);break;case 17:h=this.createNode("node_op","op_assign",e[e.length-3],e[e.length-1]);break;case 18:h=this.createNode("node_op","op_if",e[e.length-2],e[e.length-1]);break;case 19:h=this.createNode("node_op","op_if_else",e[e.length-4],e[e.length-3],e[e.length-1]);
break;case 20:h=this.createNode("node_op","op_while",e[e.length-2],e[e.length-1]);break;case 21:h=this.createNode("node_op","op_do",e[e.length-4],e[e.length-2]);break;case 22:h=this.createNode("node_op","op_for",e[e.length-7],e[e.length-5],e[e.length-3],e[e.length-1]);break;case 23:h=this.createNode("node_op","op_use",e[e.length-2]);break;case 24:h=this.createNode("node_op","op_delete",e[e.length-1]);break;case 25:h=this.createNode("node_op","op_return",e[e.length-1]);break;case 26:h=e[e.length-2];break;case 27:h=this.createNode("node_op","op_noassign",e[e.length-2]);break;case 28:h=e[e.length-2],h.needsBrackets=!0;break;case 29:h=this.createNode("node_op","op_none");break;case 30:h=this.createNode("node_op","op_lhs",e[e.length-1],e[e.length-3],"dot");break;case 31:h=this.createNode("node_op","op_lhs",e[e.length-2],e[e.length-4],"bracket");break;case 32:h=this.createNode("node_op","op_lhs",e[e.length-1]);break;case 33:h=this.createNode("node_op","op_equ",e[e.length-3],e[e.length-1]);break;case 34:h=this.createNode("node_op","op_lot",e[e.length-3],e[e.length-1]);break;case 35:h=this.createNode("node_op","op_grt",e[e.length-3],e[e.length-1]);break;case 36:h=this.createNode("node_op","op_loe",e[e.length-3],e[e.length-1]);break;case 37:h=this.createNode("node_op","op_gre",e[e.length-3],e[e.length-1]);break;case 38:h=this.createNode("node_op","op_neq",e[e.length-3],e[e.length-1]);break;case 39:h=this.createNode("node_op","op_approx",e[e.length-3],e[e.length-1]);break;case 40:h=e[e.length-1];break;case 41:h=this.createNode("node_op","op_or",e[e.length-3],e[e.length-1]);break;case 42:h=this.createNode("node_op","op_and",e[e.length-3],e[e.length-1]);break;case 43:h=this.createNode("node_op","op_not",e[e.length-1]);break;case 44:h=e[e.length-1];break;case 45:h=this.createNode("node_op","op_sub",e[e.length-3],e[e.length-1]);break;case 46:h=this.createNode("node_op","op_add",e[e.length-3],e[e.length-1]);break;case 47:h=e[e.length-1];break;case 48:h=this.createNode("node_op","op_mul",e[e.length-3],e[e.length-1]);break;case 49:h=this.createNode("node_op","op_div",e[e.length-3],e[e.length-1]);break;case 50:h=this.createNode("node_op","op_mod",e[e.length-3],e[e.length-1]);break;case 51:h=e[e.length-1];break;case 52:h=this.createNode("node_op","op_exp",e[e.length-3],e[e.length-1]);break;case 53:h=e[e.length-1];break;case 54:h=this.createNode("node_op","op_neg",e[e.length-1]);break;case 55:h=e[e.length-1];break;case 56:h=e[e.length-1];break;case 57:h=this.createNode("node_op","op_extvalue",e[e.length-4],e[e.length-2]);break;case 58:h=this.createNode("node_op","op_execfun",e[e.length-4],e[e.length-2]);break;case 59:h=this.createNode("node_op","op_execfun",e[e.length-5],e[e.length-3],e[e.length-1],!0);break;case 60:h=this.createNode("node_op","op_property",e[e.length-3],e[e.length-1]);break;case 61:h=e[e.length-1];break;case 62:h=this.createNode("node_const",e[e.length-1]);break;case 63:h=this.createNode("node_const",e[e.length-1]);break;case 64:h=this.createNode("node_var",e[e.length-1]);break;case 65:h=e[e.length-2];break;case 66:h=this.createNode("node_str",e[e.length-1]);break;case 67:h=this.createNode("node_op","op_function",e[e.length-5],e[e.length-2]);break;case 68:h=this.createNode("node_op","op_proplst_val",e[e.length-2]);break;case 69:h=this.createNode("node_op","op_array",e[e.length-2]);break;case 70:h=this.createNode("node_const_bool",e[e.length-1]);break;case 71:h=this.createNode("node_const_bool",e[e.length-1])}for(i=0;i<k[g][1];i++)d.pop(),e.pop();for(j.act=142,i=0;i<m[d[d.length-1]].length;i+=2)if(m[d[d.length-1]][i]==k[g][0]){j.act=m[d[d.length-1]][i+1];break}if(0==g)break;d.push(j.act),e.push(h)}}return f}}),JXG.Dump={addMarkers:function(a,b,c){var d,e,f;JXG.isArray(b)||(b=[b]),JXG.isArray(c)||(c=[c]),e=Math.min(b.length,c.length),b.length=e,c.length=e;for(d in a.objects)for(f=0;e>f;f++)a.objects[d][b[f]]=c[f]},deleteMarkers:function(a,b){var c,d,e;JXG.isArray(b)||(b=[b]),d=b.length,b.length=d;for(c in a.objects)for(e=0;d>e;e++)delete a.objects[c][b[e]]},str:function(a){return"string"==typeof a&&"function"!==a.substr(0,7)&&(a="'"+a+"'"),a},minimizeObject:function(a){var b,c,f,d=JXG.deepCopy(a),e=[];for(f=1;f<arguments.length;f++)e.push(arguments[f]);for(f=0;f<e.length;f++)for(b in e[f])c=b.toLowerCase(),"object"!=typeof e[f][b]&&e[f][b]==d[c]&&delete d[c];return d},prepareAttributes:function(a,b){var c,d;c=this.minimizeObject(b.getAttributes(),a.options[b.elType],a.options.elements);for(d in b.subs)c[d]=this.minimizeObject(b.subs[d].getAttributes(),a.options[b.elType][d],a.options[b.subs[d].elType],a.options.elements),c[d].id=b.subs[d].id,c[d].name=b.subs[d].name;return c.id=b.id,c.name=b.name,c},dump:function(a){var b,c,d,e,f=[],g=a.objectsList.length;for(this.addMarkers(a,"dumped",!1),b=0;g>b;b++)if(c=a.objectsList[b],d={},!c.dumped&&c.dump){for(d.type=c.getType(),d.parents=c.getParents(),"point"===d.type&&1==d.parents[0]&&(d.parents=d.parents.slice(1)),e=0;e<d.parents.length;e++)"string"==typeof d.parents[e]&&(d.parents[e]="'"+d.parents[e]+"'");d.attributes=this.prepareAttributes(a,c),f.push(d)}return this.deleteMarkers(a,"dumped"),f},toJSAN:function(a){var c;switch(typeof a){case"object":if(a){var d=[];if(a instanceof Array){for(c=0;c<a.length;c++)d.push(this.toJSAN(a[c]));return"["+d.join(",")+"]"}for(var e in a)d.push(e+": "+this.toJSAN(a[e]));return"<<"+d.join(", ")+">> "}return"null";case"string":return"'"+a.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return new String(a);case"null":return"null"}},toJessie:function(a){var d,b=this.dump(a),c=[];for(d=0;d<b.length;d++)b[d].attributes.name.length>0&&c.push("// "+b[d].attributes.name),c.push("s"+d+" = "+b[d].type+"("+b[d].parents.join(", ")+") "+this.toJSAN(b[d].attributes).replace(/\n/,"\\n")+";"),c.push("");return c.join("\n")},toJavaScript:function(a){var d,b=this.dump(a),c=[];for(d=0;d<b.length;d++)c.push('board.create("'+b[d].type+'", ['+b[d].parents.join(", ")+"], "+JXG.toJSON(b[d].attributes)+");");return c.join("\n")}},JXG.SVGRenderer=function(a){var b;for(this.type="svg",this.svgRoot=null,this.svgNamespace="http://www.w3.org/2000/svg",this.xlinkNamespace="http://www.w3.org/1999/xlink",this.container=a,this.container.style.MozUserSelect="none",this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg"),this.svgRoot.style.overflow="hidden",this.svgRoot.style.width=JXG.getStyle(this.container,"width"),this.svgRoot.style.height=JXG.getStyle(this.container,"height"),this.container.appendChild(this.svgRoot),this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs"),this.svgRoot.appendChild(this.defs),this.filter=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter"),this.filter.setAttributeNS(null,"id",this.container.id+"_f1"),this.filter.setAttributeNS(null,"width","300%"),this.filter.setAttributeNS(null,"height","300%"),this.filter.setAttributeNS(null,"filterUnits","userSpaceOnUse"),this.feOffset=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset"),this.feOffset.setAttributeNS(null,"result","offOut"),this.feOffset.setAttributeNS(null,"in","SourceAlpha"),this.feOffset.setAttributeNS(null,"dx","5"),this.feOffset.setAttributeNS(null,"dy","5"),this.filter.appendChild(this.feOffset),this.feGaussianBlur=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur"),this.feGaussianBlur.setAttributeNS(null,"result","blurOut"),this.feGaussianBlur.setAttributeNS(null,"in","offOut"),this.feGaussianBlur.setAttributeNS(null,"stdDeviation","3"),this.filter.appendChild(this.feGaussianBlur),this.feBlend=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend"),this.feBlend.setAttributeNS(null,"in","SourceGraphic"),this.feBlend.setAttributeNS(null,"in2","blurOut"),this.feBlend.setAttributeNS(null,"mode","normal"),this.filter.appendChild(this.feBlend),this.defs.appendChild(this.filter),this.layer=[],b=0;b<JXG.Options.layer.numlayers;b++)this.layer[b]=this.container.ownerDocument.createElementNS(this.svgNamespace,"g"),this.svgRoot.appendChild(this.layer[b]);this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]},JXG.SVGRenderer.prototype=new JXG.AbstractRenderer,JXG.extend(JXG.SVGRenderer.prototype,{_createArrowHead:function(a,b){var d,e,c=a.id+"Triangle";return JXG.exists(b)&&(c+=b),d=this.createPrim("marker",c),d.setAttributeNS(null,"viewBox","0 0 10 6"),d.setAttributeNS(null,"refY","3"),d.setAttributeNS(null,"markerUnits","userSpaceOnUse"),d.setAttributeNS(null,"markerHeight","12"),d.setAttributeNS(null,"markerWidth","10"),d.setAttributeNS(null,"orient","auto"),d.setAttributeNS(null,"stroke",a.visProp.strokecolor),d.setAttributeNS(null,"stroke-opacity",a.visProp.strokeopacity),d.setAttributeNS(null,"fill",a.visProp.strokecolor),d.setAttributeNS(null,"fill-opacity",a.visProp.strokeopacity),e=this.container.ownerDocument.createElementNS(this.svgNamespace,"path"),"End"===b?(d.setAttributeNS(null,"refX","0"),e.setAttributeNS(null,"d","M 0 3 L 10 6 L 10 0 z")):(d.setAttributeNS(null,"refX","10"),e.setAttributeNS(null,"d","M 0 0 L 10 3 L 0 6 z")),d.appendChild(e),d},_setArrowAtts:function(a,b,c,d){a&&(a.setAttributeNS(null,"stroke",b),a.setAttributeNS(null,"stroke-opacity",c),a.setAttributeNS(null,"fill",b),a.setAttributeNS(null,"fill-opacity",c),a.setAttributeNS(null,"stroke-width",d))},updateTicks:function(a){var i,j,k,l,m,h="",n=a.ticks.length;for(i=0;n>i;i++)j=a.ticks[i],l=j[0],m=j[1],"undefined"!=typeof l[0]&&"undefined"!=typeof l[1]&&(h+="M "+l[0]+" "+m[0]+" L "+l[1]+" "+m[1]+" ");for(i=0;n>i;i++)j=a.ticks[i].scrCoords,a.ticks[i].major&&(a.board.needsFullUpdate||a.needsRegularUpdate)&&a.labels[i]&&a.labels[i].visProp.visible&&this.updateText(a.labels[i]);k=this.getElementById(a.id),JXG.exists(k)||(k=this.createPrim("path",a.id),this.appendChildPrim(k,a.visProp.layer),this.appendNodesToElement(a,"path")),k.setAttributeNS(null,"stroke",a.visProp.strokecolor),k.setAttributeNS(null,"stroke-opacity",a.visProp.strokeopacity),k.setAttributeNS(null,"stroke-width",a.visProp.strokewidth),this.updatePathPrim(k,h,a.board)},displayCopyright:function(a,b){var d,c=this.createPrim("text","licenseText");c.setAttributeNS(null,"x","20px"),c.setAttributeNS(null,"y",2+b+"px"),c.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+b+"px; fill:#356AA0;  opacity:0.3;"),d=document.createTextNode(a),c.appendChild(d),this.appendChildPrim(c,0)},drawInternalText:function(a){var b=this.createPrim("text",a.id);return b.setAttributeNS(null,"class",a.visProp.cssclass),a.rendNodeText=document.createTextNode(""),b.appendChild(a.rendNodeText),this.appendChildPrim(b,a.visProp.layer),b},updateInternalText:function(a){var b=a.plaintext;isNaN(a.coords.scrCoords[1]+a.coords.scrCoords[2])||(a.rendNode.setAttributeNS(null,"x",a.coords.scrCoords[1]+"px"),a.rendNode.setAttributeNS(null,"y",a.coords.scrCoords[2]+.5*this.vOffsetText+"px"),"right"===a.visProp.anchorx?a.rendNode.setAttributeNS(null,"text-anchor","end"):"middle"===a.visProp.anchorx&&a.rendNode.setAttributeNS(null,"text-anchor","middle"),"top"===a.visProp.anchory?a.rendNode.setAttributeNS(null,"dominant-baseline","text-before-edge"):"middle"===a.visProp.anchory&&a.rendNode.setAttributeNS(null,"dominant-baseline","middle")),a.htmlStr!==b&&(a.rendNodeText.data=b,a.htmlStr=b),this.transformImage(a,a.transformations)},updateInternalTextStyle:function(a,b,c){this.setObjectFillColor(a,b,c)},drawImage:function(a){var b=this.createPrim("image",a.id);b.setAttributeNS(null,"preserveAspectRatio","none"),this.appendChildPrim(b,a.visProp.layer),a.rendNode=b,this.updateImage(a)},transformImage:function(a,b){var d,f,c=a.rendNode,e="",g=b.length;g>0&&(d=this.joinTransforms(a,b),f=[d[1][1],d[2][1],d[1][2],d[2][2],d[1][0],d[2][0]].join(","),e+=" matrix("+f+") ",c.setAttributeNS(null,"transform",e))},updateImageURL:function(a){var b=JXG.evaluate(a.url);a.rendNode.setAttributeNS(this.xlinkNamespace,"xlink:href",b)},appendChildPrim:function(a,b){JXG.exists(b)?b>=JXG.Options.layer.numlayers&&(b=JXG.Options.layer.numlayers-1):b=0,this.layer[b].appendChild(a)},appendNodesToElement:function(a){a.rendNode=this.getElementById(a.id)},createPrim:function(a,b){var c=this.container.ownerDocument.createElementNS(this.svgNamespace,a);return c.setAttributeNS(null,"id",this.container.id+"_"+b),c.style.position="absolute","path"===a&&(c.setAttributeNS(null,"stroke-linecap","butt"),c.setAttributeNS(null,"stroke-linejoin","round")),c},remove:function(a){JXG.exists(a)&&JXG.exists(a.parentNode)&&a.parentNode.removeChild(a)},makeArrows:function(a){var b;(a.visPropOld.firstarrow!==a.visProp.firstarrow||a.visPropOld.lastarrow!==a.visProp.lastarrow)&&(a.visProp.firstarrow?(b=a.rendNodeTriangleStart,JXG.exists(b)?this.defs.appendChild(b):(b=this._createArrowHead(a,"End"),this.defs.appendChild(b),a.rendNodeTriangleStart=b,a.rendNode.setAttributeNS(null,"marker-start","url(#"+this.container.id+"_"+a.id+"TriangleEnd)"))):(b=a.rendNodeTriangleStart,JXG.exists(b)&&this.remove(b)),a.visProp.lastarrow?(b=a.rendNodeTriangleEnd,JXG.exists(b)?this.defs.appendChild(b):(b=this._createArrowHead(a,"Start"),this.defs.appendChild(b),a.rendNodeTriangleEnd=b,a.rendNode.setAttributeNS(null,"marker-end","url(#"+this.container.id+"_"+a.id+"TriangleStart)"))):(b=a.rendNodeTriangleEnd,JXG.exists(b)&&this.remove(b)),a.visPropOld.firstarrow=a.visProp.firstarrow,a.visPropOld.lastarrow=a.visProp.lastarrow)},updateEllipsePrim:function(a,b,c,d,e){a.setAttributeNS(null,"cx",b),a.setAttributeNS(null,"cy",c),a.setAttributeNS(null,"rx",Math.abs(d)),a.setAttributeNS(null,"ry",Math.abs(e))},updateLinePrim:function(a,b,c,d,e){isNaN(b+c+d+e)||(a.setAttributeNS(null,"x1",b),a.setAttributeNS(null,"y1",c),a.setAttributeNS(null,"x2",d),a.setAttributeNS(null,"y2",e))},updatePathPrim:function(a,b){""==b&&(b="M 0 0"),a.setAttributeNS(null,"d",b)},updatePathStringPoint:function(a,b,c){var d="",e=a.coords.scrCoords,f=.5*b*Math.sqrt(3),g=.5*b;return"x"===c?d=" M "+(e[1]-b)+" "+(e[2]-b)+" L "+(e[1]+b)+" "+(e[2]+b)+" M "+(e[1]+b)+" "+(e[2]-b)+" L "+(e[1]-b)+" "+(e[2]+b):"+"===c?d=" M "+(e[1]-b)+" "+e[2]+" L "+(e[1]+b)+" "+e[2]+" M "+e[1]+" "+(e[2]-b)+" L "+e[1]+" "+(e[2]+b):"<>"===c?d=" M "+(e[1]-b)+" "+e[2]+" L "+e[1]+" "+(e[2]+b)+" L "+(e[1]+b)+" "+e[2]+" L "+e[1]+" "+(e[2]-b)+" Z ":"^"===c?d=" M "+e[1]+" "+(e[2]-b)+" L "+(e[1]-f)+" "+(e[2]+g)+" L "+(e[1]+f)+" "+(e[2]+g)+" Z ":"-"===c?d=" M "+(e[1]-b)+" "+(e[2]-b)+" L "+(e[1]+b)+" "+(e[2]+b):">"===c?d=" M "+(e[1]+b)+" "+e[2]+" L "+(e[1]-g)+" "+(e[2]-f)+" L "+(e[1]-g)+" "+(e[2]+f)+" Z ":"-<"===c?d=" M "+(e[1]-b)+" "+(e[2]-b)+" L "+(e[1]+b)+" "+(e[2]+b):"-->"===c?d=" M "+(e[1]+b)+" "+(e[2]-b)+" L "+(e[1]-b)+" "+(e[2]+b)+" M "+(e[1]+b+b+b)+" "+(e[2]-b)+" L "+(e[1]+b)+" "+(e[2]+b):"--<"===c?d=" M "+(e[1]-b)+" "+(e[2]-b)+" L "+(e[1]+b)+" "+(e[2]+b)+" M "+(e[1]-b-b-b)+" "+(e[2]-b)+" L "+(e[1]-b)+" "+(e[2]+b):"->"===c&&(d=" M "+(e[1]+b)+" "+(e[2]-b)+" L "+(e[1]-b)+" "+(e[2]+b)),d},updatePathStringPrim:function(a){var h,i,k,b=" M ",c=" L ",d=" C ",e=b,f=5e3,g="",j="plot"!==a.visProp.curvetype;if(a.numberPoints<=0)return"";if(k=Math.min(a.points.length,a.numberPoints),1==a.bezierDegree)for(j&&a.board.options.curve.RDPsmoothing&&(a.points=JXG.Math.Numerics.RamerDouglasPeuker(a.points,.5)),h=0;k>h;h++)i=a.points[h].scrCoords,isNaN(i[1])||isNaN(i[2])?e=b:(i[1]>f?i[1]=f:i[1]<-f&&(i[1]=-f),i[2]>f?i[2]=f:i[2]<-f&&(i[2]=-f),g+=e+i[1]+" "+i[2],e=c);else if(3==a.bezierDegree)for(h=0;k>h;)i=a.points[h].scrCoords,isNaN(i[1])||isNaN(i[2])?e=b:(g+=e+i[1]+" "+i[2],e==d&&(h++,i=a.points[h].scrCoords,g+=" "+i[1]+" "+i[2],h++,i=a.points[h].scrCoords,g+=" "+i[1]+" "+i[2]),e=d),h++;return g},updatePathStringBezierPrim:function(a){var g,h,i,j,k,n,b=" M ",c=" C ",d=b,e=5e3,f="",l=a.visProp.strokewidth,m="plot"!==a.visProp.curvetype;if(a.numberPoints<=0)return"";for(m&&a.board.options.curve.RDPsmoothing&&(a.points=JXG.Math.Numerics.RamerDouglasPeuker(a.points,.5)),n=Math.min(a.points.length,a.numberPoints),h=1;3>h;h++)for(d=b,g=0;n>g;g++)i=a.points[g].scrCoords,isNaN(i[1])||isNaN(i[2])?d=b:(i[1]>e?i[1]=e:i[1]<-e&&(i[1]=-e),i[2]>e?i[2]=e:i[2]<-e&&(i[2]=-e),f+=d==b?[d,i[1]+0*l*(2*h*Math.random()-h)," ",i[2]+0*l*(2*h*Math.random()-h)].join(""):[d,j+.333*(i[1]-j)+l*(2*h*Math.random()-h)," ",k+.333*(i[2]-k)+l*(2*h*Math.random()-h)," ",j+.333*2*(i[1]-j)+l*(2*h*Math.random()-h)," ",k+.333*2*(i[2]-k)+l*(2*h*Math.random()-h)," ",i[1]," ",i[2]].join(""),d=c,j=i[1],k=i[2]);return f},updatePolygonPrim:function(a,b){var d,e,c="",f=b.vertices.length;for(a.setAttributeNS(null,"stroke","none"),e=0;f-1>e;e++){if(!b.vertices[e].isReal)return a.setAttributeNS(null,"points",""),void 0;d=b.vertices[e].coords.scrCoords,c=c+d[1]+","+d[2],f-2>e&&(c+=" ")}-1==c.indexOf("NaN")&&a.setAttributeNS(null,"points",c)},updateRectPrim:function(a,b,c,d,e){a.setAttributeNS(null,"x",b),a.setAttributeNS(null,"y",c),a.setAttributeNS(null,"width",d),a.setAttributeNS(null,"height",e)},setPropertyPrim:function(a,b,c){"stroked"!==b&&a.setAttributeNS(null,b,c)},show:function(a){var b;a&&a.rendNode&&(b=a.rendNode,b.setAttributeNS(null,"display","inline"),b.style.visibility="inherit")},hide:function(a){var b;a&&a.rendNode&&(b=a.rendNode,b.setAttributeNS(null,"display","none"),b.style.visibility="hidden")},setBuffering:function(a,b){a.rendNode.setAttribute("buffered-rendering",b)},setDashStyle:function(a){var b=a.visProp.dash,c=a.rendNode;a.visProp.dash>0?c.setAttributeNS(null,"stroke-dasharray",this.dashArray[b-1]):c.hasAttributeNS(null,"stroke-dasharray")&&c.removeAttributeNS(null,"stroke-dasharray")},setGradient:function(a){var c,d,e,f,g,h,i,j,k,b=a.rendNode;d=JXG.evaluate(a.visProp.fillopacity),d=d>0?d:0,c=JXG.evaluate(a.visProp.fillcolor),"linear"===a.visProp.gradient?(e=this.createPrim("linearGradient",a.id+"_gradient"),h="0%",i="100%",j="0%",k="0%",e.setAttributeNS(null,"x1",h),e.setAttributeNS(null,"x2",i),e.setAttributeNS(null,"y1",j),e.setAttributeNS(null,"y2",k),f=this.createPrim("stop",a.id+"_gradient1"),f.setAttributeNS(null,"offset","0%"),f.setAttributeNS(null,"style","stop-color:"+c+";stop-opacity:"+d),g=this.createPrim("stop",a.id+"_gradient2"),g.setAttributeNS(null,"offset","100%"),g.setAttributeNS(null,"style","stop-color:"+a.visProp.gradientsecondcolor+";stop-opacity:"+a.visProp.gradientsecondopacity),e.appendChild(f),e.appendChild(g),this.defs.appendChild(e),b.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+a.id+"_gradient)"),a.gradNode1=f,a.gradNode2=g):"radial"===a.visProp.gradient?(e=this.createPrim("radialGradient",a.id+"_gradient"),e.setAttributeNS(null,"cx","50%"),e.setAttributeNS(null,"cy","50%"),e.setAttributeNS(null,"r","50%"),e.setAttributeNS(null,"fx",100*a.visProp.gradientpositionx+"%"),e.setAttributeNS(null,"fy",100*a.visProp.gradientpositiony+"%"),f=this.createPrim("stop",a.id+"_gradient1"),f.setAttributeNS(null,"offset","0%"),f.setAttributeNS(null,"style","stop-color:"+a.visProp.gradientsecondcolor+";stop-opacity:"+a.visProp.gradientsecondopacity),g=this.createPrim("stop",a.id+"_gradient2"),g.setAttributeNS(null,"offset","100%"),g.setAttributeNS(null,"style","stop-color:"+c+";stop-opacity:"+d),e.appendChild(f),e.appendChild(g),this.defs.appendChild(e),b.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+a.id+"_gradient)"),a.gradNode1=f,a.gradNode2=g):b.removeAttributeNS(null,"style")},updateGradient:function(a){var d,e,b=a.gradNode1,c=a.gradNode2;JXG.exists(b)&&JXG.exists(c)&&(e=JXG.evaluate(a.visProp.fillopacity),e=e>0?e:0,d=JXG.evaluate(a.visProp.fillcolor),"linear"===a.visProp.gradient?(b.setAttributeNS(null,"style","stop-color:"+d+";stop-opacity:"+e),c.setAttributeNS(null,"style","stop-color:"+a.visProp.gradientsecondcolor+";stop-opacity:"+a.visProp.gradientsecondopacity)):"radial"===a.visProp.gradient&&(b.setAttributeNS(null,"style","stop-color:"+a.visProp.gradientsecondcolor+";stop-opacity:"+a.visProp.gradientsecondopacity),c.setAttributeNS(null,"style","stop-color:"+d+";stop-opacity:"+e)))},setObjectFillColor:function(a,b,c){var d,f,g,i,e=JXG.evaluate(b),h=JXG.evaluate(c);h=h>0?h:0,(a.visPropOld.fillcolor!==e||a.visPropOld.fillopacity!==h)&&(JXG.exists(e)&&e!==!1&&(9!=e.length?(f=e,i=h):(g=JXG.rgba2rgbo(e),f=g[0],i=h*g[1]),d=a.rendNode,d.setAttributeNS(null,"fill",f),a.type===JXG.OBJECT_TYPE_IMAGE?d.setAttributeNS(null,"opacity",i):d.setAttributeNS(null,"fill-opacity",i),JXG.exists(a.visProp.gradient)&&this.updateGradient(a)),a.visPropOld.fillcolor=e,a.visPropOld.fillopacity=h)},setObjectStrokeColor:function(a,b,c){var e,f,h,i,d=JXG.evaluate(b),g=JXG.evaluate(c);g=g>0?g:0,(a.visPropOld.strokecolor!==d||a.visPropOld.strokeopacity!==g)&&(JXG.exists(d)&&d!==!1&&(9!=d.length?(e=d,h=g):(f=JXG.rgba2rgbo(d),e=f[0],h=g*f[1]),i=a.rendNode,a.type===JXG.OBJECT_TYPE_TEXT?"html"===a.visProp.display?(i.style.color=e,i.style.opacity=h):(i.setAttributeNS(null,"style","fill:"+e),i.setAttributeNS(null,"style","fill-opacity:"+h)):(i.setAttributeNS(null,"stroke",e),i.setAttributeNS(null,"stroke-opacity",h)),a.type===JXG.OBJECT_TYPE_ARROW?this._setArrowAtts(a.rendNodeTriangle,e,h,a.visProp.strokewidth):(a.elementClass===JXG.OBJECT_CLASS_CURVE||a.elementClass===JXG.OBJECT_CLASS_LINE)&&(a.visProp.firstarrow&&this._setArrowAtts(a.rendNodeTriangleStart,e,h,a.visProp.strokewidth),a.visProp.lastarrow&&this._setArrowAtts(a.rendNodeTriangleEnd,e,h,a.visProp.strokewidth))),a.visPropOld.strokecolor=d,a.visPropOld.strokeopacity=g)},setObjectStrokeWidth:function(a,b){var d,c=JXG.evaluate(b);a.visPropOld.strokewidth!==c&&(d=a.rendNode,this.setPropertyPrim(d,"stroked","true"),JXG.exists(c)&&(this.setPropertyPrim(d,"stroke-width",c+"px"),a.type===JXG.OBJECT_TYPE_ARROW?this._setArrowAtts(a.rendNodeTriangle,a.visProp.strokecolor,a.visProp.strokeopacity,c):(a.elementClass===JXG.OBJECT_CLASS_CURVE||a.elementClass===JXG.OBJECT_CLASS_LINE)&&(a.visProp.firstarrow&&this._setArrowAtts(a.rendNodeTriangleStart,a.visProp.strokecolor,a.visProp.strokeopacity,c),a.visProp.lastarrow&&this._setArrowAtts(a.rendNodeTriangleEnd,a.visProp.strokecolor,a.visProp.strokeopacity,c))),a.visPropOld.strokewidth=c)},setShadow:function(a){a.visPropOld.shadow!==a.visProp.shadow&&(JXG.exists(a.rendNode)&&(a.visProp.shadow?a.rendNode.setAttributeNS(null,"filter","url(#"+this.container.id+"_f1)"):a.rendNode.removeAttributeNS(null,"filter")),a.visPropOld.shadow=a.visProp.shadow)},suspendRedraw:function(){},unsuspendRedraw:function(){},resize:function(a,b){this.svgRoot.style.width=parseFloat(a)+"px",this.svgRoot.style.height=parseFloat(b)+"px"}}),
JXG.VMLRenderer=function(a){},JXG.VMLRenderer.prototype = new JXG.AbstractRenderer,JXG.extend(JXG.VMLRenderer.prototype, {}),
JXG.CanvasRenderer = function (a) {},JXG.CanvasRenderer.prototype = new JXG.AbstractRenderer,JXG.extend(JXG.CanvasRenderer.prototype,{});